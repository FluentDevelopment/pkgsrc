$NetBSD: patch-aa,v 1.2 2003/12/04 10:32:30 adam Exp $

--- SRC/Makefile.orig	1999-11-04 20:26:09.000000000 +0100
+++ SRC/Makefile
@@ -280,24 +280,24 @@ ZLASRC = \
 all: single complex double complex16
 
 single: $(SLASRC) $(ALLAUX) $(SCLAUX) 
-	$(ARCH) $(ARCHFLAGS) ../$(LAPACKLIB) $(SLASRC) $(ALLAUX) \
-	$(SCLAUX)
-	$(RANLIB) ../$(LAPACKLIB)
+	${LIBTOOL} --mode=link --tag=CC ${FC} -o ../liblapack.la	\
+		$(SLASRC:.o=.lo) $(ALLAUX:.o=.lo) $(SCLAUX:.o=.lo)	\
+		-rpath ${PREFIX}/lib -version-info 3:0
 
 complex: $(CLASRC) $(ALLAUX) $(SCLAUX)
-	$(ARCH) $(ARCHFLAGS) ../$(LAPACKLIB) $(CLASRC) $(ALLAUX) \
-	$(SCLAUX)
-	$(RANLIB) ../$(LAPACKLIB)
+	${LIBTOOL} --mode=link --tag=CC ${FC} -o ../liblapack.la	\
+		$(CLASRC:.o=.lo) $(ALLAUX:.o=.lo) $(SCLAUX:.o=.lo)	\
+		-rpath ${PREFIX}/lib -version-info 3:0
 
 double: $(DLASRC) $(ALLAUX) $(DZLAUX)
-	$(ARCH) $(ARCHFLAGS) ../$(LAPACKLIB) $(DLASRC) $(ALLAUX) \
-	$(DZLAUX)
-	$(RANLIB) ../$(LAPACKLIB)
+	${LIBTOOL} --mode=link --tag=CC ${FC} -o ../liblapack.la	\
+		$(DLASRC:.o=.lo) $(ALLAUX:.o=.lo) $(DZLAUX:.o=.lo)	\
+		-rpath ${PREFIX}/lib -version-info 3:0
 
 complex16: $(ZLASRC) $(ALLAUX) $(DZLAUX)
-	$(ARCH) $(ARCHFLAGS) ../$(LAPACKLIB) $(ZLASRC) $(ALLAUX) \
-	$(DZLAUX)
-	$(RANLIB) ../$(LAPACKLIB)
+	${LIBTOOL} --mode=link --tag=CC ${FC} -o ../liblapack.la	\
+		$(ZLASRC:.o=.lo) $(ALLAUX:.o=.lo) $(DZLAUX:.o=.lo)	\
+		-rpath ${PREFIX}/lib -version-info 3:0
 
 $(ALLAUX): $(FRC)
 $(SCLAUX): $(FRC)
@@ -313,10 +313,6 @@ FRC:
 clean:
 	rm -f *.o
 
-slamch.o: slamch.f
-	$(FORTRAN) $(NOOPT) -c $<
-dlamch.o: dlamch.f
-	$(FORTRAN) $(NOOPT) -c $<
 
 .f.o: 
-	$(FORTRAN) $(OPTS) -c $<
+	${LIBTOOL} --mode=compile --tag=CC ${FC} ${FFLAGS} -c $<
