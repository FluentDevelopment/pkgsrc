$NetBSD: patch-ad,v 1.3 2003/12/04 11:15:37 adam Exp $

--- libcruft/Makefile.in.orig	2003-10-30 17:48:09.000000000 +0100
+++ libcruft/Makefile.in
@@ -100,8 +100,8 @@ libraries: $(SUBDIRS)
 
 libcruft.$(LIBEXT): $(CRUFT_OBJ)
 	rm -f $@
-	$(AR) $(ARFLAGS) $@ $^
-	$(RANLIB) $@
+	${LIBTOOL} --mode=link ${CC} -o libcruft.$(LIBEXT) $(CRUFT_OBJ:.o=.lo) \
+		-rpath ${PREFIX}/lib -version-info ${version:2.1.%=2:%}
 
 libcruft.$(SHLEXT_VER): libcruft.$(SHLEXT)
 	rm -f $@
@@ -126,9 +126,8 @@ install::
 	$(top_srcdir)/mkinstalldirs $(DESTDIR)$(octlibdir)
 	if $(STATIC_LIBS); then \
 	  rm -f $(DESTDIR)$(octlibdir)/libcruft.$(LIBEXT) ; \
-	  $(INSTALL_DATA) libcruft.$(LIBEXT) \
-	    $(DESTDIR)$(octlibdir)/libcruft.$(LIBEXT) ; \
-	  $(RANLIB) $(DESTDIR)$(octlibdir)/libcruft.$(LIBEXT) ; \
+	  ${LIBTOOL} --mode=install $(INSTALL_DATA) libcruft.$(LIBEXT) \
+	    ${PREFIX}/lib; \
 	fi
 	if $(SHARED_LIBS); then \
 	  rm -f $(DESTDIR)$(octlibdir)/libcruft.$(SHLLIB_VER); \
