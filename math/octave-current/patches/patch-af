$NetBSD: patch-af,v 1.4 2003/12/04 11:15:37 adam Exp $

--- liboctave/Makefile.in.orig	2003-11-15 03:01:46.000000000 +0100
+++ liboctave/Makefile.in
@@ -204,8 +204,9 @@ endif
 
 liboctave.$(LIBEXT): $(LIBOCTAVE_OBJECTS)
 	rm -f $@
-	$(TEMPLATE_AR) $(TEMPLATE_ARFLAGS) $@ $(LIBOCTAVE_OBJECTS)
-	$(RANLIB) $@
+	${LIBTOOL} --mode=link ${CC} -o liboctave.$(LIBEXT) \
+		$(LIBOCTAVE_OBJECTS:.o=.lo) -rpath ${PREFIX}/lib \
+		-version-info ${version:2.1.%=2:%}
 
 liboctave.$(SHLEXT_VER): liboctave.$(SHLEXT)
 	rm -f $@
@@ -232,9 +233,8 @@ install-lib:
 	$(top_srcdir)/mkinstalldirs $(DESTDIR)$(octlibdir)
 	if $(STATIC_LIBS); then \
 	  rm -f $(DESTDIR)$(octlibdir)/liboctave.$(LIBEXT); \
-	  $(INSTALL_DATA) liboctave.$(LIBEXT) \
-	    $(DESTDIR)$(octlibdir)/liboctave.$(LIBEXT); \
-	  $(RANLIB) $(DESTDIR)$(octlibdir)/liboctave.$(LIBEXT); \
+	  ${LIBTOOL} --mode=install $(INSTALL_DATA) liboctave.$(LIBEXT) \
+	    ${PREFIX}/lib; \
 	fi
 	if $(SHARED_LIBS); then \
 	  rm -f $(DESTDIR)$(octlibdir)/liboctave.$(SHLLIB_VER); \
