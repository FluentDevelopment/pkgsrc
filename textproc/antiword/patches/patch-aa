$NetBSD: patch-aa,v 1.8 2004/08/20 09:14:19 sketch Exp $

--- Makefile.orig	Wed Feb 26 20:05:47 2003
+++ Makefile	Fri Aug 20 10:05:22 2004
@@ -2,8 +2,8 @@
 # Makefile for antiword (Linux version)
 #
 
-CC	= gcc
-LD	= gcc
+#CC	= gcc
+#LD	= gcc
 
 INSTALL		= cp -f
 INSTALL_PROGRAM	= $(INSTALL)
@@ -16,7 +16,7 @@
 
 LDLIBS	=
 
-CFLAGS	= -Wall -pedantic $(OPT) -D$(DB)
+CFLAGS	+= -D$(DB)
 LDFLAGS	=
 
 OBJS	=\
@@ -29,23 +29,32 @@
 	worddos.o wordlib.o wordmac.o wordole.o wordwin.o xmalloc.o xml.o
 
 PROGS =\
-	antiword\
+	antiword
+SCRIPTS=\
 	kantiword
 
 LOCAL_INSTALL_DIR = $(HOME)/bin
 LOCAL_RESOURCES_DIR = $(HOME)/.antiword
 
-GLOBAL_INSTALL_DIR = /usr/local/bin
-GLOBAL_RESOURCES_DIR = /usr/share/antiword
+GLOBAL_INSTALL_DIR = ${PREFIX}/bin
+GLOBAL_RESOURCES_DIR = ${PREFIX}/share/antiword
 
 all:		$(PROGS)
 
 install:	all
-	mkdir -p $(LOCAL_INSTALL_DIR)
-	cp -pf $(PROGS) $(LOCAL_INSTALL_DIR)
-	mkdir -p $(LOCAL_RESOURCES_DIR)
-	cp -pf Resources/* $(LOCAL_RESOURCES_DIR)
+		${BSD_INSTALL_PROGRAM} ${PROGS} ${GLOBAL_INSTALL_DIR}
+		${BSD_INSTALL_SCRIPT} ${SCRIPTS} ${GLOBAL_INSTALL_DIR}
+		${BSD_INSTALL_DATA_DIR} ${PREFIX}/share/doc/antiword
+.for file in COPYING ChangeLog FAQ History Netscape QandA ReadMe
+		${BSD_INSTALL_DATA} Docs/${file} ${PREFIX}/share/doc/antiword
+.endfor
+		${BSD_INSTALL_MAN} Docs/antiword.1 ${PREFIX}/man/man1/antiword.1
+		${BSD_INSTALL_DATA_DIR} ${GLOBAL_RESOURCES_DIR}
+		for i in Resources/* ; do				\
+			${BSD_INSTALL_DATA} $$i ${GLOBAL_RESOURCES_DIR};\
+		done
 
+
 # NOTE: you might have to be root to do this
 global_install:	all
 #	@[ `id -u` -eq 0 ] || (echo "You must be root to do this" && false)
@@ -68,10 +77,11 @@
 clean:
 	rm -f $(OBJS)
 	rm -f $(PROGS)
+	rm -f $(SCRIPTS)
 
 antiword:	$(OBJS)
 	@rm -f $@
-	$(LD) $(LDFLAGS) $(OBJS) $(LDLIBS) -o $@
+	$(CC) $(CFLAGS) $(OBJS) -o $@
 	@chmod 750 $@
 
 kantiword:	Unix-only/KDE2-only/kantiword.sh
@@ -80,9 +90,6 @@
 	cat $? >> $@
 	@chmod 750 $@
 
-.c.o:
-	$(CC) $(CFLAGS) -c $<
-
 main_u.o:	version.h
 postscript.o:	version.h
 fonts_u.o:	fontinfo.h
