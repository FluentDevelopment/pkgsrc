$NetBSD: patch-aa,v 1.7 2003/12/12 22:31:55 wiz Exp $

--- Makefile.orig	Wed Feb 26 21:05:47 2003
+++ Makefile
@@ -2,8 +2,8 @@
 # Makefile for antiword (Linux version)
 #
 
-CC	= gcc
-LD	= gcc
+CC	?= gcc
+LD	= ${CC}
 
 INSTALL		= cp -f
 INSTALL_PROGRAM	= $(INSTALL)
@@ -12,11 +12,11 @@ INSTALL_DATA	= $(INSTALL)
 # must be equal to DEBUG or NDEBUG
 DB	= NDEBUG
 # Optimization: -O<n> or debugging: -g
-OPT	= -O2
+OPT	= 
 
 LDLIBS	=
 
-CFLAGS	= -Wall -pedantic $(OPT) -D$(DB)
+CFLAGS	+= -Wall -pedantic $(OPT) -D$(DB)
 LDFLAGS	=
 
 OBJS	=\
@@ -29,22 +29,31 @@ OBJS	=\
 	worddos.o wordlib.o wordmac.o wordole.o wordwin.o xmalloc.o xml.o
 
 PROGS =\
-	antiword\
+	antiword
+SCRIPTS=\
 	kantiword
 
 LOCAL_INSTALL_DIR = $(HOME)/bin
 LOCAL_RESOURCES_DIR = $(HOME)/.antiword
 
-GLOBAL_INSTALL_DIR = /usr/local/bin
-GLOBAL_RESOURCES_DIR = /usr/share/antiword
+GLOBAL_INSTALL_DIR = ${PREFIX}/bin
+GLOBAL_RESOURCES_DIR = ${PREFIX}/share/antiword
 
 all:		$(PROGS)
 
 install:	all
-	mkdir -p $(LOCAL_INSTALL_DIR)
-	cp -pf $(PROGS) $(LOCAL_INSTALL_DIR)
-	mkdir -p $(LOCAL_RESOURCES_DIR)
-	cp -pf Resources/* $(LOCAL_RESOURCES_DIR)
+		${BSD_INSTALL_PROGRAM} ${PROGS} ${GLOBAL_INSTALL_DIR}
+		${BSD_INSTALL_SCRIPT} ${SCRIPTS} ${GLOBAL_INSTALL_DIR}
+		${BSD_INSTALL_DATA_DIR} ${PREFIX}/share/doc/antiword
+.for file in COPYING ChangeLog FAQ History Netscape QandA ReadMe
+		${BSD_INSTALL_DATA} Docs/${file} ${PREFIX}/share/doc/antiword
+.endfor
+		${BSD_INSTALL_MAN} Docs/antiword.1 ${PREFIX}/man/man1/antiword.1
+		${BSD_INSTALL_DATA_DIR} ${GLOBAL_RESOURCES_DIR}
+		for i in Resources/* ; do				\
+			${BSD_INSTALL_DATA} $$i ${GLOBAL_RESOURCES_DIR};\
+		done
+
 
 # NOTE: you might have to be root to do this
 global_install:	all
@@ -68,6 +77,7 @@ global_uninstall:
 clean:
 	rm -f $(OBJS)
 	rm -f $(PROGS)
+	rm -f $(SCRIPTS)
 
 antiword:	$(OBJS)
 	@rm -f $@
@@ -79,9 +89,6 @@ kantiword:	Unix-only/KDE2-only/kantiword
 	echo "#!/bin/sh" > $@
 	cat $? >> $@
 	@chmod 750 $@
-
-.c.o:
-	$(CC) $(CFLAGS) -c $<
 
 main_u.o:	version.h
 postscript.o:	version.h
