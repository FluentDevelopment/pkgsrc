$NetBSD: patch-ac,v 1.3 2004/03/07 04:40:26 taca Exp $

--- rdtoolconf.rb.orig	2003-03-08 21:45:07.000000000 +0900
+++ rdtoolconf.rb
@@ -4,20 +4,32 @@
 
 require 'mkmf'
 require 'rbconfig'
-require 'amstd/rbparams'
 
 STDERR.print "creating Makefile\n"
 
-$bindir = RubyParams::BINDIR
-$siterubydir = RubyParams::SITE_RB
+$bindir = CONFIG["bindir"]
+$siterubydir = CONFIG["sitelibdir"]
 $rddir = CONFIG["datadir"] + "/ruby/rd"
 $racc = "racc"
 
+ruby_version = CONFIG['MAJOR'] + "." + CONFIG['MINOR']
+racc_opt = "# -gv"
+if ruby_version < "1.8"
+  racc_opt = "-E " + racc_opt
+else
+end
+
 mfile = open("Makefile", "w")
 mfile.print  <<"EOM"
 #
 # RDtool makefile
 
+prefix = #{CONFIG["prefix"]}
+exec_prefix = #{CONFIG["exec_prefix"]}
+ruby_version = #{CONFIG["ruby_version"]}
+sitedir = #{CONFIG["sitedir"]}
+MAJOR = #{CONFIG["MAJOR"]}
+MINOR = #{CONFIG["MINOR"]}
 BIN_DIR = #{$bindir}
 SITE_RUBY = #{$siterubydir}
 RD_DIR = #{$rddir}
@@ -25,7 +37,7 @@ RD_DIR = #{$rddir}
 RUBY = #{CONFIG["ruby_install_name"]}
 RUBY_OPT = -I.
 RACC = #{$racc}
-# RACC_OPT = -gv
+RACC_OPT = #{racc_opt}
 
 RD_LIBS = rd/block-element.rb \\
           rd/complex-list-item.rb \\
