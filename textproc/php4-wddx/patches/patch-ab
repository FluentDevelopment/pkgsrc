$NetBSD: patch-ab,v 1.2 2002/10/14 06:21:17 martti Exp $

--- config.m4.orig	Fri Nov 30 19:00:04 2001
+++ config.m4	Sat Oct 12 10:54:29 2002
@@ -5,6 +5,9 @@
 PHP_ARG_ENABLE(wddx,whether to enable WDDX support,
 [  --enable-wddx           Enable WDDX support.])
 
+PHP_ARG_WITH(expat-dir, libexpat dir for WDDX,
+[  --with-expat-dir=DIR    libexpat dir for WDDX])
+
 if test "$PHP_WDDX" != "no"; then
   if test "$ext_shared" != "yes" && test "$enable_xml" = "no"; then
     AC_MSG_WARN(Activating XML)
@@ -12,4 +15,17 @@
   fi
   AC_DEFINE(HAVE_WDDX, 1, [ ])
   PHP_EXTENSION(wddx, $ext_shared)
+  PHP_SUBST(WDDX_SHARED_LIBADD)
+
+  if test "$PHP_EXPAT_DIR" != "no"; then
+    if test -f $PHP_EXPAT_DIR/lib/libexpat.a -o -f $PHP_EXPAT_DIR/lib/libexpat.s?; then
+      AC_DEFINE(HAVE_LIBEXPAT2,1,[ ])
+      PHP_ADD_LIBRARY_WITH_PATH(expat, $PHP_EXPAT_DIR/lib, WDDX_SHARED_LIBADD)
+      PHP_ADD_INCLUDE($PHP_EXPAT_DIR/include)
+    else
+      PHP_ADD_LIBRARY_WITH_PATH(xmlparse, $PHP_EXPAT_DIR/lib, WDDX_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(xmltok, $PHP_EXPAT_DIR/lib, WDDX_SHARED_LIBADD)
+      PHP_ADD_INCLUDE($PHP_EXPAT_DIR/include)
+    fi
+  fi
 fi
