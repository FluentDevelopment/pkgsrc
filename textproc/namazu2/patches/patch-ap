$NetBSD: patch-ap,v 1.1 2003/05/25 14:12:13 taca Exp $

--- filter/mhonarc.pl.orig	2002-08-06 14:00:56.000000000 +0900
+++ filter/mhonarc.pl
@@ -156,14 +156,25 @@ sub load_mhonarc_fields {
 
     if ($mha_head =~ /<!--X-Subject: ([^-]+) -->/) {
 	my $subject = uncommentize($1);
+	if (util::islang("ja")) {
+	    codeconv::toeuc(\$subject);
+	}
 	1  while ($subject =~ s/\A\s*(re|sv|fwd|fw)[\[\]\d]*[:>-]+\s*//i);
 	$subject =~ s/\A\s*\[[^\]]+\]\s*//;
 	$fields->{'subject'} = $subject;
     }
     if ($mha_head =~ /<!--X-From-R13: ([^-]+) -->/) {
-	$fields->{'from'} = mrot13(uncommentize($1));
+	my $from = mrot13(uncommentize($1));
+	if (util::islang("ja")) {
+	    codeconv::toeuc(\$from);
+	}
+	$fields->{'from'} = $from;
     } elsif ($mha_head =~ /<!--X-From: ([^-]+) -->/) {
-	$fields->{'from'} = uncommentize($1);
+	my $from = uncommentize($1);
+	if (util::islang("ja")) {
+	    codeconv::toeuc(\$from);
+	}
+	$fields->{'from'} = $from;
     }
     if ($mha_head =~ /<!--X-Message-Id: ([^-]+) -->/) {
 	$fields->{'message-id'} = '&lt;' . uncommentize($1). '&gt;';
