$NetBSD: patch-an,v 1.1 2005/10/16 12:17:47 jdolecek Exp $

--- ext/mbstring/libmbfl/mbfl/mbfilter.c.orig	2005-10-16 14:09:17.000000000 +0200
+++ ext/mbstring/libmbfl/mbfl/mbfilter.c	2005-10-16 14:09:21.000000000 +0200
@@ -1990,7 +1990,7 @@
 		break;
 
 	default:	/* ASCII */
-		if (!qp_table[(c & 0xff)]) { /* ordinary characters */
+		if (c >= 0 && c < 0x100 && !qp_table[(c & 0xff)]) { /* ordinary characters */
 			mbfl_memory_device_output(c, &pe->tmpdev);
 			pe->status1 = 1;
 		} else if (pe->status1 == 0 && c == 0x20) {	/* repeat SPACE */
