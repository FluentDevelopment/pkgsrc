$NetBSD: patch-br,v 1.2 2004/06/23 16:47:12 taya Exp $

diff -ru ../Orig/mozilla/nsprpub/pr/src/misc/prnetdb.c ./nsprpub/pr/src/misc/prnetdb.c
--- ../Orig/mozilla/nsprpub/pr/src/misc/prnetdb.c	2004-01-23 07:22:37.000000000 +0900
+++ ./nsprpub/pr/src/misc/prnetdb.c	2004-06-15 23:56:46.000000000 +0900
@@ -2094,7 +2094,12 @@
          */
         hints.ai_socktype = SOCK_STREAM;
 
+        LOCK_DNS();
+
         rv = GETADDRINFO(hostname, NULL, &hints, &res);
+
+        UNLOCK_DNS();
+
         if (rv == 0)
             return (PRAddrInfo *) res;
 
