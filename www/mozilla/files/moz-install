#!/bin/sh
#
# $NetBSD: moz-install,v 1.1 2001/10/26 14:35:12 agc Exp $

${SED} -e "s,@PREFIX@,${PREFIX},g" ${FILESDIR}/mozilla-${OBJECT_FMT}.in > ${PREFIX}/bin/mozilla
${CHOWN} ${BINOWN} ${PREFIX}/bin/mozilla
${CHGRP} ${BINGRP} ${PREFIX}/bin/mozilla
${CHMOD} ${BINMODE} ${PREFIX}/bin/mozilla

# make directories 
for i in `${SED} -n -e '/^@comment begin DIRS$/,/^@comment end DIRS$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment | ${SED} -e 's/^@dirrm//'` ; do
	${BSD_INSTALL_DATA_DIR} ${PREFIX}/$i
done

# install programs
for i in `${SED} -n -e '/^@comment begin PROGRAMS$/,/^@comment end PROGRAMS$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment` ; do
	src=`echo $i | sed -e 's@lib/mozilla@dist/bin@'`;
	${BSD_INSTALL_PROGRAM} ${WRKSRC}/${src} ${PREFIX}/$i
done

# install scripts
for i in `${SED} -n -e '/^@comment begin SCRIPTS$/,/^@comment end SCRIPTS$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment` ; do
	src=`echo $i | sed -e 's@lib/mozilla@dist/bin@'`;
	${BSD_INSTALL_SCRIPT} ${WRKSRC}/${src} ${PREFIX}/$i
done

# install DSO
for i in `${SED} -n -e '/^@comment begin DSO$/,/^@comment end DSO$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment` ; do
	src=`echo $i | sed -e 's@lib/mozilla@dist/bin@'`;
	${BSD_INSTALL_PROGRAM} ${WRKSRC}/${src} ${PREFIX}/$i
done

# install DATA
for i in `${SED} -n -e '/^@comment begin DATA$/,/^@comment end DATA$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment` ; do
	src=`echo $i | sed -e 's@lib/mozilla@dist/bin@'`;
	${BSD_INSTALL_DATA} ${WRKSRC}/${src} ${PREFIX}/$i
done

# install INCLUDE
for i in `${SED} -n -e '/^@comment begin INCLUDE$/,/^@comment end INCLUDE$/p' ${PLIST_SRC} | ${EGREP} -v ^@comment` ; do
	src=`echo $i | sed -e 's@include/mozilla@dist/include@'`;
	${BSD_INSTALL_DATA} ${WRKSRC}/${src} ${PREFIX}/$i
done

#
#
#
cd ${PREFIX}/lib/mozilla
${SETENV} LD_LIBRARY_PATH=. MOZILLA_FIVE_HOME=. ./regxpcom
${SETENV} LD_LIBRARY_PATH=. MOZILLA_FIVE_HOME=. ./regchrome
