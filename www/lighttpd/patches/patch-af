$NetBSD: patch-af,v 1.1 2007/02/19 21:31:37 joerg Exp $

--- src/http_auth.c.orig	2006-10-04 13:29:17.000000000 +0000
+++ src/http_auth.c
@@ -733,7 +733,8 @@ static int http_auth_basic_password_comp
 			}
 		}
 
-
+		if (p->conf.auth_ldap_allow_empty_pw != 1 && pw[0] == '\0')
+			return -1;
 
 		/* build filter */
 		buffer_copy_string_buffer(p->ldap_filter, p->conf.ldap_filter_pre);
