$NetBSD: patch-ah,v 1.1 2004/09/16 15:09:01 minskim Exp $

--- lib/data.c.orig	Thu Mar 19 13:51:00 1998
+++ lib/data.c
@@ -374,7 +374,7 @@ xpmGetCmt(data, cmt)
 {
     if (!data->type)
 	*cmt = NULL;
-    else if (data->CommentLength) {
+    else if (data->CommentLength != 0 && data->CommentLength < SIZE_MAX - 1) {
 	*cmt = (char *) XpmMalloc(data->CommentLength + 1);
 	strncpy(*cmt, data->Comment, data->CommentLength);
 	(*cmt)[data->CommentLength] = '\0';
