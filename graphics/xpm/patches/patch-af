$NetBSD: patch-af,v 1.1 2004/09/16 15:09:01 minskim Exp $

--- lib/CrDatFrI.c.orig	Thu Mar 19 13:50:59 1998
+++ lib/CrDatFrI.c
@@ -123,6 +123,8 @@ XpmCreateDataFromXpmImage(data_return, i
      */
     header_nlines = 1 + image->ncolors;
     header_size = sizeof(char *) * header_nlines;
+    if (header_size >= SIZE_MAX / sizeof(char *))
+	return (XpmNoMemory);
     header = (char **) XpmCalloc(header_size, sizeof(char *));
     if (!header)
 	return (XpmNoMemory);
