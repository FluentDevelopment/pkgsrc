$NetBSD: patch-ac,v 1.5 2002/08/28 13:49:36 seb Exp $

--- configure.orig	Mon Aug  5 05:08:48 2002
+++ configure
@@ -1479,60 +1479,9 @@ else
   fi
 fi
 
-for ac_declaration in \
-   ''\
-   '#include <stdlib.h>' \
-   'extern "C" void std::exit (int) throw (); using std::exit;' \
-   'extern "C" void std::exit (int); using std::exit;' \
-   'extern "C" void exit (int) throw ();' \
-   'extern "C" void exit (int);' \
-   'void exit (int);'
-do
-  cat > conftest.$ac_ext <<EOF
-#line 1493 "configure"
-#include "confdefs.h"
-#include <stdlib.h>
-$ac_declaration
-int main() {
-exit (42);
-; return 0; }
-EOF
-if { (eval echo configure:1501: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  :
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  continue
-fi
-rm -f conftest*
-  cat > conftest.$ac_ext <<EOF
-#line 1511 "configure"
-#include "confdefs.h"
-$ac_declaration
-int main() {
-exit (42);
-; return 0; }
-EOF
-if { (eval echo configure:1518: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  break
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-fi
-rm -f conftest*
-done
-if test -n "$ac_declaration"; then
-  echo '#ifdef __cplusplus' >>confdefs.h
-  echo $ac_declaration      >>confdefs.h
-  echo '#endif'             >>confdefs.h
-fi
-
-
 
         echo $ac_n "checking for strerror in -lcposix""... $ac_c" 1>&6
-echo "configure:1536: checking for strerror in -lcposix" >&5
+echo "configure:1485: checking for strerror in -lcposix" >&5
 ac_lib_var=`echo cposix'_'strerror | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1864,7 +1813,7 @@ test -n "$YACC" && break
 done
 test -n "$YACC" || YACC="yacc"
 
-for ac_prog in gawk mawk nawk awk
+for ac_prog in mawk gawk nawk awk
 do
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
@@ -5897,7 +5846,10 @@ DEFAULT_FONTPATH="C:/WINDOWS/FONTS;C:/WI
 PATHSEPARATOR=";"
 else
 # This sucks!  Whatever happened to standards for file system layout?
-DEFAULT_FONTPATH="/usr/X11R6/lib/X11/fonts/TrueType:/usr/X11R6/lib/X11/fonts/truetype:/usr/X11R6/lib/X11/fonts/TTF:/usr/share/fonts/TrueType:/usr/share/fonts/truetype:/usr/openwin/lib/X11/fonts/TrueType:/usr/X11R6/lib/X11/fonts/Type1"
+DEFAULT_FONTPATH="${X11PREFIX}/lib/X11/fonts/TrueType:${X11PREFIX}/lib/X11/fonts/truetype:${X11PREFIX}/lib/X11/fonts/Type1"
+if test x"$X11PREFIX" != x"$X11BASE" ; then
+DEFAULT_FONTPATH="${DEFAULT_FONTPATH}:${X11BASE}/lib/X11/fonts/TrueType:${X11BASE}/lib/X11/fonts/truetype:${X11BASE}/lib/X11/fonts/Type1"
+fi
 PATHSEPARATOR=":"
 fi
 fi
@@ -6113,7 +6065,7 @@ if test -f $TCLCONFIG; then
     . $file
     # TCL STUBS support is required
     if test "${TCL_SUPPORTS_STUBS}" = "1"; then
-        TCL_SUBDIRS="tclstubs tclhandle gdtclft tcldot tcldgr tcldgl tclpathplan"
+        TCL_SUBDIRS="tclhandle gdtclft tcldot tcldgr tcldgl tclpathplan"
         TCL_PKGINDEX="gdtclft/pkgIndex.tcl tcldot/pkgIndex.tcl tcldgr/pkgIndex.tcl tcldgl/pkgIndex.tcl tclpathplan/pkgIndex.tcl"
     else
         echo "configure: warning: Tcl does not have STUBs support, perhaps it is too old? The packages: "gdtclft tcldot tcldgr tcldgl tclpathplan" will not be built" 1>&2
@@ -6203,7 +6155,7 @@ if test -f $TKCONFIG; then
     file=${TKCONFIG}
     . $file
     if test "${TCL_SUPPORTS_STUBS}" = "1"; then
-        TK_SUBDIRS="tkstubs tkspline"
+        TK_SUBDIRS="tkspline"
         TK_PKGINDEX="tkspline/pkgIndex.tcl"
     else
         echo "configure: warning: Tcl does not have STUBs support, so neither does Tk. The packages: "tkspline" will not be built" 1>&2
@@ -8736,36 +8688,12 @@ rm -f conftest*
 
 # -----------------------------------
 # tclInt.h
-if test -f "$TCL_SRC_DIR/generic/tclInt.h"; then
-TCLINT_INCLUDES="-I$TCL_SRC_DIR/generic"
-else
-if test -f "/usr/include/tclInt.h"; then
-TCLINT_INCLUDES=""
-else
-if test -f "/usr/local/include/tclInt.h"; then
-TCLINT_INCLUDES="-I/usr/local/include"
-else
-TCLINT_INCLUDES="-I$TOP_DIR/tclstubs"
-fi
-fi
-fi
+TCLINT_INCLUDES="-I${BUILDLINK_PREFIX_TCL}/include/tcl/generic"
 
 
 # -----------------------------------
 # tkInt.h
-if test -f "$TK_SRC_DIR/generic/tkInt.h"; then
-TKINT_INCLUDES="-I$TK_SRC_DIR/generic"
-else
-if test -f "/usr/include/tkInt.h"; then
-TKINT_INCLUDES=""
-else
-if test -f "/usr/local/include/tkInt.h"; then
-TKINT_INCLUDES="-I/usr/local/include"
-else
-TKINT_INCLUDES="-I$TOP_DIR/tkstubs"
-fi
-fi
-fi
+TKINT_INCLUDES="-I${BUILDLINK_PREFIX_TK}/include/tk/generic"
 
 
 # -----------------------------------
