$NetBSD: patch-ac,v 1.9 2004/04/17 16:56:10 seb Exp $

--- configure.orig	2004-03-02 00:20:47.000000000 +0000
+++ configure
@@ -1021,8 +1021,6 @@ Optional Packages:
   --with-pic              try to use only PIC/non-PIC objects default=use both
   --with-dmalloc          use dmalloc for debugging memory use
   --with-efence           use efence for debugging memory use
-  --with-tclsh=PROG       build graphviz for specific tclsh
-  --with-wish=PROG        build graphviz for specific wish
   --with-extraincludedir=DIR use extra includes from DIR
   --with-extralibdir=DIR  use extra libraries from DIR
   --with-x                use the X Window System
@@ -1530,7 +1528,10 @@ case "${target_os}" in
 	PATHSEPARATOR=":"
 	;;
   * ) # This sucks!  Whatever happened to standards for file system layout?
-	DEFAULT_FONTPATH="/usr/X11R6/lib/X11/fonts/TrueType:/usr/X11R6/lib/X11/fonts/truetype:/usr/X11R6/lib/X11/fonts/TTF:/usr/share/fonts/TrueType:/usr/share/fonts/truetype:/usr/openwin/lib/X11/fonts/TrueType:/usr/X11R6/lib/X11/fonts/Type1:/usr/common/share/fonts/ttf";
+	DEFAULT_FONTPATH="${X11PREFIX}/lib/X11/fonts/TrueType:${X11PREFIX}/lib/X11/fonts/truetype:${X11PREFIX}/lib/X11/fonts/TTF:/usr/share/fonts/TrueType:/usr/share/fonts/truetype:/usr/openwin/lib/X11/fonts/TrueType:/usr/X11R6/lib/X11/fonts/Type1:/usr/common/share/fonts/ttf";
+        if test x"$X11PREFIX" != x"$X11BASE"; then
+            DEFAULT_FONTPATH="${DEFAULT_FONTPATH}:${X11BASE}/lib/X11/fonts/TrueType:${X11BASE}/lib/X11/fonts/truetype:${X11BASE}/lib/X11/fonts/TTF:${X11BASE}/lib/X11/fonts/Type1"
+        fi
 	PATHSEPARATOR=":"
 	;;
 esac
@@ -8964,169 +8965,14 @@ fi
 #     AC_MSG_RESULT(no)
 # )
 
-
-# Check whether --with-tclsh or --without-tclsh was given.
-if test "${with_tclsh+set}" = set; then
-  withval="$with_tclsh"
-  TCLSH=$withval
-fi;
-if test "x$TCLSH" = "x"; then
-	# Extract the first word of "tclsh8.4", so it can be a program name with args.
-set dummy tclsh8.4; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_TCLSH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $TCLSH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_TCLSH="$TCLSH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_TCLSH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-TCLSH=$ac_cv_path_TCLSH
-
-if test -n "$TCLSH"; then
-  echo "$as_me:$LINENO: result: $TCLSH" >&5
-echo "${ECHO_T}$TCLSH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-	if test "x$TCLSH" = "x"; then
-		# Extract the first word of "tclsh8.3", so it can be a program name with args.
-set dummy tclsh8.3; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_TCLSH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $TCLSH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_TCLSH="$TCLSH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_TCLSH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-TCLSH=$ac_cv_path_TCLSH
-
-if test -n "$TCLSH"; then
-  echo "$as_me:$LINENO: result: $TCLSH" >&5
-echo "${ECHO_T}$TCLSH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-		if test "x$TCLSH" = "x"; then
-			# Extract the first word of "tclsh", so it can be a program name with args.
-set dummy tclsh; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_TCLSH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $TCLSH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_TCLSH="$TCLSH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_TCLSH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-TCLSH=$ac_cv_path_TCLSH
-
-if test -n "$TCLSH"; then
-  echo "$as_me:$LINENO: result: $TCLSH" >&5
-echo "${ECHO_T}$TCLSH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-		fi
-	fi
-fi
-TCL_VERSION_FOUND=`echo 'puts [info tclversion]' | $TCLSH`
-
-# can't assume ksh on all architectures
-# TCLSH_EXEC_PREFIX=${TCLSH%%/bin/tclsh.*}
-TCLSH_EXEC_PREFIX=`echo $TCLSH|sed -e 's%/bin/tclsh.*$%%'`
-
-if test -f ${TCLSH_EXEC_PREFIX}/include/tcl${TCL_VERSION_FOUND}/tcl.h; then
-	TCL_INCLUDES="-I${TCLSH_EXEC_PREFIX}/include/tcl${TCL_VERSION_FOUND} -I${TCLSH_EXEC_PREFIX}/include/tcl${TCL_VERSION_FOUND}/generic"
-else
-if test "x${TCLSH_EXEC_PREFIX}" != "x/usr" -a -f ${TCLSH_EXEC_PREFIX}/include/tcl.h; then
-	TCL_INCLUDES=-I${TCLSH_EXEC_PREFIX}/include
-fi
-fi
-if test "x$TCL_INCLUDES" != "x" ; then
-	echo "$as_me:$LINENO: result: using tcl headers from $TCL_INCLUDES" >&5
-echo "${ECHO_T}using tcl headers from $TCL_INCLUDES" >&6
-fi
-
-
-# Some systems don't have Tcl.  Don't build
-# the Tcl products if we don't have the library.
-if test -f ${TCLSH_EXEC_PREFIX}/lib/tcl${TCL_VERSION_FOUND}/tclConfig.sh; then
-	TCLCONFIG=${TCLSH_EXEC_PREFIX}/lib/tcl${TCL_VERSION_FOUND}/tclConfig.sh
-else
-if test -f ${TCLSH_EXEC_PREFIX}/lib/tclConfig.sh; then
-	TCLCONFIG=${TCLSH_EXEC_PREFIX}/lib/tclConfig.sh
-fi
-fi
-
 if test "x$TCLCONFIG" != "x"; then
     echo "$as_me:$LINENO: result: using $TCLCONFIG" >&5
 echo "${ECHO_T}using $TCLCONFIG" >&6
     file=${TCLCONFIG}
     . $file
+    #
+    TCLSH_EXEC_PREFIX="${TCL_EXEC_PREFIX}"
+    TCL_INCLUDES="${TCL_INCLUDE_SPEC}"
     # TCL STUBS support is required
     if test "${TCL_SUPPORTS_STUBS}" = "1"; then
 #        TCL_SUBDIRS="tclstubs tclhandle gdtclft tcldot tcldgr tcldgl tclpathplan"
@@ -9212,174 +9058,14 @@ fi
 
 
 
-# Check whether --with-wish or --without-wish was given.
-if test "${with_wish+set}" = set; then
-  withval="$with_wish"
-  WISH=$withval
-fi;
-if test "x$WISH" = "x"; then
-	# Extract the first word of "wish8.4", so it can be a program name with args.
-set dummy wish8.4; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_WISH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $WISH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_WISH="$WISH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_WISH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-WISH=$ac_cv_path_WISH
-
-if test -n "$WISH"; then
-  echo "$as_me:$LINENO: result: $WISH" >&5
-echo "${ECHO_T}$WISH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-	if test "x$WISH" = "x"; then
-		# Extract the first word of "wish8.3", so it can be a program name with args.
-set dummy wish8.3; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_WISH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $WISH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_WISH="$WISH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_WISH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-WISH=$ac_cv_path_WISH
-
-if test -n "$WISH"; then
-  echo "$as_me:$LINENO: result: $WISH" >&5
-echo "${ECHO_T}$WISH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-		if test "x$WISH" = "x"; then
-			# Extract the first word of "wish", so it can be a program name with args.
-set dummy wish; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_WISH+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $WISH in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_WISH="$WISH" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_WISH="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-WISH=$ac_cv_path_WISH
-
-if test -n "$WISH"; then
-  echo "$as_me:$LINENO: result: $WISH" >&5
-echo "${ECHO_T}$WISH" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-		fi
-	fi
-fi
-
-
-#TK_VERSION_FOUND=`echo 'puts [[info tkversion]]' | $WISH`
-#
-# No such var as tkversion.  Use tclversion instead.
-TK_VERSION_FOUND=${TCL_VERSION_FOUND}
-
-# can't assume ksh on all architectures
-# WISH_EXEC_PREFIX=${WISH%%/bin/tclsh.*}
-WISH_EXEC_PREFIX=`echo $WISH|sed -e 's%/bin/wish.*$%%'`
-
-if test -f ${WISH_EXEC_PREFIX}/include/tk${TK_VERSION_FOUND}/tk.h; then
-	TK_INCLUDES="-I${WISH_EXEC_PREFIX}/include/tk${TK_VERSION_FOUND} -I${WISH_EXEC_PREFIX}/include/tk${TK_VERSION_FOUND}/generic"
-else
-if test "x${WISH_EXEC_PREFIX}" != "x/usr" -a -f ${WISH_EXEC_PREFIX}/include/tk.h; then
-	TK_INCLUDES=-I${WISH_EXEC_PREFIX}/include
-fi
-fi
-if test "x$TK_INCLUDES" != "x" ; then
-	echo "$as_me:$LINENO: result: using tk headers from $TK_INCLUDES" >&5
-echo "${ECHO_T}using tk headers from $TK_INCLUDES" >&6
-fi
-
-
-# Some systems don't have Tcl.  Don't build
-# Some systems have Tcl, but not TK.  Don't build
-# the Tk products if we don't have the library.
-if test -f ${WISH_EXEC_PREFIX}/lib/tk${TK_VERSION_FOUND}/tkConfig.sh; then
-	TKCONFIG=${WISH_EXEC_PREFIX}/lib/tk${TK_VERSION_FOUND}/tkConfig.sh
-else
-if test -f ${WISH_EXEC_PREFIX}/lib/tkConfig.sh; then
-	TKCONFIG=${WISH_EXEC_PREFIX}/lib/tkConfig.sh
-fi
-fi
-
 if test "x$TKCONFIG" != "x"; then
     echo "$as_me:$LINENO: result: using $TKCONFIG" >&5
 echo "${ECHO_T}using $TKCONFIG" >&6
     file=${TKCONFIG}
     . $file
+    #
+    WISH_EXEC_PREFIX="${TK_EXEC_PREFIX}"
+    TK_INCLUDES="-I${TK_PREFIX}/include"
     if test "${TCL_SUPPORTS_STUBS}" = "1"; then
         TK_PKGINDEX="tkspline/pkgIndex.tcl"
     else
@@ -9434,6 +9120,7 @@ fi
 
 
 
+
 # Check whether --with-extraincludedir or --without-extraincludedir was given.
 if test "${with_extraincludedir+set}" = set; then
   withval="$with_extraincludedir"
@@ -13653,36 +13340,12 @@ rm -f conftest.$ac_objext conftest.$ac_e
 
 # -----------------------------------
 # tclInt.h
-if test -f "$TCL_SRC_DIR/generic/tclInt.h"; then
-TCLINT_INCLUDES="-I$TCL_SRC_DIR/generic"
-else
-if test -f "/usr/include/tclInt.h"; then
-TCLINT_INCLUDES=""
-else
-if test -f "/usr/local/include/tclInt.h"; then
-TCLINT_INCLUDES="-I/usr/local/include"
-else
-TCLINT_INCLUDES="-I$TOP_DIR/tclstubs"
-fi
-fi
-fi
+TCLINT_INCLUDES="-I${TCL_PREFIX}/include/tcl/generic"
 
 
 # -----------------------------------
 # tkInt.h
-if test -f "$TK_SRC_DIR/generic/tkInt.h"; then
-TKINT_INCLUDES="-I$TK_SRC_DIR/generic"
-else
-if test -f "/usr/include/tkInt.h"; then
-TKINT_INCLUDES=""
-else
-if test -f "/usr/local/include/tkInt.h"; then
-TKINT_INCLUDES="-I/usr/local/include"
-else
-TKINT_INCLUDES="-I$TOP_DIR/tkstubs"
-fi
-fi
-fi
+TKINT_INCLUDES="-I${TK_PREFIX}/include/tk/generic"
 
 
 # -----------------------------------
@@ -14920,8 +14583,6 @@ s,@ENABLE_GVRENDER_TRUE@,$ENABLE_GVRENDE
 s,@ENABLE_GVRENDER_FALSE@,$ENABLE_GVRENDER_FALSE,;t t
 s,@ENABLE_CODEGENS_TRUE@,$ENABLE_CODEGENS_TRUE,;t t
 s,@ENABLE_CODEGENS_FALSE@,$ENABLE_CODEGENS_FALSE,;t t
-s,@TCLSH@,$TCLSH,;t t
-s,@TCL_INCLUDES@,$TCL_INCLUDES,;t t
 s,@WITH_TCL_TRUE@,$WITH_TCL_TRUE,;t t
 s,@WITH_TCL_FALSE@,$WITH_TCL_FALSE,;t t
 s,@TCL_PKGINDEX@,$TCL_PKGINDEX,;t t
@@ -14944,6 +14605,7 @@ s,@TCL_NEEDS_EXP_FILE@,$TCL_NEEDS_EXP_FI
 s,@TCL_EXPORT_FILE_SUFFIX@,$TCL_EXPORT_FILE_SUFFIX,;t t
 s,@TCL_LIBS@,$TCL_LIBS,;t t
 s,@TCL_PREFIX@,$TCL_PREFIX,;t t
+s,@TCL_INCLUDES@,$TCL_INCLUDES,;t t
 s,@TCL_EXEC_PREFIX@,$TCL_EXEC_PREFIX,;t t
 s,@TCL_SHLIB_CFLAGS@,$TCL_SHLIB_CFLAGS,;t t
 s,@TCL_SHLIB_CXXFLAGS@,$TCL_SHLIB_CXXFLAGS,;t t
@@ -14971,8 +14633,6 @@ s,@TCL_BUILD_STUB_LIB_SPEC@,$TCL_BUILD_S
 s,@TCL_STUB_LIB_SPEC@,$TCL_STUB_LIB_SPEC,;t t
 s,@TCL_BUILD_STUB_LIB_PATH@,$TCL_BUILD_STUB_LIB_PATH,;t t
 s,@TCL_STUB_LIB_PATH@,$TCL_STUB_LIB_PATH,;t t
-s,@WISH@,$WISH,;t t
-s,@TK_INCLUDES@,$TK_INCLUDES,;t t
 s,@WITH_TK_TRUE@,$WITH_TK_TRUE,;t t
 s,@WITH_TK_FALSE@,$WITH_TK_FALSE,;t t
 s,@TK_PKGINDEX@,$TK_PKGINDEX,;t t
@@ -14999,6 +14659,7 @@ s,@TK_BUILD_STUB_LIB_SPEC@,$TK_BUILD_STU
 s,@TK_STUB_LIB_SPEC@,$TK_STUB_LIB_SPEC,;t t
 s,@TK_BUILD_STUB_LIB_PATH@,$TK_BUILD_STUB_LIB_PATH,;t t
 s,@TK_STUB_LIB_PATH@,$TK_STUB_LIB_PATH,;t t
+s,@TK_INCLUDES@,$TK_INCLUDES,;t t
 s,@SOCKET_LIBS@,$SOCKET_LIBS,;t t
 s,@X_CFLAGS@,$X_CFLAGS,;t t
 s,@X_PRE_LIBS@,$X_PRE_LIBS,;t t
