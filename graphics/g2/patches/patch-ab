$NetBSD: patch-ab,v 1.2 2003/04/29 22:02:10 jtb Exp $

--- Makefile.in.orig
+++ Makefile.in
@@ -68,31 +68,22 @@
 
 INS =  $(BASE_INS) $(PS_INS) $(X11_INS) $(GIF_INS) $(GD_INS)
 
-.c.o:  
-	$(CC) $(CFLAGS) -c $< -o $@
+.c.o:
+	$(LIBTOOL) $(CC) $(CFLAGS) -c $< -o $@
 
 
-all: libg2.a
+all: libg2.la
 	test -d ./include || mkdir ./include
 	cp $(INS) ./include/
 
-shared: libg2.@LD_SHARED_EXT@
-	@echo
-
-
-libg2.a: $(OBJ)
-	$(AR) $(ARFLAGS) libg2.a $(OBJ)
-	test ! -n "$(RANLIB)" || $(RANLIB) $@
-	test ! -f ./libg2.$(G2_VERSION).a || rm ./libg2.$(G2_VERSION).a
-	ln -s libg2.a libg2.$(G2_VERSION).a
+libg2.la: $(OBJ)
+	$(LIBTOOL) $(CC) -o $@ $(OBJ:.o=.lo) -Wl,-R$(X11BASE)/lib \
+	-L$(X11BASE)/lib -lX11 -lm --version-info 0:0 -rpath $(LIBDIR)
 
-libg2.@LD_SHARED_EXT@: $(OBJ)
-	@LD_SHARED@ @LD_SHARED_FLAGS@ -o $@ $(OBJ) @LD_SHARED_OPT@
-
-install: libg2.a
+install: libg2.la
 	test -d $(LIBDIR) || mkdir -p $(LIBDIR)
 	test -d $(INCDIR) || mkdir -p $(INCDIR)
-	$(INSTALL_DATA) libg2.a $(LIBDIR)
+	$(LIBTOOL) $(INSTALL_DATA) libg2.la $(LIBDIR)
 	for IFILE in $(INS); do \
 		$(INSTALL_DATA) $$IFILE  $(INCDIR); \
 	done
@@ -108,7 +99,7 @@
 	-rm -f ./libg2.@LD_SHARED_EXT@
 	-rm -f libg2.$(G2_VERSION).a
 
-demo:	libg2.a
+demo:	libg2.la
 	(cd ./demo ; make)
 
 depend:
@@ -119,4 +110,3 @@
 
 
 # DO NOT DELETE THIS LINE -- make  depend  depends  on it.
-
