$NetBSD: patch-ab,v 1.3 2002/07/11 14:24:00 abs Exp $

--- Lib/Makefile.orig	Sun Jun  4 10:49:23 2000
+++ Lib/Makefile
@@ -1,6 +1,6 @@
-CPPFLAGS=-I../Jpeg -I../Zlib
+CPPFLAGS=-I${LOCALBASE}/include
 # Comment out the following line if you use egcs :
-CXXFLAGS=-O3 -Wall -fno-rtti -fno-exceptions
+CXXFLAGS=-O3 -Wall -fno-rtti -fno-exceptions ${CFLAGS}
 
 INCLUDES= adpcm.h        cxform.h       graphic.h      script.h       sqrt.h\
 	bitmap.h       displaylist.h  matrix.h       shape.h        swf.h\
@@ -34,10 +34,20 @@ SWFOBJS=\
 #	bitstream.o
 #	dump.o
 
+.cc.o:
+	${LIBTOOL} --mode=compile ${CXX} -c ${CPPFLAGS} ${CXXFLAGS} ${.IMPSRC}
+
 all: libflash.a
 
+install:
+	${LIBTOOL} --mode=install ${BSD_INSTALL_DATA} libflash.la ${PREFIX}/lib
+	${BSD_INSTALL_DATA_DIR} ${PREFIX}/include/flash
+.for file in ${INCLUDES}
+	${BSD_INSTALL_DATA} ${file} ${PREFIX}/include/flash
+.endfor
+
 libflash.a: $(SWFOBJS) 
-	ar rcs $@ $(SWFOBJS)
+	${LIBTOOL} --mode=link ${CC} -o ${.TARGET:.a=.la} ${SWFOBJS:.o=.lo} -rpath ${PREFIX}/lib -L${PREFIX}/lib -Wl,-R${PREFIX}/lib -ljpeg -version-info 0:4
 
 $(SWFOBJS): $(INCLUDES)
 
