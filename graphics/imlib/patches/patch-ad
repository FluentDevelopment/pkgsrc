$NetBSD: patch-ad,v 1.7 2002/03/29 18:01:14 wiz Exp $

--- configure.in.orig	Fri Mar 22 15:51:24 2002
+++ configure.in
@@ -32,6 +32,8 @@
 	fi
 ])
 
+AC_PATH_PROG(GLIB_CONFIG, glib-config, no)
+
 dynworks=false
 if test x$with_modules = xno; then
 	AC_MSG_RESULT(no)
@@ -41,8 +43,8 @@
 if test "x$GDK_IMLIB" != x; then
   oLIBS="$LIBS"
   oCFLAGS="$CFLAGS"
-  LIBS="$LIBS `glib-config --libs gmodule`"
-  CFLAGS="$CFLAGS `glib-config --cflags gmodule`"
+  LIBS="$LIBS `$GLIB_CONFIG --libs gmodule`"
+  CFLAGS="$CFLAGS `$GLIB_CONFIG --cflags gmodule`"
   AC_TRY_RUN([
 #include <glib.h>
 #include <gmodule.h>
@@ -74,8 +76,8 @@
 
 if $dynworks; then
    AC_DEFINE(USE_GMODULE)
-   GMODULE_LIBS="`glib-config --libs gmodule`"
-   GMODULE_FLAGS="`glib-config --cflags gmodule`"
+   GMODULE_LIBS="`$GLIB_CONFIG --libs gmodule`"
+   GMODULE_FLAGS="`$GLIB_CONFIG --cflags gmodule`"
    AC_SUBST(GMODULE_LIBS)
    AC_SUBST(GMODULE_FLAGS)
 fi
@@ -139,7 +141,9 @@
   GX_LIBS="$GTK_LIBS"
 fi
 
-CPPFLAGS="$CPPFLAGS -I$includedir -I$prefix/include"
+if test -z "$X_LDFLAGS"; then
+  X_LDFLAGS=
+fi
 
 SUPPORT_LIBS=""
 
@@ -309,6 +313,7 @@
 AC_SUBST(CPPFLAGS)
 AC_SUBST(X_CFLAGS)
 AC_SUBST(LDFLAGS)
+AC_SUBST(X_LDFLAGS)
 AC_SUBST(X_PRE_LIBS)
 AC_SUBST(X_LIBS)
 AC_SUBST(X_EXTRA_LIBS)
