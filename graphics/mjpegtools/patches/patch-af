$NetBSD: patch-af,v 1.1 2003/08/02 16:42:45 mrg Exp $

--- yuvdenoise/motion.c.orig	2002-09-12 06:13:03.000000000 +1000
+++ yuvdenoise/motion.c	2003-08-03 02:17:04.000000000 +1000
@@ -244,6 +244,7 @@
 calc_SAD_uv_mmx (uint8_t * frm, uint8_t * ref)
 {
   static uint16_t a[4];
+  int32_t w = denoiser.frame.w/2;
   
 #ifdef HAVE_ASM_MMX
   __asm__ __volatile__
@@ -273,7 +274,7 @@
     "                                      /*                                                    */\n"
     " movq         %%mm0 , %0   ;          /* make mm0 available to gcc ...                      */\n"
     :"=m" (a)     
-    :"m" (frm), "m" (ref), "m" (denoiser.frame.w/2)
+    :"m" (frm), "m" (ref), "m" (w)
     :"%eax", "%ebx", "%ecx"
     );
 #endif
@@ -290,6 +291,7 @@
 calc_SAD_uv_mmxe (uint8_t * frm, uint8_t * ref)
 {
   static uint32_t a;
+  int32_t w = denoiser.frame.w/2;
 
 #ifdef HAVE_ASM_MMX
   __asm__ __volatile__
@@ -310,7 +312,7 @@
     "                                      /*                                                    */\n"
     " movq         %%mm0 , %0   ;          /* make mm0 available to gcc ...                      */\n"
     :"=m" (a)     
-    :"m" (frm), "m" (ref), "m" (denoiser.frame.w/2)
+    :"m" (frm), "m" (ref), "m" (w)
     :"%eax", "%ebx", "%ecx"
     );
 #endif
@@ -383,7 +385,7 @@
 	  "                                      /*                                                    */"
 	  " movq         %%mm0 , %0   ;          /* make mm0 available to gcc ...                      */"
 	  :"=m" (a)     
-	  :"m" (frm1),"m" (frm2), "m" (ref), "m" (denoiser.frame.w), "m" (bit_mask)
+	  :"m" (frm1),"m" (frm2), "m" (ref), "m" (denoiser.frame.w), "m" (bit_mask[0])
 	  :"%eax", "%ebx", "%ecx", "%edx"
 	  );
 #endif
