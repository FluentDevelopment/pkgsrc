$NetBSD: patch-ag,v 1.1 2004/07/16 23:40:54 xtraeme Exp $

--- src/crc32.c.orig	2001-07-06 08:33:08.000000000 +0200
+++ src/crc32.c
@@ -95,17 +95,16 @@ int crc32(register int fd, unsigned long
 {
   char                  buf[BUFFERSIZE], *p;
   int                   len = 0, nr;
-  unsigned long         crc = ~0, crc32_total = ~0;
+  unsigned long         crc = 0xffffffff;
 	
   while ((nr = read(fd, buf, sizeof(buf))) > 0)
     for (len += nr, p = buf; nr--; ++p) {
       crc = (crc >> 8) ^ crctable[(crc ^ *p) & 0xff];
-      crc32_total = (crc >> 8) ^ crctable[(crc32_total ^ *p) & 0xff];
     }
   if (nr < 0)
     return 1;
 
   *main_len = len;
-  *main_val = ~crc;
+  *main_val = (~crc)&0xffffffff;
   return 0;
 }
