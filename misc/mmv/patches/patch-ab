$NetBSD: patch-ab,v 1.3 2005/11/08 03:03:44 tv Exp $

--- mmv.c.orig	1993-10-25 06:29:39.000000000 -0400
+++ mmv.c
@@ -123,10 +123,13 @@ extern unsigned _stklen = 10000;
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <sys/file.h>
+#include <sys/param.h>
 
+#if !(defined(BSD) && BSD >= 199306)
 extern char *getenv();
 extern long lseek();
 extern char *malloc();
+#endif
 
 #ifdef HAS_DIRENT
 #include <dirent.h>
@@ -188,7 +191,7 @@ extern char *strcpy(), *strchr();
 #include <fcntl.h>
 #endif
 
-#ifdef IS_SYSV
+#if defined(IS_SYSV) || defined(__INTERIX)
 
 /* for System V and Version 7*/
 struct utimbuf {
@@ -197,6 +200,9 @@ struct utimbuf {
 };
 #define utimes(f, t) utime((f), &(t))
 
+#endif
+
+#ifdef IS_SYSV
 #ifndef HAS_RENAME
 #ifndef MV_DIR
 # define MV_DIR "/usr/lib/mv_dir"
@@ -2631,7 +2637,7 @@ static int copy(ff, len)
 #ifdef IS_MSDOS
 	struct ftime tim;
 #else
-#ifdef IS_SYSV
+#if defined(IS_SYSV) || defined(__INTERIX)
 	struct utimbuf tim;
 #else
 	struct timeval tim[2];
@@ -2706,7 +2712,7 @@ static int copy(ff, len)
 #else
 			stat(pathbuf, &fstat) ||
 			(
-#ifdef IS_SYSV
+#if defined(IS_SYSV) || defined(__INTERIX)
 				tim.actime = fstat.st_atime,
 				tim.modtime = fstat.st_mtime,
 #else
