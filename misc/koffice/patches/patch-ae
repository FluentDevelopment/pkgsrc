$NetBSD: patch-ae,v 1.6 2005/01/21 11:32:12 markd Exp $

--- filters/kword/pdf/xpdf/xpdf/XRef.cc.orig	2004-10-31 05:43:18.000000000 +1300
+++ filters/kword/pdf/xpdf/xpdf/XRef.cc
@@ -501,6 +501,12 @@ GBool XRef::checkEncrypted(GString *owne
 	} else {
 	  keyLength = 5;
 	}
+	if (keyLength < 1) {
+	  keyLength = 1;
+	}
+	if (keyLength > 16) {
+	  keyLength = 16;
+	}
 	permFlags = permissions.getInt();
 	if (encVersion >= 1 && encVersion <= 2 &&
 	    encRevision >= 2 && encRevision <= 3) {
