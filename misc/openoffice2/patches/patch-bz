$NetBSD: patch-bz,v 1.1 2007/04/01 23:50:59 hira Exp $

Security fixes for CVE-2007-0238.  This has been fixed in OOo 2.2.

--- sc/source/filter/starcalc/scflt.cxx.orig	2006-12-02 02:56:27.000000000 +0900
+++ sc/source/filter/starcalc/scflt.cxx	2007-04-02 06:27:54.000000000 +0900
@@ -4,9 +4,9 @@
  *
  *  $RCSfile: patch-bz,v $
  *
- *  $Revision: 1.1 $
+ *  $Revision: 1.1 $
  *
- *  last change: $Author: hira $ $Date: 2007/04/01 23:50:59 $
+ *  last change: $Author: hira $ $Date: 2007/04/01 23:50:59 $
  *
  *  The Contents of this file are made available subject to
  *  the terms of GNU Lesser General Public License Version 2.1.
@@ -1770,12 +1770,13 @@
 			rStream >> NoteLen;
 			if (NoteLen != 0)
 			{
-				sal_Char Note[4096];
-				rStream.Read(Note, NoteLen);
-				Note[NoteLen] = 0;
-			        String aText( SC10TOSTRING(Note));
-			        ScPostIt aNote(aText, pDoc);
+				sal_Char* pNote = new sal_Char[NoteLen+1];
+				rStream.Read(pNote, NoteLen);
+				pNote[NoteLen] = 0;
+				String aText( SC10TOSTRING(pNote));
+				ScPostIt aNote(aText, pDoc);
 				pDoc->SetNote(Col, static_cast<SCROW> (Row), Tab, aNote );
+				delete [] pNote;
 			}
 		}
 		pPrgrsBar->Progress();
