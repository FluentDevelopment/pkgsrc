$NetBSD: patch-cf,v 1.2 2007/04/02 01:25:49 hira Exp $

Security fixes for CVE-2007-0239.  This has been fixed in OOo 2.2.

--- shell/source/unix/exec/shellexec.hxx.orig	2006-12-02 02:57:03.000000000 +0900
+++ shell/source/unix/exec/shellexec.hxx	2007-04-02 10:07:28.000000000 +0900
@@ -44,6 +44,10 @@
 #include <osl/mutex.hxx>
 #endif
 
+#ifndef _RTL_STRBUF_HXX_
+#include <rtl/strbuf.hxx>
+#endif
+
 #ifndef _COM_SUN_STAR_LANG_XSERVICEINFO_HPP_
 #include <com/sun/star/lang/XServiceInfo.hpp>
 #endif
@@ -90,4 +94,8 @@
         throw(::com::sun::star::uno::RuntimeException);    
 }; 
 
+
+// helper function - needed for urltest
+void escapeForShell( rtl::OStringBuffer & rBuffer, const rtl::OString & rURL);
+
 #endif 
