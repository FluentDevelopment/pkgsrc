<!-- $NetBSD: editing.xml,v 1.10 2006/02/12 14:44:59 rillig Exp $ -->

<appendix id="editing">
  <title>Editing guidelines for the pkgsrc guide</title>

  <para>
    This section contains information on editing the pkgsrc guide
    itself.
  </para>

  <sect1 id="targets">
    <title>Targets</title>

    <para>
      The pkgsrc guide's source code is stored in
      <filename>pkgsrc/doc/guide/files</filename>, and several files are
      created from it:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          <filename>pkgsrc/doc/pkgsrc.txt</filename>
        </para>
      </listitem>

      <listitem>
        <para>
          <filename>pkgsrc/doc/pkgsrc.html</filename>
        </para>
      </listitem>

      <listitem>
        <para>
          <filename>http://www.NetBSD.org/Documentation/pkgsrc/</filename>:
  	the documentation on the NetBSD website will be built from
  	pkgsrc and kept up to date on the web server itself. This
  	means you <emphasis>must</emphasis> make sure that your
  	changes haven't broken the build!
        </para>
      </listitem>

      <listitem>
        <para>
          <filename>http://www.NetBSD.org/Documentation/pkgsrc/pkgsrc.pdf</filename>:
  	  PDF version of the pkgsrc guide.
        </para>
      </listitem>

      <listitem>
        <para>
          <filename>http://www.NetBSD.org/Documentation/pkgsrc/pkgsrc.ps</filename>:
  	  PostScript version of the pkgsrc guide.
        </para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="procedure">
    <title>Procedure</title>

    <para>
      The procedure to edit the pkgsrc guide is:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          Make sure you have the packages needed to re-generate the
          pkgsrc guide (and other XML-based NetBSD documentation)
          installed. These are <quote>netbsd-doc</quote> for creating the
          ASCII and HTML versions, and
          <quote>netbsd-doc-print</quote> for the PostScript and PDF
          versions. You will need both packages installed, to make sure
          documentation is consistent across all formats. The packages
          can be found in
          <filename>pkgsrc/meta-pkgs/netbsd-doc</filename> and
          <filename>pkgsrc/meta-pkgs/netbsd-doc-print</filename>.
        </para>
      </listitem>

      <listitem>
        <para>
          Edit the XML file(s) in
          <filename>pkgsrc/doc/guide/files</filename>.
        </para>
      </listitem>

      <listitem>
        <para>
          Run <command>make extract &amp;&amp; make do-lint</command> in
          <filename>pkgsrc/doc/guide</filename> to check the XML
          syntax, and fix it if needed.
        </para>
      </listitem>

      <listitem>
        <para>
          Run <command>make</command> in
          <filename>pkgsrc/doc/guide</filename> to build the HTML and
          ASCII version.
        </para>
      </listitem>

      <listitem>
        <para>
          If all is well, run <command>make install-doc</command> to put
          the generated files into <filename>pkgsrc/doc</filename>.
        </para>
      </listitem>

      <listitem>
        <para>
          <command>cvs commit pkgsrc/doc/guide/files</command>
        </para>
      </listitem>

      <listitem>
        <para>
          <command>cvs commit -m re-generate pkgsrc/doc/pkgsrc.{html,txt}</command>
        </para>
      </listitem>

      <listitem>
        <para>
          Until the webserver on www.NetBSD.org is really updated
          automatically to pick up changes to the pkgsrc guide
          automatically, also run <command>make install-htdocs
          HTDOCSDIR=../../../htdocs</command> (or similar, adjust
          <varname>HTDOCSDIR</varname>!).
        </para>
      </listitem>

      <listitem>
        <para>
          <command>cvs commit htdocs/Documentation/pkgsrc</command>
        </para>
      </listitem>

    </itemizedlist>

  </sect1>
</appendix>
