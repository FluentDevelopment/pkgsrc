$NetBSD: patch-aa,v 1.3 2003/03/10 11:06:50 wiz Exp $

--- iozone.c.orig	Mon Mar  3 20:44:39 2003
+++ iozone.c
@@ -831,7 +831,7 @@ void purgeit();			/* Purge on chip cache
 void throughput_test();		/* Multi process throughput 	  */
 void multi_throughput_test();	/* Multi process throughput 	  */
 void prepage();			/* Pre-fault user buffer	  */
-#if defined(linux) || defined(solaris) || defined(__AIX__) || defined(OSFV5) || defined(UWIN) || defined(Windows) || defined(__APPLE__) || defined(OSFV4) || defined(IRIX) || defined(IRIX64) || defined(__FreeBSD__)
+#ifdef HAVE_ANSIC_C
 float do_compute(float);	/* compute cycle simulation       */
 #else
 float do_compute();		/* compute cycle simulation       */
@@ -15024,6 +15024,7 @@ int flag, prot;
 		 * a file that is opened with O_DIRECT 
 		 */
 	 	file_flags=fcntl(fd,F_GETFL);
+#if 0
 	 	if((file_flags & O_DIRECT) !=0)
 	 	{
 	 		recs=filebytes/reclen;
@@ -15038,6 +15039,7 @@ int flag, prot;
 			}
 	 	}
 		else
+#else
 		{
 			/* Save time, just seek out and touch at the end */
 		 	I_LSEEK(fd,(filebytes-reclen),SEEK_SET);
@@ -15048,6 +15050,7 @@ int flag, prot;
 				exit(181);
 			}
 		}
+#endif
 	 	free(stmp);
 	 	I_LSEEK(fd,0,SEEK_SET);
 #endif
