$NetBSD: patch-aj,v 1.6 2003/02/21 14:42:14 grant Exp $

--- makedepend.SH.orig	Mon Mar 19 18:33:17 2001
+++ makedepend.SH
@@ -68,6 +68,7 @@ if test -f Makefile; then
     case "$osname" in
     os2) ;;
     netbsd) ;;
+    freebsd) ;;
     *) $touch $firstmakefile ;;
     esac
 fi
@@ -141,6 +142,8 @@ for file in `$cat .clist`; do
         $cppstdin $finc -I. $cppflags $cppminus <UU/$file.c |
         $sed \
     	    -e '/^#.*<stdin>/d' \
+    	    -e '/^#.*<built-in>/d' \
+    	    -e '/^#.*<command line>/d' \
 	    -e '/^#.*"-"/d' \
 	    -e 's#\.[0-9][0-9]*\.c#'"$file.c#" \
 	    -e 's/^[	 ]*#[	 ]*line/#/' \
@@ -196,7 +199,8 @@ if $test -s .deptmp; then
     $echo "Updating $mf..."
     $echo "# If this runs make out of memory, delete /usr/include lines." \
 	>> $mf.new
-    $sed 's|^\(.*\$(OBJ_EXT):\) *\(.*/.*\.c\) *$|\1 \2; '"$defrule \2|" .deptmp \
+    $sed 's|^\(.*\$(OBJ_EXT):\) *\(.*/.*\.c\) *$|\1 \2; '"$defrule \2|" .deptmp |\
+    $sed -e 's|^0$||' \
        >>$mf.new
 else
     $MAKE hlist || ($echo "Searching for .h files..."; \
