$NetBSD: patch-aa,v 1.26 2005/06/24 06:43:45 jlam Exp $

--- lib/ExtUtils/MM_Unix.pm.orig	2004-01-05 17:34:59.000000000 -0500
+++ lib/ExtUtils/MM_Unix.pm
@@ -12,7 +12,7 @@ use DirHandle;
 
 use vars qw($VERSION @ISA
             $Is_Mac $Is_OS2 $Is_VMS $Is_Win32 $Is_Win95  $Is_Dos $Is_VOS
-            $Is_QNX $Is_AIX $Is_OSF $Is_IRIX  $Is_NetBSD $Is_BSD
+            $Is_QNX $Is_AIX $Is_OSF $Is_IRIX  $Is_BSD $Is_Interix
             $Is_SunOS4 $Is_Solaris $Is_SunOS
             $Verbose %pm %static
             %Config_Override
@@ -36,11 +36,11 @@ $Is_QNX     = $^O eq 'qnx';
 $Is_AIX     = $^O eq 'aix';
 $Is_OSF     = $^O eq 'dec_osf';
 $Is_IRIX    = $^O eq 'irix';
-$Is_NetBSD  = $^O eq 'netbsd';
+$Is_Interix = $^O eq 'interix';
 $Is_SunOS4  = $^O eq 'sunos';
 $Is_Solaris = $^O eq 'solaris';
 $Is_SunOS   = $Is_SunOS4 || $Is_Solaris;
-$Is_BSD     = $^O =~ /^(?:free|net|open)bsd|bsdos$/;
+$Is_BSD     = $^O =~ /^(?:free|net|open)bsd|bsdos|dragonfly|interix$/;
 
 
 =head1 NAME
@@ -1120,16 +1120,16 @@ $(INST_DYNAMIC): $(OBJECT) $(MYEXTLIB) $
 
     my $libs = '$(LDLOADLIBS)';
 
-    if ($Is_NetBSD) {
-	# Use nothing on static perl platforms, and to the flags needed
-	# to link against the shared libperl library on shared perl
-	# platforms.  We peek at lddlflags to see if we need -Wl,-R
+    if ($Is_BSD) {
+	# Use nothing on static perl platforms, and add to the flags
+	# needed to link against the shared libperl library on shared
+	# perl platforms.  We peek at lddlflags to see if we need -Wl,-R
 	# or -R to add paths to the run-time library search path.
 	if ($Config{'useshrplib'}) {
 	    if ($Config{'lddlflags'} =~ /-Wl,-R/) {
-		$libs .= ' -L$(PERL_INC) -Wl,-R$(INSTALLARCHLIB)/CORE -lperl';
+		$libs .= ' -L$(PERL_INC) -Wl,-R$(INSTALLARCHLIB)/CORE -Wl,-R$(PERL_ARCHLIB)/CORE -lperl';
 	    } elsif ($Config{'lddlflags'} =~ /-R/) {
-		$libs .= ' -L$(PERL_INC) -R$(INSTALLARCHLIB)/CORE -lperl';
+		$libs .= ' -L$(PERL_INC) -R$(INSTALLARCHLIB)/CORE -R$(PERL_ARCHLIB)/CORE -lperl';
 	    }
 	}
     }
