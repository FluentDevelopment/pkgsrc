$NetBSD: patch-af,v 1.11 2001/10/02 06:37:56 jlam Exp $

--- lib/ExtUtils/Liblist.pm.orig	Thu Feb 22 21:57:55 2001
+++ lib/ExtUtils/Liblist.pm
@@ -68,20 +68,28 @@
     foreach $thislib (split ' ', $potential_libs){
 
 	# Handle possible linker path arguments.
-	if ($thislib =~ s/^(-[LR])//){	# save path flag type
+	if ($thislib =~ s/^(-[LR]|-Wl,-R)//){	# save path flag type
 	    my($ptype) = $1;
 	    unless (-d $thislib){
 		warn "$ptype$thislib ignored, directory does not exist\n"
 			if $verbose;
 		next;
 	    }
+	    my($rtype) = $ptype;
+	    if (($ptype eq '-R') or ($ptype eq '-Wl,-R')) {
+		if ($Config{'lddlflags'} =~ /-Wl,-R/) {
+		    $rtype = '-Wl,-R';
+		} elsif ($Config{'lddlflags'} =~ /-R/) {
+		    $rtype = '-R';
+		}
+	    }
 	    unless ($self->file_name_is_absolute($thislib)) {
 	      warn "Warning: $ptype$thislib changed to $ptype$pwd/$thislib\n";
 	      $thislib = $self->catdir($pwd,$thislib);
 	    }
 	    push(@searchpath, $thislib);
 	    push(@extralibs,  "$ptype$thislib");
-	    push(@ldloadlibs, "$ptype$thislib");
+	    push(@ldloadlibs, "$rtype$thislib");
 	    next;
 	}
 
