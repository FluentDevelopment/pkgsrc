$NetBSD: patch-aa,v 1.9 2005/09/04 04:59:36 jlam Exp $

--- config.orig	Fri Apr 11 14:00:41 2003
+++ config
@@ -25,7 +25,7 @@ USERCONF=
 # interface (e.g., Linux, Solaris, IRIX, BSD, AIX, HPUX, and probably others),
 # uncomment the next two lines.
 #
-#LOADLIB= -DUSE_DLOPEN=1
+LOADLIB= -DUSE_DLOPEN=1
 #DLLIB= -ldl
 #
 # In Linux with gcc, you should also uncomment the next definition for
@@ -45,7 +45,7 @@ USERCONF=
 # If your system is not POSIX but has popen and pclose, define USE_POPEN=1.
 # If you don't want to support pipes, define USE_POPEN=0.
 #
-#POPEN= -DUSE_POPEN=1
+POPEN= -DUSE_POPEN=1
 #POPEN= -DUSE_POPEN=0
 #
 # The form below will probably work in (some) Windows systems.
@@ -108,8 +108,8 @@ EXTRA_LIBS= -lm
 # You need an ANSI C compiler. gcc is a popular one. We do not use -ansi in
 # WARN because it disables POSIX features used in the libraries.
 #
-CC= gcc
-WARN= -Wall
+#CC= gcc
+#WARN= -Wall
 
 # ------------------------------------------------------------------ C options
 
@@ -119,7 +119,7 @@ WARN= -Wall
 # debug information. If you only want the shared libraries, you may want to
 # add -fPIC to MYCFLAGS.
 #
-MYCFLAGS= -O2
+#MYCFLAGS= -O2
 #MYCFLAGS= -O3 -fomit-frame-pointer # -fPIC
 
 # Write here any options you may need for your C linker.
@@ -148,7 +148,7 @@ STRIP= strip
 
 # Locations for "make install". You may need to be root do "make install".
 #
-INSTALL_ROOT= /usr/local
+INSTALL_ROOT= $(PREFIX)
 INSTALL_BIN= $(INSTALL_ROOT)/bin
 INSTALL_INC= $(INSTALL_ROOT)/include
 INSTALL_LIB= $(INSTALL_ROOT)/lib
@@ -165,6 +165,7 @@ INSTALL_DATA= cp
 # == END OF USER SETTINGS. NO NEED TO CHANGE ANYTHING BELOW THIS LINE =========
 
 V=5.0
+LV=5:0
 
 BIN= $(LUA)/bin
 INC= $(LUA)/include
@@ -173,6 +174,11 @@ LIB= $(LUA)/lib
 INCS= -I$(INC) $(EXTRA_INCS)
 DEFS= $(NUMBER) $(EXTRA_DEFS)
 
+CCLD= $(LIBTOOL) --mode=link $(CC)
 CFLAGS= $(MYCFLAGS) $(WARN) $(INCS) $(DEFS)
+
+.SUFFIXES:	.lo
+.c.lo:
+	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c $<
 
 # (end of config)
