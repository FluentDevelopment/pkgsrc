$NetBSD: patch-ac,v 1.5 2007/01/19 19:50:46 minskim Exp $

--- ext/dbm/extconf.rb.orig	2007-01-19 11:39:20.000000000 -0800
+++ ext/dbm/extconf.rb
@@ -36,7 +36,8 @@ def headers.db_check(db)
   db_prefix ||= ""
 
   if (have_library(db, db_prefix+"dbm_open") || have_func(db_prefix+"dbm_open")) and
-      hdr = self.fetch(db, ["ndbm.h"]).find {|hdr| have_type("DBM", hdr, hsearch)}
+      (hdr = self.fetch(db, ["ndbm.h"]).find {|hdr| have_type("DBM", hdr, hsearch)} or
+       hdr = self.fetch(db, ["ndbm.h"]).find {|hdr| have_type("DBM", ["db.h", hdr], hsearch)})
     have_func(db_prefix+"dbm_clearerr") unless have_gdbm
     $defs << hsearch if hsearch
     $defs << '-DDBM_HDR="<'+hdr+'>"'
