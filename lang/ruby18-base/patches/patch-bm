$NetBSD: patch-bm,v 1.1 2005/11/02 08:56:40 taca Exp $

--- lib/fileutils.rb.orig	2005-09-19 10:37:27.000000000 +0900
+++ lib/fileutils.rb
@@ -118,7 +118,7 @@ module FileUtils
   def cd(dir, options = {}, &block) # :yield: dir
     fu_check_options options, :verbose
     fu_output_message "cd #{dir}" if options[:verbose]
-    Dir.chdir(dir, &block) unless options[:noop]
+    Dir.chdir(dir, &block)
     fu_output_message 'cd -' if options[:verbose] and block
   end
   module_function :cd
@@ -1443,6 +1443,8 @@ module FileUtils
   end
   private_module_function :fu_output_message
 
+  METHODS = singleton_methods() - ['private_module_function']
+
   #
   # Returns an Array of method names which have any options.
   #
@@ -1505,9 +1507,15 @@ module FileUtils
         def #{name}(*args)
           super(*fu_update_option(args, :verbose => true))
         end
+        private :#{name}
       EOS
     end
     extend self
+    class << self
+      ::FileUtils::METHODS.each do |m|
+        public m
+      end
+    end
   end
 
   # 
@@ -1524,9 +1532,15 @@ module FileUtils
         def #{name}(*args)
           super(*fu_update_option(args, :noop => true))
         end
+        private :#{name}
       EOS
     end
     extend self
+    class << self
+      ::FileUtils::METHODS.each do |m|
+        public m
+      end
+    end
   end
 
   # 
@@ -1544,9 +1558,15 @@ module FileUtils
         def #{name}(*args)
           super(*fu_update_option(args, :noop => true, :verbose => true))
         end
+        private :#{name}
       EOS
     end
     extend self
+    class << self
+      ::FileUtils::METHODS.each do |m|
+        public m
+      end
+    end
   end
 
 end
