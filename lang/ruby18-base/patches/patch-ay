$NetBSD: patch-ay,v 1.1 2005/09/18 13:38:50 taca Exp $

--- ext/dl/dl.c.orig	2003-06-16 16:25:38.000000000 +0900
+++ ext/dl/dl.c
@@ -543,7 +543,11 @@ rb_io_to_ptr(VALUE self)
   GetOpenFile(self, fptr);
   fp = fptr->f;
 
+#if defined(__DragonFly__)
+  return fp ? rb_dlptr_new(fp, 0, 0) : Qnil;
+#else
   return fp ? rb_dlptr_new(fp, sizeof(FILE), 0) : Qnil;
+#endif
 }
 
 VALUE
