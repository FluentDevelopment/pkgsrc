$NetBSD: patch-bj,v 1.1 2005/11/02 08:56:40 taca Exp $

--- gc.c.orig	2005-07-27 23:29:11.000000000 +0900
+++ gc.c
@@ -649,7 +649,7 @@ mark_entry(key, value, lev)
     return ST_CONTINUE;
 }
 
-void
+static void
 mark_tbl(tbl, lev)
     st_table *tbl;
     int lev;
@@ -676,7 +676,7 @@ mark_keyvalue(key, value, lev)
     return ST_CONTINUE;
 }
 
-void
+static void
 mark_hash(tbl, lev)
     st_table *tbl;
     int lev;
@@ -880,13 +880,11 @@ gc_mark_children(ptr, lev)
 	  case NODE_BLOCK_ARG:
 	  case NODE_POSTEXE:
 	    break;
-#ifdef C_ALLOCA
 	  case NODE_ALLOCA:
 	    mark_locations_array((VALUE*)obj->as.node.u1.value,
 				 obj->as.node.u3.cnt);
 	    ptr = (VALUE)obj->as.node.u2.node;
 	    goto again;
-#endif
 
 	  default:		/* unlisted NODE */
 	    if (is_pointer_to_heap(obj->as.node.u1.node)) {
@@ -1230,11 +1228,9 @@ obj_free(obj)
 		RUBY_CRITICAL(free(RANY(obj)->as.node.u1.tbl));
 	    }
 	    break;
-#ifdef C_ALLOCA
 	  case NODE_ALLOCA:
 	    RUBY_CRITICAL(free(RANY(obj)->as.node.u1.node));
 	    break;
-#endif
 	}
 	return;			/* no need to free iv_tbl */
 
