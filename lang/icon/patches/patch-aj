$NetBSD: patch-aj,v 1.5 2003/03/24 12:12:10 jtb Exp $

--- Makefile.orig	Thu Mar 28 02:45:33 2002
+++ Makefile
@@ -15,7 +15,7 @@ dest=/must/specify/dest/
 #
 # Default targets.
 
-All:	Icont Ilib Ibin
+All:	Icont Iconc Ilib Ibin
 
 config/unix/$(name)/status src/h/define.h:
 	:
@@ -62,7 +62,7 @@ Status:
 
 Icont bin/icont: Common
 		cd src/icont;		$(MAKE)
-		cd src/runtime;		$(MAKE) 
+		cd src/runtime;		$(MAKE)
 
 
 # The compiler: rtt, the run-time system, and iconc.
@@ -98,21 +98,23 @@ Ibin:		bin/icont
 
 D=$(dest)
 Install:
-		test -d $D || mkdir $D
-		test -d $D/bin || mkdir $D/bin
-		test -d $D/lib || mkdir $D/lib
-		test -d $D/doc || mkdir $D/doc
-		test -d $D/man || mkdir $D/man
-		test -d $D/man/man1 || mkdir $D/man/man1
-		rm -f $D/bin/icon* $D/doc/* $D/man/man1/*
-		cd $D/lib; rm -f *
-		cp README $D
-		cp bin/[abcdefghijklmnopqrstuvwxyz]* $D/bin
-		rm -f $D/bin/libXpm* $D/bin/rt* $D/bin/icon
-		(cd $D/bin; ln -s icont icon)
-		cp lib/*.* $D/lib
-		cp doc/*.* $D/doc
-		cp man/man1/*.* $D/man/man1
+		./bin/patchstr ./bin/icont $(PREFIX)/bin/iconx
+		./bin/patchstr ./bin/iconc $(PREFIX)/lib/icon/
+		cd bin; $(BSD_INSTALL_PROGRAM) icont iconx iconc	\
+			patchstr rtt $D/bin
+		cd $(PREFIX)/bin && ln -sf icont icon
+		$(BSD_INSTALL_DATA_DIR) $D/lib/icon
+		$(BSD_INSTALL_DATA) lib/icon/*.* $D/lib/icon
+		$(BSD_INSTALL_DATA_DIR) $D/share/doc/icon
+		for f in ipatch colrbook colrpick fontpick palette vib	\
+		wevents xgamma; do					\
+		if [ -f bin/$$f ]; then					\
+			${BSD_INSTALL_SCRIPT} bin/$$f $D/bin;		\
+		fi;							\
+		done
+		$(BSD_INSTALL_DATA) doc/*.* $D/share/doc/icon
+		$(BSD_INSTALL_MAN) man/man1/* $D/man/man1
+
 
 
 # Bundle up for binary distribution.
