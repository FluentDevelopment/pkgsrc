$NetBSD: patch-ab,v 1.2 2003/06/23 07:45:04 jlam Exp $

--- hints/netbsd.sh.orig	Sat Jun  1 10:03:12 2002
+++ hints/netbsd.sh	Fri Jun 20 03:02:13 2003
@@ -37,16 +37,21 @@
 		cccdlflags="-DPIC -fPIC $cccdlflags"
 		lddlflags="--whole-archive -shared $lddlflags"
 		rpathflag="-Wl,-rpath,"
-		#
-		# Include the whole libgcc.a into the perl executable so
-		# that certain symbols needed by loadable modules built as
-		# C++ objects (__eh_alloc, __pure_virtual, etc.) will always
-		# be defined.
-		#
-		# XXX This should be obsoleted by gcc-3.0.
-		#
-		ccdlflags="-Wl,-whole-archive -lgcc -Wl,-no-whole-archive \
-			-Wl,-E $ccdlflags"
+		case "$osvers" in
+		1.[0-5]|1.[0-5].*)
+			#
+			# Include the whole libgcc.a into the perl executable
+			# so that certain symbols needed by loadable modules
+			# built as C++ objects (__eh_alloc, __pure_virtual,
+			# etc.) will always be defined.
+			#
+			ccdlflags="-Wl,-whole-archive -lgcc \
+				-Wl,-no-whole-archive -Wl,-E $ccdlflags"
+			;;
+		*)
+			ccdlflags="-Wl,-E $ccdlflags"
+			;;
+		esac
 	elif test -f /usr/libexec/ld.so; then
 		# a.out
 		d_dlopen=$define
@@ -128,19 +132,7 @@
 esac 
 EOCBU
 
-# Set sensible defaults for NetBSD: look for local software in
-# /usr/pkg (NetBSD Packages Collection) and in /usr/local.
-#
-loclibpth="/usr/pkg/lib /usr/local/lib"
-locincpth="/usr/pkg/include /usr/local/include"
-case "$rpathflag" in
-'')
-	ldflags=
-	;;
-*)
-	ldflags=
-	for yyy in $loclibpth; do
-		ldflags="$ldflags $rpathflag$yyy"
-	done
-	;;
-esac
+locincpth="/opt/pkg/include"
+loclibpth="/opt/pkg/lib"
+ldflags="-Wl,-R/opt/pkg/lib $ldflags"
+glibpth='/usr/lib'
