$NetBSD: patch-bk,v 1.1 2002/01/03 20:40:46 tron Exp $

--- ../gcc-2.95.3/gcc/ChangeLog.orig	Fri Mar 16 13:52:02 2001
+++ ../gcc-2.95.3/gcc/ChangeLog	Thu Jan  3 20:37:54 2002
@@ -1,3 +1,59 @@
+2001-01-05  matthew green  (mrg@eterna.com.au)
+
+	1999/08/02  Jakub Jelinek  <jj@ultra.linux.cz>
+	* config/sparc/sparc.h (ASM_DECLARE_REGISTER_GLOBAL): New macro.
+	(RTX_OK_FOR_OLO10): Likewise.
+	(GO_IF_LEGITIMATE_ADDRESS): If assembler supports offsetable
+	%lo(), allow it in addresses...
+	(PRINT_OPERAND_ADDRESS): ... and print it appropriately.
+	* config/sparc/sparc.md (sethi_di_medlow_embmedany_pic): sethi %lo()
+	does not make sense.
+	* config/sparc/sparc.c (sparc_hard_reg_printed): New array.
+	(sparc_output_scratch_registers): New function.
+	(output_function_prologue, sparc_flat_output_function_prologue): Use
+	it.
+	* varasm.c (make_decl_rtl): Use ASM_DECLARE_REGISTER_GLOBAL if
+	defined.
+	* tm.texi (ASM_DECLARE_REGISTER_GLOBAL): Document it.
+
+2001-01-05  matthew green  (mrg@eterna.com.au)
+
+	1999/07/30  Jakub Jelinek  <jj@ultra.linux.cz>
+	* config/sparc/sparc.md (cmp_mul_set, cmp_udiv_cc_set):
+	Fix patterns so that they actually match.
+	(cmp_sdiv_cc_set): Ditto, also don't require g0 to be zero.
+	(mulsidi3_sp64, const_mulsidi3_sp64): New patterns.
+	(const_mulsidi3_sp32): Renamed from const_mulsidi3, only on
+	TARGET_HARD_MUL32.
+	(mulsidi3): Reflect this in the expand.
+	(smulsi3_highpart): Only on TARGET_ARCH32.
+	(umulsidi3_sp64, const_umulsidi3_sp64): New patterns.
+	(const_umulsidi3_sp32): Renamed from const_umulsidi3.
+	(umulsidi3): Reflect this in the expand.
+	(umulsi3_highpart): Only on TARGET_ARCH32.
+	(divsi3_sp32): Renamed from divsi3, only on TARGET_ARCH32,
+	don't require g0 to be zero.
+	(udivsi3_sp32): Renamed from udivsi3, only on TARGET_ARCH32.
+	({,u}divsi3): New expands.
+	({,u}divsi3_sp64): New patterns.
+	(after lshrdi3_v8plus): Four new patterns to help combiner
+	optimizing nested mixed mode shifts.
+
+	* config/sparc/sparc.c (sparc_override_options): Use deprecated
+	v8 instructions if optimizing for UltraSPARC I, II, IIi, as it
+	speed things up. Don't use them by default on plain v9 in 64bit
+	mode, according to what SPAMv9 sais.
+
+	* config/sparc/sparc.h: Fix comments, e.g. Linux already preserves
+	top 32 bits of %[og][0-7] in signal handlers.
+	Also, TARGET_HARD_MUL32 now is only true for TARGET_ARCH32.
+
+2001-01-03  matthew green  (mrg@eterna.com.au)
+
+	1999-12-14  Jakub Jelinek  <jakub@redhat.com>
+	* config/sparc/sparc.c (sparc_override_options): Allow block
+	profiling with -m32.
+
 Fri Mar 16 12:46:19 GMT 2001 Bernd Schmidt  (bernds@redhat.com)
 
 	* gcc-2.95.3 Released.
