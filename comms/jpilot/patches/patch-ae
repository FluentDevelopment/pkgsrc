$NetBSD: patch-ae,v 1.3 2002/11/30 13:36:14 salo Exp $

--- configure.orig	Tue Feb  6 20:31:18 2001
+++ configure	Sat Nov 30 13:49:01 2002
@@ -3831,6 +3831,25 @@
 rm -f conftest*
    LIBS="$save_LIBS"
 
+   if test "x$have_dlopen" != "yes"; then
+      cat > conftest.$ac_ext <<EOF
+#line 3840 "configure"
+#include "confdefs.h"
+#include <dlfcn.h>
+int main() {
+dlopen("huh",0);
+; return 0; }
+EOF
+if { (eval echo configure:3847: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  have_dlopen=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+fi
+rm -f conftest*
+   fi
+
    if test "x$have_dlopen" = "xyes"; then
       cat >> confdefs.h <<\EOF
 #define ENABLE_PLUGINS 1
@@ -3866,7 +3885,7 @@
 # Check whether --with-gtk-prefix or --without-gtk-prefix was given.
 if test "${with_gtk_prefix+set}" = set; then
   withval="$with_gtk_prefix"
-  gtk_config_prefix="$withval"
+  gtk_config_prefix=""
 else
   gtk_config_prefix=""
 fi
