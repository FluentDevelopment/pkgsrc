$NetBSD: patch-ab,v 1.3 2003/08/11 07:26:01 wiz Exp $

--- db.c.orig	Sun Aug 10 22:12:44 2003
+++ db.c
@@ -23,6 +23,7 @@
 #include "meal.h"
 #include "options.h"
 #include "util.h"
+#include <errno.h>
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
@@ -683,7 +684,13 @@ void make_filenames(void)
  sprintf(versionfile,"%s/%s","NUTDB",versionfile1);
 #else
 sprintf(nutdir,"%s/%s",getenv("HOME"),nutdir1);
-mkdir (nutdir, 0700 );
+if (mkdir(nutdir, S_IRWXU|S_IRUSR|S_IWUSR|S_IRGRP|S_IROTH) != 0) {
+     if (errno != EEXIST) {
+             printf("Cannot create %s/%s: %s\n", getenv("HOME"), nutdir1,
+                     strerror(errno));
+             exit(1);
+     }
+}
 sprintf(USDAjoined,"%s/%s",FOODDIR,USDAjoined1);
 sprintf(globalFOOD,"%s/%s",FOODDIR,globalFOOD1);
 sprintf(globalNUT,"%s/%s",FOODDIR,globalNUT1);
