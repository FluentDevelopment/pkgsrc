$NetBSD: patch-ac,v 1.3 2001/09/30 13:52:58 blymn Exp $

--- source/term.c.orig	Mon Jan  8 16:54:22 2001
+++ source/term.c
@@ -819,14 +819,14 @@
 #ifndef WTERM_C
 	int	i;
 	int	desired;
-
+	char    *t2ptr;
 
 #if !defined(__EMX__) && !defined(WINNT) && !defined(GUI)
 	memset(current_term, 0, sizeof(struct term_struct));
 
 	if (dumb_mode)
 		ircpanic("term_init called in dumb_mode");
-	*termcap2 = 0;
+	t2ptr = termcap2;
 	if (!term && !(term = getenv("TERM")))
 	{
 		fprintf(stderr, "\n");
@@ -873,11 +873,15 @@
 		}
 		else
 		{
-			cval = Tgetstr(tcaps[i], termcap2);
+			cval = Tgetstr(tcaps[i], t2ptr);
+#ifdef HAVE_TERMINFO
 			if (cval == (char *) -1)
 				*(char **)tcaps[i].ptr = NULL;
 			else
 				*(char **)tcaps[i].ptr = cval;
+#else
+			*(char **)tcaps[i].ptr = cval;
+#endif
 		}
 	}
 
