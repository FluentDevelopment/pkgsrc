$NetBSD: patch-ab,v 1.3 2002/08/28 07:43:57 jlam Exp $

--- src/perl.c.orig	Mon Aug 26 11:00:58 2002
+++ src/perl.c	Wed Aug 28 13:37:46 2002
@@ -185,7 +185,7 @@
 	path = gaim_user_dir();
 	dir = opendir(path);
 	if (dir) {
-		while ((readdir_r(dir,&dirent_buf,&ent),ent)) {
+		while ((ent = readdir(dir))) {
 			if (strcmp(ent->d_name, ".") && strcmp(ent->d_name, "..")) {
 				if (is_pl_file(ent->d_name)) {
 					buf = g_malloc(strlen(path) + strlen(ent->d_name) + 2);
@@ -293,7 +293,7 @@
 XS (XS_GAIM_register)
 {
 	char *name, *ver, *callback, *unused; /* exactly like X-Chat, eh? :) */
-	unsigned int junk;
+	STRLEN junk;
 	struct perlscript *scp;
 	dXSARGS;
 	items = 0;
@@ -404,7 +404,7 @@
 {
 	char *title;
 	char *message;
-	unsigned int junk;
+	STRLEN junk;
 	dXSARGS;
 	items = 0;
 
@@ -472,7 +472,7 @@
 
 XS (XS_GAIM_command)
 {
-	unsigned int junk;
+	STRLEN junk;
 	char *command = NULL;
 	dXSARGS;
 	items = 0;
@@ -524,7 +524,7 @@
 XS (XS_GAIM_user_info)
 {
 	struct gaim_connection *gc;
-	unsigned int junk;
+	STRLEN junk;
 	struct buddy *buddy = NULL;
 	dXSARGS;
 	items = 0;
@@ -550,7 +550,7 @@
 {
 	char *nick, *who, *what;
 	struct conversation *c;
-	int junk;
+	STRLEN junk;
 	int send, wflags;
 	dXSARGS;
 	items = 0;
@@ -582,7 +582,7 @@
 	struct gaim_connection *gc;
 	char *nick, *what;
 	int isauto;
-	int junk;
+	STRLEN junk;
 	dXSARGS;
 	items = 0;
 
@@ -605,7 +605,7 @@
 	char *nick, *what;
 	int isauto;
 	struct conversation *c;
-	unsigned int junk;
+	STRLEN junk;
 	dXSARGS;
 	items = 0;
 
@@ -635,7 +635,7 @@
 	char *what;
 	struct conversation *b = NULL;
 	GSList *bcs;
-	unsigned int junk;
+	STRLEN junk;
 	dXSARGS;
 	items = 0;
 
@@ -801,7 +801,7 @@
 
 XS (XS_GAIM_add_event_handler)
 {
-	unsigned int junk;
+	STRLEN junk;
 	struct _perl_event_handlers *handler;
 	dXSARGS;
 	items = 0;
@@ -828,7 +828,7 @@
 
 XS (XS_GAIM_add_timeout_handler)
 {
-	unsigned int junk;
+	STRLEN junk;
 	long timeout;
 	struct _perl_timeout_handlers *handler;
 	dXSARGS;
