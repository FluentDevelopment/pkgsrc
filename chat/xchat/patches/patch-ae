$NetBSD: patch-ae,v 1.3 2002/07/19 05:22:52 mycroft Exp $

--- src/common/perl.c.orig	Fri Jul 19 05:14:48 2002
+++ src/common/perl.c	Fri Jul 19 05:15:59 2002
@@ -256,7 +256,8 @@
 execute_perl (char *function, char *args)
 {
 	char *perl_args[2] = { args, NULL }, buf[512];
-	int count, ret_value = 1;
+	int ret_value = 1;
+	STRLEN count;
 	SV *sv;
 
 	dSP;
@@ -273,7 +274,7 @@
 		POPs;
 	} else if (count != 1) {
 		snprintf(buf, 512, "Perl error: expected 1 value from %s, "
-			"got: %d\n", function, count);
+			"got: %ld\n", function, (long)count);
 		PrintText(perl_sess, buf);
 	} else {
 		ret_value = POPi;
@@ -656,7 +657,7 @@
 static XS (XS_IRC_register)
 {
 	char *name, *ver, *callback, *unused;
-	int junk;
+	STRLEN junk;
 	struct perlscript *scp;
 	dXSARGS;
 
@@ -680,7 +681,7 @@
 /* IRC::main_print(output) */
 static XS (XS_IRC_print)
 {
-	int junk;
+	STRLEN junk;
 	int i;
 	char *output;
 	dXSARGS;
@@ -706,7 +707,7 @@
 
 static XS (XS_IRC_print_with_channel)
 {
-	int junk;
+	STRLEN junk;
 	char *output;
 	struct session *sess;
 	GSList *list = sess_list;
@@ -784,7 +785,7 @@
 /* IRC::get_prefs(var) */
 static XS (XS_IRC_get_prefs)
 {
-	int junk;
+	STRLEN junk;
 	char *var;
 	int i = 0;
 	dXSARGS;
@@ -827,7 +828,7 @@
 /* IRC::add_message_handler(message_type, handler_name) */
 static XS (XS_IRC_add_message_handler)
 {
-	int junk;
+	STRLEN junk;
 	struct _perl_inbound_handlers *handler;
 	dXSARGS;
 
@@ -842,7 +843,7 @@
 /* IRC::add_command_handler(command_name, handler_name) */
 static XS (XS_IRC_add_command_handler)
 {
-	int junk;
+	STRLEN junk;
 	struct _perl_command_handlers *handler;
 	dXSARGS;
 
@@ -857,7 +858,7 @@
 /* IRC::add_print_handler(print_name, handler_name) */
 static XS (XS_IRC_add_print_handler)
 {
-	int junk;
+	STRLEN junk;
 	struct _perl_print_handlers *handler;
 	dXSARGS;
 
@@ -870,7 +871,7 @@
 
 static XS (XS_IRC_add_timeout_handler)
 {
-	int junk;
+	STRLEN junk;
 	struct _perl_timeout_handlers *handler;
 	dXSARGS;
 
@@ -886,7 +887,7 @@
 static XS (XS_IRC_send_raw)
 {
 	char *data;
-	int junk;
+	STRLEN junk;
 	dXSARGS;
 
 	if (perl_sess)
@@ -1033,7 +1034,7 @@
 
 static XS (XS_IRC_user_info)
 {
-	int junk;
+	STRLEN junk;
 	struct User *user;
 	char *nick;
 	dXSARGS;
@@ -1065,7 +1066,7 @@
  */
 static XS (XS_IRC_add_user_list)
 {
-	int junk;
+	STRLEN junk;
 	char *ul_channel;
 	char *ul_server;
 	char *nick;
@@ -1104,7 +1105,7 @@
  */
 static XS (XS_IRC_sub_user_list)
 {
-	int junk;
+	STRLEN junk;
 	char *channel;
 	char *server;
 	char *nick;
@@ -1135,7 +1136,7 @@
  */
 static XS (XS_IRC_clear_user_list)
 {
-	int junk;
+	STRLEN junk;
 	char *channel, *server;
 	struct session *sess;
 	GSList *list = sess_list;
@@ -1170,7 +1171,8 @@
 	struct session *sess;
 	char *channel, *server;
 	GSList *list = sess_list;
-	int i = 0, junk;
+	int i = 0;
+	STRLEN junk;
 	int MinStk = 10;
 	dXSARGS;
 
@@ -1267,7 +1269,7 @@
 static XS (XS_IRC_command)
 {
 	char *command;
-	int junk;
+	STRLEN junk;
 	dXSARGS;
 
 	if (perl_sess)
@@ -1284,7 +1286,7 @@
 	GSList *list = serv_list;
 	struct server *serv;
 	char *server, *command;
-	int junk;
+	STRLEN junk;
 	dXSARGS;
 
 	server = strdup (SvPV (ST (1), junk));
@@ -1338,7 +1340,8 @@
 	struct session *sess;
 	char *channel, *server;
 	GSList *list = sess_list;
-	int i = 0, junk;
+	int i = 0;
+	STRLEN junk;
 	int MinStk = 10;
 	dXSARGS;
 
