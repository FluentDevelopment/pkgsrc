--- configure.orig	2005-04-29 21:47:15.000000000 +0200
+++ configure	2005-04-29 21:49:41.000000000 +0200
@@ -14,6 +14,8 @@
 datadir='$prefix/share/bitlbee/'
 config='/var/lib/bitlbee/'
 
+ipv6=0
+
 msn=1
 jabber=1
 oscar=1
@@ -45,6 +47,7 @@
 --datadir=...						$datadir
 --config=...						$config
 
+--ipv6=0/1	Disable/enable IPv6 support		$ipv6
 --msn=0/1	Disable/enable MSN part			$msn
 --jabber=0/1	Disable/enable Jabber part		$jabber
 --oscar=0/1	Disable/enable Oscar part (ICQ, AIM)	$oscar
@@ -100,9 +103,13 @@
 #define VARDIR "$datadir"
 #define ARCH "$arch"
 #define CPU "$cpu"
-#define IPV6
 EOF
 
+if [ "$ipv6" = "1" ]; then
+	echo "#define IPV6" >> config.h
+	echo "CPPFLAGS+=-DIPV6" >> Makefile.settings
+fi
+
 if [ "$debug" = "1" ]; then
 	echo 'CFLAGS=-g' >> Makefile.settings
 	echo 'DEBUG=1' >> Makefile.settings
@@ -389,3 +396,9 @@
 else
 	echo '  Building without IM-protocol support. We wish you a lot of fun...';
 fi
+
+if [ "$ipv6" = "1" ]; then
+	echo '  Building with IPv6 support.'
+else
+	echo '  Building without IPv6 support.'
+fi
