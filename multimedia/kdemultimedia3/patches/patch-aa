$NetBSD: patch-aa,v 1.3 2004/03/09 11:59:24 markd Exp $

--- configure.orig	2004-03-01 10:47:15.000000000 +1300
+++ configure
@@ -32634,7 +32634,7 @@ if test "${ac_cv_lib_FLAC_FLAC__seekable
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lFLAC  $LIBS"
+LIBS="-lFLAC -lm $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* #line $LINENO "configure" */
 /* confdefs.h.  */
@@ -33519,7 +33519,7 @@ fi
 echo "$as_me:$LINENO: result: $ac_cv_lib_ossaudio_main" >&5
 echo "${ECHO_T}$ac_cv_lib_ossaudio_main" >&6
 if test $ac_cv_lib_ossaudio_main = yes; then
-  LIBOSSAUDIO="-lossaudio"
+  LIBOSSAUDIO="${LIBOSSAUDIO}"
 fi
 
 
@@ -34785,8 +34785,23 @@ if { (eval echo "$as_me:$LINENO: \"$ac_c
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
 
-                x11_dga2=yes
-
+ 	lib=Xxf86dga
+ 	shared_lib_found=no
+ 	for i in ${LDFLAGS}; do
+ 		case "$i" in
+ 		-L*)
+ 			dir=`echo $i | sed "s,^-L,,"`
+ 			if [ -e $dir/lib${lib}.so ] ||
+ 			   [ "`echo $dir/lib${lib}.so.*`" != "$dir/lib${lib}.so.*" ]; then
+ 				shared_lib_found=yes
+ 				break;
+ 			fi
+ 		esac
+ 	done
+ 	if [ "$shared_lib_found" = "yes" ]; then
+ 		x11_dga2=yes
+ 	fi
+   
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
@@ -34840,7 +34855,22 @@ if { (eval echo "$as_me:$LINENO: \"$ac_c
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
 
+       lib=Xv
+       shared_lib_found=no
+      for i in ${LDFLAGS}; do
+                case "$i" in
+               -L*)
+                       dir=`echo $i | sed "s,^-L,,"`
+                       if [ -e $dir/lib${lib}.so ] ||
+                          [ "`echo $dir/lib${lib}.so.*`" != "$dir/lib${lib}.so.*" ]; then
+                               shared_lib_found=yes
+                               break;
+                       fi
+               esac
+        done
+       if [ "$shared_lib_found" = "yes" ]; then
                 x11_xv=yes
+       fi
 
 else
   echo "$as_me: failed program was:" >&5
@@ -34895,7 +34925,22 @@ if { (eval echo "$as_me:$LINENO: \"$ac_c
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
 
+       lib=Xxf86vm
+       shared_lib_found=no
+       for i in ${LDFLAGS}; do
+                case "$i" in
+               -L*)
+                       dir=`echo $i | sed "s,^-L,,"`
+                       if [ -e $dir/lib${lib}.so ] ||
+                          [ "`echo $dir/lib${lib}.so.*`" != "$dir/lib${lib}.so.*" ]; then
+                               shared_lib_found=yes
+                               break;
+                       fi
+               esac
+       done
+       if [ "$shared_lib_found" = "yes" ]; then
                 x11_xvidmode=yes
+       fi
 
 else
   echo "$as_me: failed program was:" >&5
@@ -35487,10 +35532,10 @@ _ACEOF
     ;;
 
   NetBSD)
-    echo "$as_me:$LINENO: result: NetBSD :Unknown hardware. You will have problems!!" >&5
-echo "${ECHO_T}NetBSD :Unknown hardware. You will have problems!!" >&6
-    OS_TYPE="BSD"
-
+     echo "$as_me:$LINENO: result: using -lpthread" >&5
+     echo $ECHO_N "using -lpthread... $ECHO_C" >&6
+     OS_TYPE="BSD"
+     LIBPTHREAD="-lpthread"
 cat >>confdefs.h <<\_ACEOF
 #define OS_BSD 1
 _ACEOF
