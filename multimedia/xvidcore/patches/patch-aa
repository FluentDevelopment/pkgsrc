$NetBSD: patch-aa,v 1.2 2005/10/21 07:41:53 xtraeme Exp $

--- Makefile.orig	2004-12-19 12:38:46.000000000 +0100
+++ Makefile	2005-10-21 08:26:37.000000000 +0200
@@ -82,7 +82,7 @@
 
 $(BUILD_DIR):
 	@echo "  D: $(BUILD_DIR)"
-	@$(INSTALL) -d $(BUILD_DIR)
+	@$(MKDIR) $(BUILD_DIR)
 
 #-----------------------------------------------------------------------------
 # Generic assembly rule
@@ -90,7 +90,7 @@
 
 .$(ASSEMBLY_EXTENSION).$(OBJECT_EXTENSION):
 	@echo "  A: $(@D)/$(<F)"
-	@$(INSTALL) -d $(BUILD_DIR)/$(@D)
+	@$(MKDIR) $(BUILD_DIR)/$(@D)
 	@$(AS) $(AFLAGS) $< -o $(BUILD_DIR)/$@
 
 #-----------------------------------------------------------------------------
@@ -99,7 +99,7 @@
 
 .c.$(OBJECT_EXTENSION):
 	@echo "  C: $(@D)/$(<F)"
-	@$(INSTALL) -d $(BUILD_DIR)/$(@D)
+	@$(MKDIR) $(BUILD_DIR)/$(@D)
 	@$(CC) -c $(ARCHITECTURE) $(BUS) $(ENDIANNESS) $(FEATURES) $(SPECIFIC_CFLAGS) $(CFLAGS) $< -o $(BUILD_DIR)/$@
 
 #-----------------------------------------------------------------------------
@@ -127,7 +127,7 @@
 
 $(SHARED_LIB): $(BUILD_DIR) $(OBJECTS)
 	@echo "  L: $(@F)"
-	@$(INSTALL) -m 644 libxvidcore.def $(BUILD_DIR)/libxvidcore.def
+	@$(BSD_INSTALL) -m 644 libxvidcore.def $(BUILD_DIR)/libxvidcore.def
 	@cd $(BUILD_DIR) && $(CC) $(LDFLAGS) $(OBJECTS) -o $(PRE_SHARED_LIB) $(SPECIFIC_LDFLAGS)
 
 #-----------------------------------------------------------------------------
@@ -139,6 +139,8 @@
 	@$(INSTALL) -d $(libdir)
 	@echo "  I: $(libdir)/$(SHARED_LIB)"
 	@$(INSTALL) -m 755 $(BUILD_DIR)/$(SHARED_LIB) $(libdir)/$(SHARED_LIB)
+	@ln -s $(libdir)/$(SHARED_LIB) $(libdir)/libxvidcore.so
+	@ln -s $(libdir)/$(SHARED_LIB) $(libdir)/libxvidcore.so.$(API_MAJOR)
 	@echo "  I: $(libdir)/$(STATIC_LIB)"
 	@$(INSTALL) -m 755 $(BUILD_DIR)/$(STATIC_LIB) $(libdir)/$(STATIC_LIB)
 	@echo "  D: $(includedir)"
