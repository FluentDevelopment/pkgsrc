# $NetBSD: Makefile.common,v 1.26 2005/12/05 23:55:13 rillig Exp $

MPLAYER_DIST_VERSION=	1.0pre7

# This variable is used in all packages which depend on this package
MPLAYER_PKG_VERSION=	1.0rc7

DISTNAME=		MPlayer-${MPLAYER_DIST_VERSION}
CATEGORIES?=		multimedia
MASTER_SITES=		http://www1.mplayerhq.hu/MPlayer/releases/ \
			http://ftp5.mplayerhq.hu/mplayer/releases/ \
			http://www4.mplayerhq.hu/MPlayer/releases/ \
			ftp://ftp2.mplayerhq.hu/MPlayer/releases/ \
			ftp://ftp5.mplayerhq.hu/mplayer/releases/
EXTRACT_SUFX=		.tar.bz2
DIST_SUBDIR=		mplayer-${MPLAYER_PKG_VERSION}

MAINTAINER?=		tech-pkg@NetBSD.org
HOMEPAGE?=		http://www.mplayerhq.hu/

#
# NOTE: gmplayer has its own distinfo file. if you are also updating
# gmplayer, you must ensure that *both* distinfo files contain the
# correct, up-to-date files and checksums.
#
# NOTE: patches are shared between mplayer and gmplayer!
#

PATCHDIR=		${.CURDIR}/../../multimedia/mplayer-share/patches
DISTINFO_FILE=		${.CURDIR}/../../multimedia/mplayer-share/distinfo

NO_BIN_ON_CDROM=	"a dependency is restricted"
NO_BIN_ON_FTP=		"a dependency is restricted"
NO_SRC_ON_FTP=		"prohibited by USAs DMCA"

USE_TOOLS+=		gmake
HAS_CONFIGURE=		YES

PTHREAD_OPTS+=		require

CONFIGURE_ARGS+=	--prefix=${PREFIX:Q} \
			--with-extraincdir="${LOCALBASE}/include:${LOCALBASE}/include/faad2" \
			--with-extralibdir="${LOCALBASE}/lib" \
			--with-x11incdir="${X11BASE}/include" \
			--with-x11libdir="${X11BASE}/lib" \
			--disable-mpdvdkit

ONLY_FOR_COMPILER=	gcc

# The configure script attempts to test-execute compiled programs in /tmp,
# but that directory may be mounted as noexec; work this around by setting
# TMPDIR to ${WRKDIR}
CONFIGURE_ENV+=		TMPDIR=${WRKDIR:Q}

.include "../../mk/bsd.prefs.mk"

.include "../../multimedia/mplayer-share/options.mk"
