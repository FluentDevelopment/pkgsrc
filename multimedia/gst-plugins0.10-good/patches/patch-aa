$NetBSD: patch-aa,v 1.1 2006/01/30 21:20:42 rillig Exp $

Keywords: c90

--- gst/avi/gstavidemux.c.orig	2006-01-10 15:01:55.000000000 +0100
+++ gst/avi/gstavidemux.c	2006-01-30 21:33:28.000000000 +0100
@@ -2219,10 +2219,11 @@ swap_line (guint8 * d1, guint8 * d2, gui
 static GstBuffer *
 gst_avi_demux_invert (avi_stream_context * stream, GstBuffer * buf)
 {
-  buf = gst_buffer_make_writable (buf);
   gint y, h = stream->strf.vids->height, w = stream->strf.vids->width;
   guint8 *tmp = NULL;
 
+  buf = gst_buffer_make_writable (buf);
+
   if (GST_BUFFER_SIZE (buf) < (w * h)) {
     GST_WARNING ("Buffer is smaller than reported Width x Height");
     return buf;
