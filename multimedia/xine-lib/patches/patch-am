$NetBSD: patch-am,v 1.3 2004/06/21 15:55:55 drochner Exp $

--- src/libw32dll/wine/ldt_keeper.c.orig	2004-06-13 01:19:56.000000000 +0200
+++ src/libw32dll/wine/ldt_keeper.c
@@ -155,18 +155,9 @@ void Setup_FS_Segment(void)
 
 void Check_FS_Segment(void)
 {
-    int fs;
-     __asm__ __volatile__(
-	"movw %%fs,%%ax; mov %%eax,%0" : "=r" (fs) :: "%eax"
+    __asm__ __volatile__(
+	"movl %0,%%eax; movw %%ax, %%fs" : : "r" (teb_sel) : "%eax"
     );
-    fs = fs & 0xffff;
-    
-    if( fs != teb_sel ) {
-      printf("ldt_keeper: FS segment is not set or has being lost!\n");
-      printf("            Please report this error to xine-devel@lists.sourceforge.net\n");
-      printf("            Aborting....\n");
-      abort();
-    }
 }
 
 #if defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)
