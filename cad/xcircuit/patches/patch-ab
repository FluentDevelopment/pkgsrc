$NetBSD: patch-ab,v 1.8 2006/10/14 02:21:22 rillig Exp $

--- configure.orig	2004-10-01 06:25:07.000000000 +0200
+++ configure	2006-10-14 04:20:29.000000000 +0200
@@ -7393,7 +7393,7 @@ if test "${with_tcl+set}" = set; then
   withval="$with_tcl"
 
   xc_with_tcl=$withval
-  if test "$withval" == "no" -o "$withval" == "NO"; then
+  if test "$withval" = "no" -o "$withval" = "NO"; then
       xc_with_tcl=""
   fi
 
@@ -7629,6 +7629,7 @@ fi
 if test "x$xc_with_tcl" != "x" ; then
   . $tcl_config_sh
   . $tk_config_sh
+  LIBS="${LIBS} ${TCL_LIBS}"
 
   if test "$TCL_VERSION" = "7.6" -a "$TK_VERSION" = "4.2" ; then
     :
@@ -7704,7 +7705,7 @@ fi
 
 if test "x$xc_with_tcl" != "x" ; then
   case $target in
-    *-sunos4*|*-*-netbsd|NetBSD-*|FreeBSD-*|OpenBSD-*)
+    *-sunos4*|*-*-netbsd|*-*-netbsdelf|NetBSD-*|FreeBSD-*|OpenBSD-*|*-*-dragonfly*)
       TCL_LIB_NAME="tcl${TCL_MAJOR_VERSION}${TCL_MINOR_VERSION}"
       TK_LIB_NAME="tk${TK_MAJOR_VERSION}${TK_MINOR_VERSION}"
       ;;
@@ -8105,7 +8106,7 @@ fi
       EXTRA_LIB_SPECS="-ldl"
       ;;
 
-    *-netbsd*|*-freebsd*|*-openbsd*)
+    *-netbsd*|*-freebsd*|*-openbsd*|*-*-dragonfly*)
       # Not available on all versions:  check for include file.
       if test "${ac_cv_header_dlfcn_h+set}" = set; then
   echo "$as_me:$LINENO: checking for dlfcn.h" >&5
@@ -8244,9 +8245,9 @@ fi
 
 
       if test "$test_ok" = yes; then
-        SHLIB_CFLAGS="-fpic"
-        SHLIB_LD="ld"
-        LDDL_FLAGS="-Bshareable -x ${LIB_SPEC}"
+        SHLIB_CFLAGS="-fPIC"
+        SHLIB_LD=$CC
+        LDDL_FLAGS="-shared"
       fi
       ;;
 
