$NetBSD: patch-ad,v 1.5 2006/03/22 16:40:08 joerg Exp $

--- configure-	2004-05-16 05:05:10.000000000 +0900
+++ configure	2004-05-16 05:08:20.000000000 +0900
@@ -5480,6 +5480,8 @@ case $host in
 	use_threads=false ;;
 *-freebsd*)
 	use_threads=false ;;
+*-dragonfly*)
+	use_threads=false ;;
 *-bsdi234*)
 	# Thread signals do not work reliably on some versions of BSD/OS.
 	use_threads=false ;;
@@ -5579,14 +5581,22 @@ echo "$as_me: error: \"could not find th
 
 				if $use_threads
 				then
-					echo "$as_me:$LINENO: result: mit-pthreads/unproven-pthreads" >&5
-echo "${ECHO_T}mit-pthreads/unproven-pthreads" >&6
-					pkg="$LOCALBASE/pthreads"
-					lib1="-L$pkg/lib -Wl,-R$pkg/lib"
-					lib2="-lpthread -lm -lgcc -lpthread"
-					LIBS="$lib1 $lib2 $LIBS"
-					CPPFLAGS="$CPPFLAGS -I$pkg/include"
-					STD_CINCLUDES="$STD_CINCLUDES -I$pkg/include"
+					if test -f /usr/include/pthreads.h
+					then
+						echo "$as_me:$LINENO: result: native pthreads" >&5
+						LIBS="-lpthread $LIBS"
+						CPPFLAGS="$CPPFLAGS -I/usr/include"
+						STD_CINCLUDES="$STD_CINCLUDES -I/usr/include"
+					else
+						echo "$as_me:$LINENO: result: mit-pthreads/unproven-pthreads" >&5
+	echo "${ECHO_T}mit-pthreads/unproven-pthreads" >&6
+						pkg="$LOCALBASE/pthreads"
+						lib1="-L$pkg/lib -Wl,-R$pkg/lib"
+						lib2="-lpthread -lm -lgcc -lpthread"
+						LIBS="$lib1 $lib2 $LIBS"
+						CPPFLAGS="$CPPFLAGS -I$pkg/include"
+						STD_CINCLUDES="$STD_CINCLUDES -I$pkg/include"
+					fi
 				fi
 			fi
 		fi
@@ -6727,6 +6737,10 @@ fi
 			CCOPT="$CCOPT -pthread"
 			STD_CDEFINES="$STD_CDEFINES -D_THREAD_SAFE"
 			;;
+		*-dragonfly*)
+			CC="$CC -pthread"
+			CCOPT="$CCOPT -pthread"
+			;;
 		*-openbsd*)
 			CC="$CC -pthread"
 			CCOPT="$CCOPT -pthread"
