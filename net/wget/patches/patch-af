$NetBSD: patch-af,v 1.4 2002/12/16 11:39:02 wiz Exp $

--- src/cookies.c.orig	Sun May 19 05:04:53 2002
+++ src/cookies.c
@@ -491,7 +491,12 @@ parse_set_cookies (const char *sc)
 	{
 	case S_NAME_PRE:
 	  if (ISSPACE (c))
-	    FETCH (c, p);
+	    {
+	      FETCH1 (c, p);
+	      /* drop trailing whitespace */
+	      if (!c)
+	        state = S_DONE;
+	    }
 	  else if (ATTR_NAME_CHAR (c))
 	    {
 	      name_b = p - 1;
@@ -622,7 +627,11 @@ parse_set_cookies (const char *sc)
 	}
     }
   if (state == S_DONE)
-    return cookie;
+    {
+      if (!cookie->attr)
+	goto eof;
+      return cookie;
+    }
 
   delete_cookie (cookie);
   if (state == S_ERROR)
