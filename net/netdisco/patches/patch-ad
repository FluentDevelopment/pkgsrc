$NetBSD: patch-ad,v 1.1 2006/03/09 20:25:28 bouyer Exp $

--- netdisco_apache.conf.orig	2004-03-07 20:13:49.000000000 +0100
+++ netdisco_apache.conf	2006-03-09 16:34:23.000000000 +0100
@@ -4,8 +4,10 @@
 
 # Pool Database Connections
 PerlModule Apache::DBI
+@APACHE2@PerlModule CGI
+@APACHE2@PerlModule Apache2::Request
 
-<Directory /usr/local/netdisco/html>
+<Directory /usr/pkg/netdisco/html>
 	order allow,deny
 	allow from all
 </Directory>
@@ -14,12 +16,12 @@
 # Preload the netdisco module into global server space.
 #   and parse the config file only once.
 { package HTML::Mason::Commands;
-    use lib '/usr/local/netdisco';
+    use lib '/usr/pkg/netdisco';
     use netdisco qw/:all/;
-    &netdisco::config('/usr/local/netdisco/netdisco.conf');
+    &netdisco::config('/usr/pkg/netdisco/netdisco.conf');
 
     # Uncomment next two lines to setup switch reverse proxy.
-    #use lib '/usr/local/netdisco/switch';
+    #use lib '/usr/pkg/netdisco/switch';
     #use Apache::ProxyRewriteMax;
 }
 
@@ -30,8 +32,9 @@
     use strict;
 
     my $ah = new HTML::Mason::ApacheHandler(
-        comp_root              => '/usr/local/netdisco/html',
-        data_dir               => '/usr/local/netdisco/mason',
+@APACHE2@        args_method            => 'mod_perl',
+        comp_root              => '/usr/pkg/netdisco/html',
+        data_dir               => '/usr/pkg/netdisco/mason',
         request_class          => 'MasonX::Request::WithApacheSession',
         session_class          => 'Apache::Session::Postgres',
         session_commit         => 1,
