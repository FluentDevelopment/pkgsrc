$NetBSD: patch-aa,v 1.4 2003/10/07 19:35:34 hubertf Exp $

--- nidentd.orig	Sat May  4 14:53:01 2002
+++ nidentd
@@ -2,8 +2,8 @@
 
 v_lsof="/usr/pkg/sbin/lsof -P -n -Di"
 v_ipnat="/usr/sbin/ipnat -l"
-v_nat_conf="/usr/local/etc/nidentd.nat"
-v_fake_conf="/usr/local/etc/nidentd.fake"
+v_nat_conf="/usr/pkg/etc/nidentd.nat"
+v_fake_conf="/usr/pkg/etc/nidentd.fake"
 
 # Protocol independent
 
@@ -40,7 +40,7 @@ if [ -n $qlport ] && [ -n $qrport ] && [
     if [ $qlport -eq $lport ] && [ $qrport -eq $rport ]
       then
 		masqip=`$v_ipnat -l | grep -e "MAP" -e " $qlport " -e " $qrport" | awk '{ print $2 }' | tr -c -d '.1234567890'`
-		hostn=`grep ^$masqip $v_nat_conf | awk -F: '{ print $2 }'`
+		hostn=`grep ^"$masqip:" $v_nat_conf | awk -F: '{ print $2 }'`
         if [ $hostn ]
           then
             printf "$qlport , $qrport : USERID : UNIX : $hostn\r\n"
