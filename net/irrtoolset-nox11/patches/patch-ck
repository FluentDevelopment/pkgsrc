$NetBSD: patch-ck,v 1.1 2006/02/15 20:07:40 spz Exp $

--- src/irr/birdwhoisc.cc.orig	2004-07-30 12:58:11.000000000 +0200
+++ src/irr/birdwhoisc.cc
@@ -112,10 +112,13 @@ static void stripRipeComments(Buffer &bu
 	 if (eol == NULL)
 	    // no EOL, no comment to strip (yet)
 	    goto out;
-	 assert(*(eol+1) == '\n' || *(eol+1) == '%');
 	 size -= (eol-cont)+1;
 	 cont = eol + 1;
 	 removedLines = true;
+     if (*(cont) != '\n' && *(cont) != '%') 
+        // next line starts not with a comment, so assume comments have
+        // ended the APNIC way
+        goto out;
       }
       if (*cont == '\n') {
 	 size--;
@@ -197,6 +200,8 @@ bool BirdWhoisClient::getResponse(char *
       << "]"
       << endl;
 
+   text = result->contents;
+   len  = result->size;
    return true;
 }
 
