$NetBSD: patch-ac,v 1.4 2002/11/03 21:32:25 wiz Exp $

--- src/callbacks.c.orig	Sun Nov  3 08:12:20 2002
+++ src/callbacks.c
@@ -2,6 +2,13 @@
 #  include <config.h>
 #endif
 
+#ifdef __linux__
+#include <linux/sem.h>
+#else
+#ifndef SEMVMX
+#define SEMVMX  32767           /* semaphore maximum value */
+#endif
+#endif
 #include <math.h>
 #include <sys/types.h>
 #include <signal.h>
@@ -14,7 +21,6 @@
 #include <dirent.h>
 #include <gdk/gdkkeysyms.h>
 #include <gdk/gdk.h>
-#include <linux/sem.h>
 #include <gnome.h>
 #include <glib.h>
 #include <time.h>
@@ -1632,7 +1638,7 @@ on_find_entry_activate                 (
 
 		val=atof(gtk_entry_get_text(GTK_ENTRY(w)));
 
-		g_string_sprintfa(req,"%lf",scale*val);
+		g_string_sprintfa(req,"%f",scale*val);
 	}
 
 	w=get_widget_by_widget_name("find_result");
@@ -2875,7 +2881,7 @@ on_apply_pref_clicked                  (
 			}
 			if(i==4)
 				i=0;
-			g_string_sprintf(out,"/OFFSET %lf\n",strtod(v,NULL)*scale[i]);
+			g_string_sprintf(out,"/OFFSET %f\n",strtod(v,NULL)*scale[i]);
 			send_data_to_dctc(out->str);
 		}
 	}
@@ -3447,7 +3453,7 @@ static void reload_ls_cache_clist(int ev
 				LS_CACHE_CL_ENTRY *lcce;
 
 				strftime(dl_time,sizeof(dl_time)-1,"%c",localtime(&(lsch.retrieve_time)));
-				sprintf(buf,"%'llu", lsch.share_size);
+				sprintf(buf,"%llu", lsch.share_size);
 				
 				nw[0]=obj->d_name;
 				nw[1]=buf;
