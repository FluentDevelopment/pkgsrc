$NetBSD: patch-ab,v 1.3 2002/10/03 12:16:56 wiz Exp $

--- configure.orig	Sun Sep 22 18:38:46 2002
+++ configure
@@ -4221,8 +4221,52 @@ fi
       
       berkeleydb_libs="-ldb-4.0"
    else
+   echo $ac_n "checking for db_env_create in -ldb4""... $ac_c" 1>&6
+echo "configure:4226: checking for db_env_create in -ldb4" >&5
+ac_lib_var=`echo db4'_'db_env_create | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldb4  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 4234 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char db_env_create();
+
+int main() {
+db_env_create()
+; return 0; }
+EOF
+if { (eval echo configure:4245: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  HAVE_DB40=yes
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+   if test "x$HAVE_DB40" = "xyes"; then
+      
+      berkeleydb_libs="-ldb4"
+   else
       echo $ac_n "checking for db_env_create in -ldb-3.3""... $ac_c" 1>&6
-echo "configure:4226: checking for db_env_create in -ldb-3.3" >&5
+echo "configure:4270: checking for db_env_create in -ldb-3.3" >&5
 ac_lib_var=`echo db-3.3'_'db_env_create | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4407,6 +4451,7 @@ fi
                fi
             fi
          fi
+      fi
       fi
    fi
 else
