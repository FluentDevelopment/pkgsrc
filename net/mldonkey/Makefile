# $NetBSD: Makefile,v 1.44 2007/02/16 06:42:33 wiz Exp $
#

.include "Makefile.common"

RCD_SCRIPTS=		mldonkey

BUILD_DEFS+=		MLDONKEY_GROUP MLDONKEY_HOME MLDONKEY_USER
BUILD_DEFS+=		VARBASE

OWN_DIRS_PERMS=		${MLDONKEY_HOME} ${MLDONKEY_USER} ${MLDONKEY_GROUP} 0700
OWN_DIRS_PERMS+=	${VARBASE}/log/mldonkey \
			${MLDONKEY_USER} ${MLDONKEY_GROUP} 0700
OWN_DIRS_PERMS+=	${VARBASE}/run/mldonkey \
			${MLDONKEY_USER} ${MLDONKEY_GROUP} 0700

PKG_GROUPS=		${MLDONKEY_GROUP}
PKG_USERS=		${MLDONKEY_USER}:${MLDONKEY_GROUP}

PKG_GECOS.${MLDONKEY_USER}=	Dedicated mldonkey server
PKG_HOME.${MLDONKEY_USER}=	${MLDONKEY_HOME}
PKG_SHELL.${MLDONKEY_USER}=	${SH}

FILES_SUBST+=		MLDONKEY_GROUP=${MLDONKEY_GROUP:Q}
FILES_SUBST+=		MLDONKEY_HOME=${MLDONKEY_HOME:Q}
FILES_SUBST+=		MLDONKEY_USER=${MLDONKEY_USER:Q}

do-install:
	${INSTALL_PROGRAM_DIR} ${PREFIX}/libexec/mldonkey
	${INSTALL_PROGRAM} ${WRKSRC}/mlnet ${PREFIX}/libexec/mldonkey

.include "../../converters/libiconv/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
