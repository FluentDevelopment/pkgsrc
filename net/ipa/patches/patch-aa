$NetBSD: patch-aa,v 1.10 2006/06/04 22:21:27 joerg Exp $

--- Makefile.orig	2003-11-11 10:24:34.000000000 +0000
+++ Makefile
@@ -38,7 +38,7 @@ CC?=		/usr/bin/cc
 #	-Ox   - optimize;
 #	-g    - produce debugging information.
 #
-CFLAGS=		-Wall -O1 -g
+#CFLAGS=		-Wall -O1 -g
 
 #
 # PREFIX - prefix for all below listed paths
@@ -58,7 +58,7 @@ DST_MAN_DIR=	${PREFIX}/man
 #
 # DST_ETC_DIR - where to install template configuration
 #
-DST_ETC_DIR=	${PREFIX}/etc
+DST_ETC_DIR=	${DST_EXAMPLE_DIR}
 
 #
 # DST_RC_DIR - where to install sample rc-script
@@ -81,10 +81,10 @@ MKDIR?=		/bin/mkdir
 #
 # INSTALL_* variables
 #
-INSTALL_MAN=		${INSTALL} -c -g wheel -o root -m 0444
-INSTALL_DATA=		${INSTALL} -c -g wheel -o root -m 0444
-INSTALL_PROGRAM=	${INSTALL} -c -g wheel -o root -m 0555
-INSTALL_SCRIPT=		${INSTALL} -c -g wheel -o root -m 0500 
+INSTALL_MAN=		${BSD_INSTALL_MAN}
+INSTALL_DATA=		${BSD_INSTALL_DATA}
+INSTALL_PROGRAM=	${BSD_INSTALL_PROGRAM}
+INSTALL_SCRIPT=		${BSD_INSTALL_SCRIPT}
 INSTALL_MAN_DIR=	${INSTALL} -d -m 0555 -g wheel -o root
 INSTALL_DATA_DIR=	${INSTALL} -d -m 0555 -g wheel -o root
 
@@ -98,7 +98,7 @@ IPASTAT=	ipastat.o common.o
 .MAIN: checkos ${OS}
 
 checkos:
-.if ${OS} != "FreeBSD" && ${OS} != "NetBSD" && ${OS} != "OpenBSD"
+.if ${OS} != "FreeBSD" && ${OS} != "NetBSD" && ${OS} != "OpenBSD" && ${OS} != "DragonFly"
 	@${ECHO}
 	@${ECHO} ">> IPA-`${CAT} Version` is designed for FreeBSD, NetBSD and OpenBSD."
 	@${ECHO} ">> Your operating system is ${OS}."
@@ -139,7 +139,7 @@ CFLAGS+=	-I${PF_INCLUDE_DIR}
 .endif
 .endif
 
-.ifmake FreeBSD
+.if make(FreeBSD) || make(DragonFly)
 IPA+=		kipfw.o kip6fw.o
 .endif
 
@@ -147,7 +147,7 @@ IPA+=		kipfw.o kip6fw.o
 IPA+=		kpf.o
 .endif
 
-FreeBSD NetBSD OpenBSD: ipa ipastat
+DragonFly FreeBSD NetBSD OpenBSD: ipa ipastat
 
 ipa: ${IPA}
 	${CC} -o ${.TARGET} ${IPA}
@@ -214,21 +214,8 @@ install:
 	${INSTALL_PROGRAM} ipa ipastat ${DST_BIN_DIR}
 	${INSTALL_MAN} man/ipa.5 man/ipa.conf.5 ${DST_MAN_DIR}/man5
 	${INSTALL_MAN} man/ipa.8 man/ipastat.8 ${DST_MAN_DIR}/man8
-.if !exists(${DST_MAN_DIR}/ru_RU.KOI8-R/man5)
-	${INSTALL_MAN_DIR} ${DST_MAN_DIR}/ru_RU.KOI8-R/man5
-.endif
-.if !exists(${DST_MAN_DIR}/ru_RU.KOI8-R/man8)
-	${INSTALL_MAN_DIR} ${DST_MAN_DIR}/ru_RU.KOI8-R/man8
-.endif
-.if !exists(${DST_MAN_DIR}/ru_SU.KOI8-R)
-	${LN} -s ${DST_MAN_DIR}/ru_RU.KOI8-R ${DST_MAN_DIR}/ru_SU.KOI8-R
-.endif
-	${INSTALL_MAN} man/ru_RU.KOI8-R/ipa.5 man/ru_RU.KOI8-R/ipa.conf.5 ${DST_MAN_DIR}/ru_RU.KOI8-R/man5
-	${INSTALL_MAN} man/ru_RU.KOI8-R/ipa.8 man/ru_RU.KOI8-R/ipastat.8 ${DST_MAN_DIR}/ru_RU.KOI8-R/man8
-	${INSTALL_DATA_DIR} ${DST_EXAMPLE_DIR}
 	${INSTALL_DATA} examples/* ${DST_EXAMPLE_DIR}
 .if exists(${DST_RC_DIR})
-	${INSTALL_SCRIPT} etc/ipa.sh.sample ${DST_RC_DIR}
 .else
 	@${ECHO}
 	@${ECHO} ">> Can't find directory ${DST_RC_DIR}, the ipa.sh.sample file was not installed (not a problem)."
