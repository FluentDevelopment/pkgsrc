$NetBSD: patch-af,v 1.6 2006/03/19 22:03:29 joerg Exp $

--- configure.orig	2006-01-14 01:51:51.000000000 +0000
+++ configure
@@ -13421,7 +13421,7 @@ else
    default_mibs=IP-MIB:IF-MIB:TCP-MIB:UDP-MIB:HOST-RESOURCES-MIB:SNMPv2-MIB:RFC1213-MIB:NOTIFICATION-LOG-MIB:DISMAN-EVENT-MIB:DISMAN-SCHEDULE-MIB
 
    case $target_os in
-      linux* | mingw32* | cygwin* | freebsd* | dynix* | solaris2* | hpux* )
+      linux* | mingw32* | cygwin* | freebsd* | dynix* | solaris2* | hpux* | dragonfly* )
          new_module_list="$new_module_list host"
          ;;
       *)
@@ -15503,6 +15503,53 @@ fi
 
 fi
 
+echo $ac_n "checking for des_cbc_encrypt in -ldes""... $ac_c" 1>&6
+echo "configure:8529: checking for des_cbc_encrypt in -ldes" >&5
+ac_lib_var=`echo des'_'des_cbc_encrypt | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldes  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 11217 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char des_cbc_encrypt();
+
+int main() {
+des_cbc_encrypt()
+; return 0; }
+EOF
+if { (eval echo configure:8548: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo des | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-ldes $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
 # Check for libraries that the agent needs
 # saving old libraries
 NONAGENTLIBS=$LIBS
@@ -27716,7 +27763,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -27814,7 +27863,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -27912,10 +27963,14 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
-#undef _KERNEL
+#if !defined(__DragonFly__)
+#define _KERNEL
+#endif
 #include <net/route.h>
 
 
@@ -27999,7 +28054,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28066,7 +28123,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28204,7 +28263,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28299,7 +28360,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28398,7 +28461,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28497,7 +28562,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -28596,7 +28663,9 @@ cat >>conftest.$ac_ext <<_ACEOF
 #endif
 #include <sys/types.h>
 #define KERNEL
+#if !defined(__DragonFly__)
 #define _KERNEL
+#endif
 #include <sys/socket.h>
 #undef KERNEL
 #undef _KERNEL
@@ -34718,6 +34787,8 @@ do
 _ACEOF
 cat >>$CONFIG_STATUS <<\_ACEOF
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+    # Avoid regenerating for rechecks on pkgsrc
+    exit 0
     ac_cs_recheck=: ;;
   --version | --vers* | -V )
     echo "$ac_cs_version"; exit 0 ;;
