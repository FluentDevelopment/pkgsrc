$NetBSD: patch-aa,v 1.8 2002/10/13 04:42:13 hubertf Exp $

--- src/snort.c.orig	Wed Sep 25 21:56:53 2002
+++ src/snort.c
@@ -1437,6 +1437,19 @@
 
             break;
 
+#if defined(__NetBSD__)
+#  if defined(__NetBSD_Version__)
+#    if (__NetBSD_Version__ >= 105000000)
+        case DLT_PPP_SERIAL:         /* PPP over serial (async and sync) */
+        case DLT_PPP_ETHER:          /* PPP over Ethernet */
+
+#    else
+       /* no DLT_PPP_* on <1.5 */
+#    endif /* >= NetBSD 1.5 */
+#  else
+       /* no __NetBSD_Version__ on <1.4 */
+#  endif /* __NetBSD_Version__ */
+#endif /* NetBSD */
         case DLT_PPP:                /* point-to-point protocol */
             if(!pv.readmode_flag)
             {
@@ -2193,7 +2206,7 @@
     struct stat st;
     int found;
     int i;
-    char *conf_files[]={"/etc/snort.conf", "./snort.conf", NULL};
+    char *conf_files[]={ PREFIX "/etc/snort.conf", "./snort.conf", NULL};
     char *fname = NULL;
     char *home_dir;
     char *tmp;
