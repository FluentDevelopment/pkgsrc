$NetBSD: patch-ac,v 1.3 2002/10/03 12:19:12 wiz Exp $

--- configure.orig	Sun Sep 22 18:28:09 2002
+++ configure
@@ -873,7 +873,7 @@ fi
   
 
 
-for ac_prog in gawk mawk nawk awk
+for ac_prog in mawk gawk nawk awk
 do
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
@@ -1904,8 +1904,52 @@ fi
 		
 		berkeleydb_libs="-ldb-4.0"
 	else
+	echo $ac_n "checking for db_env_create in -ldb4""... $ac_c" 1>&6
+echo "configure:1909: checking for db_env_create in -ldb4" >&5
+ac_lib_var=`echo db4'_'db_env_create | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldb4  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1917 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char db_env_create();
+
+int main() {
+db_env_create()
+; return 0; }
+EOF
+if { (eval echo configure:1928: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  HAVE_DB40=yes
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+	if test "x$HAVE_DB40" = "xyes"; then
+		
+		berkeleydb_libs="-ldb4"
+	else
 		echo $ac_n "checking for db_env_create in -ldb-3.3""... $ac_c" 1>&6
-echo "configure:1909: checking for db_env_create in -ldb-3.3" >&5
+echo "configure:1953: checking for db_env_create in -ldb-3.3" >&5
 ac_lib_var=`echo db-3.3'_'db_env_create | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -2091,6 +2135,7 @@ fi
 				fi
 			fi
 		fi
+		fi
 	fi
 else
 		echo $ac_n "checking Berkeley Database library version""... $ac_c" 1>&6
