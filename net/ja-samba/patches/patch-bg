$NetBSD: patch-bg,v 1.1 2004/07/23 16:45:43 taca Exp $

--- smbd/reply.c.orig	2003-07-17 19:41:37.000000000 +0900
+++ smbd/reply.c
@@ -2191,7 +2191,7 @@ NTSTATUS unlink_internals(connection_str
 	 */
 
 	if (!rc && mangle_is_mangled(mask))
-		mangle_check_cache( mask );
+		mangle_check_cache( mask, sizeof(pstring)-1 );
 
 	has_wild = ms_has_wild(mask);
 
@@ -4049,7 +4049,7 @@ NTSTATUS rename_internals(connection_str
 	 */
 
 	if (!rc && mangle_is_mangled(mask))
-		mangle_check_cache( mask );
+		mangle_check_cache( mask, sizeof(pstring)-1 );
 
 	has_wild = ms_has_wild(mask);
 
@@ -4463,7 +4463,7 @@ int reply_copy(connection_struct *conn, 
    */
 
   if (!rc && mangle_is_mangled(mask))
-    mangle_check_cache( mask );
+    mangle_check_cache( mask, sizeof(pstring)-1 );
 
   has_wild = ms_has_wild(mask);
 
