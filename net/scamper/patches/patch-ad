$NetBSD: patch-ad,v 1.1 2006/02/24 19:53:52 joerg Exp $

--- scamper_icmp4.c.orig	2006-02-24 19:46:32.000000000 +0000
+++ scamper_icmp4.c
@@ -268,7 +268,7 @@ uint16_t scamper_icmp4_icmp_ip_len(struc
 
 #if defined(__linux__) || defined(__OpenBSD__) || defined(__sun__)
   len = ntohs(icmp->icmp_ip.ip_len);
-#elif defined(__FreeBSD__) || defined(__NetBSD__) || defined(__APPLE__)
+#elif defined(__FreeBSD__) || defined(__NetBSD__) || defined(__APPLE__) || defined(__DragonFly__)
   if(icmp->icmp_type == ICMP_TIMXCEED)
     {
       if(icmp->icmp_code <= 1)
@@ -298,7 +298,7 @@ uint16_t scamper_icmp4_icmp_ip_len(struc
 	case ICMP_UNREACH_HOST_PROHIB:
 	case ICMP_UNREACH_TOSHOST:
 
-# if defined(__FreeBSD__) || defined(__APPLE__)
+# if defined(__FreeBSD__) || defined(__APPLE__) || defined(__DragonFly__)
 	case ICMP_UNREACH_HOST_PRECEDENCE:
 	case ICMP_UNREACH_PRECEDENCE_CUTOFF:
 	case ICMP_UNREACH_FILTER_PROHIB:
