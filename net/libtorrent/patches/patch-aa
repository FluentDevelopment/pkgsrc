$NetBSD: patch-aa,v 1.3 2006/03/03 15:30:53 tron Exp $

--- src/protocol/peer_connection_leech.cc.orig	2006-02-09 16:05:05.000000000 +0000
+++ src/protocol/peer_connection_leech.cc	2006-03-03 15:11:38.000000000 +0000
@@ -204,7 +204,7 @@
     }
 
   case ProtocolBase::REQUEST:
-    if (buf->remaining() < 13)
+    if (buf->remaining() < 12)
       break;
 
     if (!m_up->choked()) {
@@ -260,7 +260,7 @@
     }
 
   case ProtocolBase::CANCEL:
-    if (buf->remaining() < 13)
+    if (buf->remaining() < 12)
       break;
 
     read_cancel_piece(m_down->read_request());
