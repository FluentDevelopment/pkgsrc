$NetBSD: patch-as,v 1.2 2005/03/15 15:58:52 wennmach Exp $

Make arla compile on pmax. 

--- configure.orig	2004-11-15 11:13:02.000000000 -0500
+++ configure	2004-12-22 20:35:37.000000000 -0500
@@ -6558,10 +6558,19 @@
   then
 	flags="$flags${flags:+ }-mno-fp-regs"
   fi
+  if test `uname -m` = pmax
+  then
+	KERNEL_CFLAGS="${KERNEL_CFLAGS} -G 0 -mno-abicalls -mno-half-pic"
+	KERNEL_LDFLAGS="${KERNEL_LDFLAGS} -G 0 -Ttext 0x80030000 -T ${SYS}/arch/mips/conf/kern.ldscript"
+  fi
   KERNEL_CPPFLAGS="${KERNEL_CPPFLAGS} -D_LKM"
   KERNEL_CPPFLAGS="${KERNEL_CPPFLAGS} $defs${defs:+ }$flags${flags:+ }$incl"
-  test_KERNEL_CFLAGS="${KERNEL_CFLAGS}"
   KERNEL_LD='ld'
+  test_KERNEL_CFLAGS="${KERNEL_CFLAGS}"
+  if test `uname -m` = pmax
+  then
+      ac_kernel_ld='${KERNEL_LD} ${KERNEL_LDFLAGS} -o conftest $LDFLAGS -R $KERNEL conftest.o -e _foo 1>&5'
+  fi
   NNPFS_SRCS='nnpfs_wrap-bsd.c nnpfs_common-bsd.c nnpfs_dev-common.c nnpfs_dev-bsd.c nnpfs_syscalls-common.c nnpfs_syscalls-wrap-bsd.c nnpfs_node-bsd.c nnpfs_vfsops-common.c nnpfs_vfsops-bsd.c nnpfs_vfsops-openbsd.c nnpfs_vnodeops-common.c nnpfs_vnodeops-bsd.c'
   NNPFS_SUBDIR=bsd
   KERNEL=/bsd
