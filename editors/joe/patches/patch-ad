$NetBSD: patch-ad,v 1.3 2003/04/27 17:45:31 cjep Exp $

--- main.c.orig	1995-01-22 00:21:08.000000000 +0000
+++ main.c
@@ -18,6 +18,10 @@ JOE; see the file COPYING.  If not, writ
 
 #include <stdio.h>
 #include <fcntl.h>
+#if defined(__FreeBSD__) || defined(__NetBSD__)
+#include <locale.h>
+#include <ctype.h>
+#endif
 #include "config.h"
 #include "w.h"
 #include "tty.h"
@@ -187,6 +191,20 @@ char *envv[];
  run=namprt(argv[0]);
 #endif 
 
+#if defined(__FreeBSD__) || defined(__NetBSD__)
+ setlocale(LC_ALL, "");
+ for(c=0;c<256;c++)
+  { int a=0;
+    if(iscntrl(c))
+     a|=UNDERLINE;
+    if((c&0x80)&&!isprint(c))
+     a|=INVERSE;
+    xlata[c]=a;
+    if(isprint(c))
+     xlatc[c]=c;
+  }
+#endif
+
  if(s=getenv("LINES")) sscanf(s,"%d",&lines);
  if(s=getenv("COLUMNS")) sscanf(s,"%d",&columns);
  if(s=getenv("BAUD")) sscanf(s,"%u",&Baud);
@@ -234,20 +252,6 @@ char *envv[];
 
 #else
 
- s=vsncpy(NULL,0,sc("."));
- s=vsncpy(sv(s),sv(run));
- s=vsncpy(sv(s),sc("rc"));
- c=procrc(cap,s);
- if(c==0) goto donerc;
- if(c==1)
-  {
-  char buf[8];
-  fprintf(stderr,"There were errors in '%s'.  Use it anyway?",s);
-  fflush(stderr);
-  fgets(buf,8,stdin);
-  if(buf[0]=='y' || buf[0]=='Y') goto donerc;
-  }
-
  vsrm(s);
  s=getenv("HOME");
  if(s)
