$NetBSD: patch-am,v 1.5 2003/05/28 02:34:01 jlam Exp $

--- config-scripts/cups-common.m4.orig	Wed May 14 14:24:38 2003
+++ config-scripts/cups-common.m4
@@ -81,8 +81,16 @@ dnl Architecture checks...
 AC_C_BIGENDIAN
 
 dnl Check for libraries...
-AC_SEARCH_LIBS(crypt, crypt)
 AC_SEARCH_LIBS(getspent, sec gen)
+
+dnl Check for crypt() in libcrypt.  We need to link -lcrypt ahead of any
+dnl OpenSSL libraries because the system crypt() is usually smarter than
+dnl the libcrypto crypt() routine.
+LIBCRYPT=""
+AC_CHECK_LIB(crypt, crypt, LIBCRYPT="-lcrypt", LIBS="$LIBS -lcrypt")
+EXPORT_LIBCRYPT="$LIBCRYPT"
+AC_SUBST(LIBCRYPT)
+AC_SUBST(EXPORT_LIBCRYPT)
 
 LIBMALLOC=""
 AC_ARG_ENABLE(mallinfo, [  --enable-mallinfo       turn on malloc debug information, default=no])
