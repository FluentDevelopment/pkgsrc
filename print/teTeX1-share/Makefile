# $NetBSD: Makefile,v 1.10 2006/03/04 21:30:32 jlam Exp $
#

DISTNAME=	teTeX-texmf-1.0.2
PKGNAME=	teTeX-share-1.0.2
PKGREVISION=	2
CATEGORIES=	print
MASTER_SITES=	${MASTER_SITE_TEX_CTAN:=systems/unix/teTeX/1.0/distrib/sources/}

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	http://www.tug.org/tetex/
COMMENT=	Machine-independent part of teTeX

CONFLICTS+=	teTeX2-share-[2-9]*
CONFLICTS+=	teTeX-texmf-[0-9]*

WRKSRC=		${WRKDIR}
DIST_SUBDIR=	teTeX
EXTRACT_ONLY=	# empty
NO_CONFIGURE=	yes
NO_BUILD=	yes
NO_MTREE=	yes
USE_TOOLS+=	patch

EXTRA_PATCH=	${FILESDIR}/latex.ltx.diff

# Don't extract the files listed in ${FILESDIR}/exclude, and preserve
# permissions.
#
EXTRACT_OPTS=		-X ${FILESDIR:Q}/exclude

do-install:
	${INSTALL_DATA_DIR} ${PREFIX:Q}/share/texmf
	extract_file=${DISTDIR:Q}/${DIST_SUBDIR:Q}/${DISTFILES:Q} && cd ${PREFIX:Q}/share/texmf && ${EXTRACT_CMD}

post-install:
	@cd ${PREFIX:Q}/share/texmf/tex/latex/base && \
	  ${PATCH} ${_PATCH_BACKUP_ARG} .orig < ${EXTRA_PATCH:Q} && \
	  ${RM} latex.ltx.orig
	${CP} ${FILESDIR:Q}/dvipdfm.def ${PREFIX:Q}/share/texmf/tex/latex/graphics

.include "../../mk/bsd.pkg.mk"
