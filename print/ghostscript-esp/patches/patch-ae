$NetBSD: patch-ae,v 1.1 2002/10/24 20:08:23 bouyer Exp $

--- configure.ac.orig	Thu Sep  5 22:59:05 2002
+++ configure.ac	Thu Oct 24 20:50:28 2002
@@ -400,7 +400,7 @@
 	if test "x$CUPSCONFIG" != x; then
 	    dnl Use values from CUPS config...
 #	    LIBS="`$CUPSCONFIG --ldflags` `$CUPSCONFIG --static --image --libs | sed -e '1,$s/-lssl//'` $LIBS"
-	    LIBS="`$CUPSCONFIG --ldflags` `$CUPSCONFIG --image --libs` $LIBS"
+	    LIBS="`$CUPSCONFIG --image --libs` $LIBS"
 	    CFLAGS="`$CUPSCONFIG --cflags` $CFLAGS"
 	    cups_serverroot="`$CUPSCONFIG --serverroot`"
 	    cups_serverbin="`$CUPSCONFIG --serverbin`"
@@ -558,6 +558,8 @@
 
 	SAVELIBS="$LIBS"
 
+	AC_CHECK_LIB(ICE,IceConnectionNumber)
+	AC_CHECK_LIB(SM,SmcClientID)
 	AC_CHECK_LIB(X11,XOpenDisplay)
 	AC_CHECK_LIB(Xext,XdbeQueryExtension)
 	AC_CHECK_LIB(Xt,XtAppCreateShell)
@@ -566,7 +568,11 @@
 
 	if test "$ac_cv_lib_Xt_XtAppCreateShell" = yes; then
 		X_DEVS="\$(DD)x11.dev \$(DD)x11alpha.dev \$(DD)x11cmyk.dev \$(DD)x11mono.dev \$(DD)x11_.dev \$(DD)x11alt_.dev \$(DD)x11cmyk2.dev \$(DD)x11cmyk4.dev \$(DD)x11cmyk8.dev \$(DD)x11rg16x.dev \$(DD)x11rg32x.dev \$(DD)x11gray2.dev \$(DD)x11gray4.dev"
-		X_LIBS="-lXt -lXext -lX11"
+		if test "$ac_cv_lib_SM_SmcClientID" = yes; then
+			X_LIBS="-lXt -lXext -lX11 -lSM -lICE"
+		else
+			X_LIBS="-lXt -lXext -lX11"
+		fi
 	fi
 fi
 
