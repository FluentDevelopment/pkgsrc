$NetBSD: patch-ag,v 1.1 2005/11/17 16:56:39 joerg Exp $

--- src/Unix/sigsegv.cpp.orig	2005-11-17 14:27:36.000000000 +0000
+++ src/Unix/sigsegv.cpp
@@ -226,7 +226,7 @@ static void powerpc_decode_instruction(i
 
 #if HAVE_SIGINFO_T
 // Generic extended signal handler
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 #define SIGSEGV_ALL_SIGNALS				FAULT_HANDLER(SIGBUS)
 #else
 #define SIGSEGV_ALL_SIGNALS				FAULT_HANDLER(SIGSEGV)
@@ -257,7 +257,7 @@ static void powerpc_decode_instruction(i
 #define SIGSEGV_SKIP_INSTRUCTION		sparc_skip_instruction
 #endif
 #endif
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 #if (defined(i386) || defined(__i386__))
 #define SIGSEGV_FAULT_INSTRUCTION		(((struct sigcontext *)scp)->sc_eip)
 #define SIGSEGV_REGISTER_FILE			((unsigned long *)&(((struct sigcontext *)scp)->sc_edi)) /* EDI is the first GPR (even below EIP) in sigcontext */
@@ -444,7 +444,7 @@ static sigsegv_address_t get_fault_addre
 #define SIGSEGV_ALL_SIGNALS				FAULT_HANDLER(SIGSEGV)
 #endif
 #endif
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 #if (defined(i386) || defined(__i386__))
 #define SIGSEGV_ALL_SIGNALS				FAULT_HANDLER(SIGBUS)
 #define SIGSEGV_FAULT_HANDLER_ARGLIST	int sig, int code, struct sigcontext *scp, char *addr
@@ -715,7 +715,7 @@ enum {
 #endif
 };
 #endif
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 enum {
 #if (defined(i386) || defined(__i386__))
 	X86_REG_EIP = 10,
