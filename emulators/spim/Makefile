# $NetBSD: Makefile,v 1.30 2006/04/22 09:22:08 rillig Exp $

DISTNAME=	spim-7.1
PKGREVISION=	2
CATEGORIES=	emulators
MASTER_SITES=	http://www.cs.wisc.edu/~larus/SPIM/ \
		ftp://ftp.cs.wisc.edu/pub/spim/

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	http://www.cs.wisc.edu/~larus/spim.html
COMMENT=	MIPS R2000 Simulator

RESTRICTED=		selling is not allowed
NO_SRC_ON_CDROM=	${RESTRICTED}
NO_BIN_ON_CDROM=	${RESTRICTED}

#DIST_SUBDIR=		${PKGNAME}

WRKSRC=			${WRKDIR}/${PKGNAME_NOREV}
HAS_CONFIGURE=		yes
CONFIGURE_SCRIPT=	./Configure
USE_IMAKE=		yes
USE_TOOLS+=		gzip lex
XMKMF=			${X11BASE}/bin/xmkmf # don't specify -a option

BUILD_TARGET=		y.tab.c depend spim xspim

pre-configure:
	@${RM} -f ${WRKSRC}/y.tab.*

pre-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/spim
	${CHMOD} a+rx ${PREFIX}/share/spim

post-install:
	@${ECHO} "Installing spim/xspim documentation"
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/spim \
		&& ${CHMOD} a+rx ${PREFIX}/share/doc/spim
	${INSTALL_DATA} ${WRKSRC}/Documentation/spim.tex \
		${PREFIX}/share/doc/spim
	${INSTALL_DATA} ${WRKSRC}/Documentation/*.id \
		${PREFIX}/share/doc/spim
	${INSTALL_DATA} ${WRKSRC}/Documentation/cycle.ps \
		${PREFIX}/share/doc/spim

.include "../../mk/bsd.pkg.mk"
