$NetBSD: patch-ab,v 1.2 2003/06/10 09:54:42 wiz Exp $

--- ../dist/configure.orig	Thu Dec 19 17:55:03 2002
+++ ../dist/configure
@@ -4696,6 +4696,7 @@ db_cv_gxx_except=no;
 if test "$GXX" = "yes"; then
 	GXX_VERSION=`${MAKEFILE_CXX} --version`
 	case ${GXX_VERSION} in
+	egcs*)  CXXFLAGS="-fexceptions $CXXFLAGS";;
 	1.*|2.[01234567].*|*-1.*|*-2.[01234567].*)
 		db_cv_gxx_except=yes;;
 	esac
@@ -9477,7 +9478,7 @@ echo $ECHO_N "checking SOSUFFIX from lib
 	release=""
 	libname=libfoo
 	eval library_names=\"$library_names_spec\"
-	_SOSUFFIX=`echo "$library_names" | sed -e 's/.*\.\([a-zA-Z0-9_]*\).*/\1/'`
+	_SOSUFFIX=`./libtool --config | sed -e '/^library_names_spec=/!d' -e 's/.*\.\([a-zA-Z0-9_]*\).*/\1/'`
 	if test "$_SOSUFFIX" = '' ; then
 		_SOSUFFIX=so
 		if test "$enable_shared" = "yes" && test "$_SOSUFFIX_MESSAGE" = ""; then
@@ -9552,7 +9553,7 @@ echo "${ECHO_T}$JMODSUFFIX" >&6
 INSTALLER="\$(LIBTOOL) --mode=install cp -p"
 
 MAKEFILE_CC="\$(LIBTOOL) --mode=compile ${MAKEFILE_CC}"
-MAKEFILE_SOLINK="\$(LIBTOOL) --mode=link ${MAKEFILE_CCLINK} -avoid-version"
+MAKEFILE_SOLINK="\$(LIBTOOL) --mode=link ${MAKEFILE_CCLINK}"
 MAKEFILE_CCLINK="\$(LIBTOOL) --mode=link ${MAKEFILE_CCLINK}"
 MAKEFILE_CXX="\$(LIBTOOL) --mode=compile ${MAKEFILE_CXX}"
 MAKEFILE_XSOLINK="\$(LIBTOOL) --mode=link ${MAKEFILE_CXXLINK} -avoid-version"
@@ -9974,7 +9975,7 @@ _ACEOF
 
 
 	RPC_CLIENT_OBJS="\$(RPC_CLIENT_OBJS)"
-	ADDITIONAL_PROGS="berkeley_db_svc $ADDITIONAL_PROGS"
+	ADDITIONAL_PROGS="berkeley_db4_svc $ADDITIONAL_PROGS"
 
 	EMBEDIX_ECD_RPC="/usr/bin/berkeley_db_svc"
 
