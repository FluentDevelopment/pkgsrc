$NetBSD: patch-ac,v 1.3 2006/04/02 22:48:31 wiz Exp $

--- testing/test-dyn-widgets.c.orig	2006-03-10 16:55:13.000000000 +0000
+++ testing/test-dyn-widgets.c
@@ -1,7 +1,7 @@
 #include <glib/gi18n-lib.h>
 #include <libgnomedb/libgnomedb.h>
 #include <gtk/gtk.h>
-#include <linux/unistd.h>
+#include <unistd.h>
 
 #define SQL_QUERY_ROWS "SELECT c.name, o.creation_date FROM orders o INNER JOIN customers c ON (c.id=o.customer) ORDER BY c.name, o.creation_date"
 #define SQL_QUERY_COLS "SELECT p.name, p.price FROM products p ORDER BY p.name, p.price"
@@ -735,7 +735,8 @@ conn_open (MainConfig *config)
 		if (use_local_db) {
 			/* use a local SQLite database */
 			gchar *dir, *str;
-			dir = get_current_dir_name ();
+			if ((dir=getcwd(NULL, 0)) == NULL)
+				exit(1);
 			str = g_build_filename (dir, "TEST_sqlite.db", NULL);
 			free (dir);
 			dir = g_strdup_printf ("URI=%s", str);
