$NetBSD: patch-aa,v 1.6 2001/10/25 16:19:35 tron Exp $

--- build/mod.mk.orig	Wed Oct  4 17:21:30 2000
+++ build/mod.mk	Thu Oct 25 17:02:15 2001
@@ -10,10 +10,14 @@
 LIBRARY = $(LIBBASE).la
 LIBSTAT = lib$(LIBBASE).a
 
-LTFLAGS = --only-$(LINKAGE)
+.if ($(LINKAGE) == static)
+LTFLAGS = -static
+.else
+LTFLAGS =
+.endif
 
-COMPILE = $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) $(CFLAGS) $(MODDEFS) -c
-LTLIBLINK = $(LIBTOOL) $(LTFLAGS) --mode=link $(CC) -rpath $(moduledir) \
+COMPILE = $(LIBTOOL) --mode=compile $(CC) $(LTFLAGS) $(CFLAGS) $(MODDEFS) -c
+LTLIBLINK = $(LIBTOOL) --mode=link $(CC) $(LTFLAGS) -rpath $(moduledir) \
 	$(CFLAGS) $(LDFLAGS) $(LTVERSION) $(LT_NO_UNDEF)
 
 MKDEPFLAG = -l
