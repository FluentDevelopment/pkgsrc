$NetBSD: patch-ac,v 1.3 2004/02/26 16:25:52 cube Exp $

--- configure.in.orig	2003-12-05 09:15:58.000000000 +0100
+++ configure.in
@@ -266,7 +266,7 @@ dnl Checks for header files.
 AC_CHECK_HEADERS(dirent.h fcntl.h fnmatch.h stat.h stdlib.h string.h)
 AC_CHECK_HEADERS(time.h types.h unistd.h)
 AC_CHECK_HEADERS(sys/dir.h sys/stat.h sys/times.h sys/types.h)
-
+AC_CHECK_HEADERS(pty.h util.h sched.h)
 
 dnl Checks for typedefs, structures, and compiler characteristics.
 AC_CYGWIN
@@ -399,21 +399,33 @@ fi
 dnl -----------------------------
 dnl Checks for FreeBSD Build
 dnl -----------------------------
-AC_MSG_CHECKING(if building on FreeBSD)
+dnl AC_MSG_CHECKING(if building on FreeBSD)
 
-if test `uname -s` = "FreeBSD" ; then
-        AC_MSG_RESULT(yes)
-        FREEBSD_BUILD=-DFREEBSD
-        AC_SUBST(FREEBSD_BUILD)
-	AC_PATH_PROG(GMAKE, gmake, no)
-	if test "x$GMAKE" = "xno"; then
+dnl if test `uname -s` = "FreeBSD" ; then
+dnl         AC_MSG_RESULT(yes)
+dnl         FREEBSD_BUILD=-DFREEBSD
+dnl         AC_SUBST(FREEBSD_BUILD)
+dnl 	AC_PATH_PROG(GMAKE, gmake, no)
+dnl 	if test "x$GMAKE" = "xno"; then
+dnl 		AC_ERROR(You need gmake installed to build Anjuta!)
+dnl 	fi
+dnl else
+dnl         AC_MSG_RESULT(no)
+dnl 	GMAKE="make"
+dnl fi
+
+AC_CHECK_FUNCS(getline)
+FREEBSD_BUILD=
+AC_SUBST(FREEBSD_BUILD)
+
+AC_PATH_PROG(GMAKE, gmake, no)
+if test "x$GMAKE" = "xno"; then
+	if (make -v | grep GNU) 2>&1 1>/dev/null; then
+		GMAKE="make"
+	else
 		AC_ERROR(You need gmake installed to build Anjuta!)
 	fi
-else
-        AC_MSG_RESULT(no)
-	GMAKE="make"
 fi
-
 AC_SUBST(GMAKE)
  
 dnl Checks for missing prototypes
