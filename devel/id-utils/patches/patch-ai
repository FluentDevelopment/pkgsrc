$NetBSD: patch-ai,v 1.1 2001/09/19 08:57:07 joda Exp $

--- src/lid.c~	Wed Sep 19 10:03:44 2001
+++ src/lid.c	Wed Sep 19 10:38:49 2001
@@ -34,7 +34,6 @@
 #include "xstring.h"
 #include "error.h"
 #include "pathmax.h"
-#include "xalloca.h"
 #if HAVE_LIMITS_H
 # include <limits.h>
 #endif
@@ -557,7 +556,7 @@
   line[0] = ' ';		/* sentry */
   while (*flinkv)
     {
-      char *file_name = ALLOCA (char, PATH_MAX);
+      char file_name[PATH_MAX];
       FILE *gid_FILE;
 
       maybe_relative_file_name (file_name, *flinkv++, cw_dlink);
@@ -569,7 +568,7 @@
         }
 
       line_number = 0;
-      while (fgets (&line[1], sizeof (line), gid_FILE))
+      while (fgets (&line[1], sizeof (line) - 1, gid_FILE))
 	{
 	  line_number++;
 	  if (pattern)
@@ -768,7 +767,7 @@
 
   for (count = 0; *flinkv; count++, flinkv++)
     {
-      char *file_name = ALLOCA (char, PATH_MAX);
+      char file_name[PATH_MAX];
       maybe_relative_file_name (file_name, *flinkv, cw_dlink);
       if (strcasestr (file_name, pattern))
 	return count;
