$NetBSD: patch-am,v 1.1 2006/07/12 16:30:04 rillig Exp $

Prevent an endless recursion, resulting in a segmentation fault.

--- mozilla/security/nss/lib/freebl/loader.c.orig	2006-07-12 18:03:20.000000000 +0200
+++ mozilla/security/nss/lib/freebl/loader.c	2006-07-12 18:02:55.000000000 +0200
@@ -39,6 +39,9 @@
  * ***** END LICENSE BLOCK ***** */
 /* $Id: patch-am,v 1.1 2006/07/12 16:30:04 rillig Exp $ */

+#undef NDEBUG
+#include <assert.h>
+
 #include "loader.h"
 #include "prmem.h"
 #include "prerror.h"
@@ -926,6 +928,7 @@ RNG_RNGInit(void)
 {
   if (!vector && PR_SUCCESS != freebl_RunLoaderOnce())
       return SECFailure;
+  assert(vector->p_RNG_RNGInit != RNG_RNGInit);
   return (vector->p_RNG_RNGInit)();
 }
 
