$NetBSD: patch-aa,v 1.6 2005/06/14 03:02:29 jschauma Exp $

--- cdecl.c.orig	Mon Jan 15 21:54:46 1996
+++ cdecl.c
@@ -59,7 +59,9 @@
  */
 
 char cdeclsccsid[] = "@(#)cdecl.c	2.5 1/15/96";
-
+
+#include <sys/param.h>
+
 #include <stdio.h>
 #include <ctype.h>
 #if __STDC__ || defined(DOS)
@@ -71,11 +73,12 @@ char cdeclsccsid[] = "@(#)cdecl.c	2.5 1/
 # ifndef NOVARARGS
 #  include <varargs.h>
 # endif /* ndef NOVARARGS */
+#if !(defined(__sun__) && defined(__svr4__)) && !(defined(BSD) && (BSD >= 199306))
 char *malloc();
 void free(), exit(), perror();
+#endif
 # ifdef BSD
 #  include <strings.h>
-   extern int errno;
 #  define strrchr rindex
 #  define NOTMPFILE
 # else
@@ -87,6 +90,10 @@ void free(), exit(), perror();
 # endif /* NOVOID */
 #endif /* __STDC__ || DOS */
 
+#if defined(__svr4__) && defined(__sun__) || defined(__NetBSD__) || defined(__APPLE__) || defined(__sgi)
+#include <errno.h>
+#endif
+
 #ifdef USE_READLINE
 # include <readline/readline.h>
   /* prototypes for functions related to readline() */
@@ -124,7 +131,11 @@ char real_prompt[MAX_NAME+3];
 
 #if __STDC__
   char *ds(char *), *cat(char *, ...), *visible(int);
+#if !(defined(BSD) && BSD >= 199306) && \
+	!(defined(__sun__) && defined(__svr4__)) && \
+	!(defined(__linux__))
   int getopt(int,char **,char *);
+#endif
   int main(int, char **);
   int yywrap(void);
   int dostdin(void);
@@ -138,7 +149,7 @@ char real_prompt[MAX_NAME+3];
   void docast(char*, char*, char*, char*);
   void dodexplain(char*, char*, char*, char*);
   void docexplain(char*, char*, char*, char*);
-  void setprogname(char *);
+  void mysetprogname(char *);
   int dotmpfile(int, char**), dofileargs(int, char**);
 #else
   char *ds(), *cat(), *visible();
@@ -148,7 +159,7 @@ char real_prompt[MAX_NAME+3];
   void unsupp(), notsupported();
   void yyerror();
   void doset(), dodeclare(), docast(), dodexplain(), docexplain();
-  void setprogname();
+  void mysetprogname();
   int dotmpfile(), dofileargs();
 #endif /* __STDC__ */
   FILE *tmpfile();
@@ -803,7 +814,7 @@ void prompt()
 }
 
 /* Save away the name of the program from argv[0] */
-void setprogname(argv0)
+void mysetprogname(argv0)
 char *argv0;
 {
 #ifdef DOS
@@ -1255,7 +1266,7 @@ char **argv;
     rl_completion_entry_function = (Function *)keyword_completion;
 #endif
 
-    setprogname(argv[0]);
+    mysetprogname(argv[0]);
 #ifdef DOS
     if (strcmp(progname, "cppdecl") == 0)
 #else
