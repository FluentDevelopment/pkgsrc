$NetBSD: patch-ae,v 1.2 2005/11/03 23:58:41 agc Exp $

--- src/Makefile	8 Oct 2005 22:21:15 -0000	1.1.1.1
+++ src/Makefile	8 Oct 2005 22:24:25 -0000	1.2
@@ -3,7 +3,6 @@
 # Compiler Flags. Warning: -O causes problems w/ pthread
 #
 
-SRC = /usr/src/linux
 INCLUDE = ../include
 BIN = ../bin
 CFLAGS = -g -O2
@@ -14,9 +13,9 @@
 
 CFLAGS_KERN = $(CFLAGS) -D__KERNEL__ -DMODULE -I$(SRC)/include -I$(SRC)/drivers/scsi
 
-ifeq ($(shell grep 'define CONFIG_MODVERSIONS' $(SRC)/include/linux/autoconf.h | wc -l | sed 's/ //g'),1)
-CFLAGS_KERN += -DMODVERSIONS -include $(SRC)/include/linux/modversions.h
-endif
+#ifeq ($(shell grep 'define CONFIG_MODVERSIONS' $(SRC)/include/linux/autoconf.h | wc -l | sed 's/ //g'),1)
+#CFLAGS_KERN += -DMODVERSIONS -include $(SRC)/include/linux/modversions.h
+#endif
 
 #
 # Compilation Targets
@@ -67,8 +66,10 @@
 #
 
 USER_TARGET_OBJS = utarget.o target.o iscsi.o util.o parameters.o
-uosd: osd.o $(USER_TARGET_OBJS)
+$(BIN)/uosd: osd.o $(USER_TARGET_OBJS)
 	$(CC) $(CFLAGS) osd.o $(USER_TARGET_OBJS) -lpthread -o $(BIN)/uosd
+uosd: osd.o $(USER_TARGET_OBJS)
+	$(CC) $(CFLAGS) osd.o $(USER_TARGET_OBJS) -lpthread -o uosd
 $(BIN)/uramdisk: disk.c $(USER_TARGET_OBJS)
 	$(CC) $(CFLAGS) -DCONFIG_DISK_RAMDISK disk.c $(USER_TARGET_OBJS) -lpthread -o $(BIN)/uramdisk
 $(BIN)/ufsdisk: disk.c $(USER_TARGET_OBJS)
