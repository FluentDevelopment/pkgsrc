$NetBSD: patch-aa,v 1.6 2004/10/09 14:01:03 mjl Exp $

--- make/unix.mak.orig	2004-09-01 01:52:31.000000000 +0200
+++ make/unix.mak	2004-10-09 12:52:29.000000000 +0200
@@ -122,13 +122,13 @@
 #
 
 ifndef PWLIBDIR
-PWLIBDIR = $(HOME)/pwlib
+PWLIBDIR = /usr/pkg
 endif
 
 ####################################################
 
 # include generated build options file, then include it
-include $(PWLIBDIR)/make/ptbuildopts.mak
+include $(PWLIBDIR)/share/pwlib/make/ptbuildopts.mak
 
 ###############################################################################
 #
@@ -427,9 +427,9 @@
 
 ifeq ($(OSTYPE),OpenBSD)
 
-ifeq ($(MACHTYPE),x86)
-STDCCFLAGS	+= -m486
-endif
+# ifeq ($(MACHTYPE),x86)
+# STDCCFLAGS	+= -m486
+# endif
 
 LDLIBS		+= -lossaudio
 
@@ -444,13 +444,9 @@
 
 ifeq ($(OSTYPE),NetBSD)
 
-ifeq ($(MACHTYPE),x86)
-STDCCFLAGS	+= -m486
-endif
-
 LDLIBS		+= -lossaudio
 
-STDCCFLAGS += -I$(UNIX_INC_DIR) -I$(PWLIBDIR)/include
+STDCCFLAGS += -I$(PWLIBDIR)/include
 
 # enable the USE_PTH line to compile using pth
 # enable the USE_NATIVE_THREADS line to compile using native threads
@@ -832,13 +828,14 @@
 endif
 
 ifeq ($(P_SHAREDLIB),1)
-LIB_SUFFIX	= $(SHAREDLIBEXT)
+LIB_SUFFIX	= la
 LIB_TYPE	=
 else   
 LIB_SUFFIX	= a 
-LIB_TYPE	= _s
+LIB_TYPE	= 
 endif # P_SHAREDLIB
 
+INSTALL_DIR = ${PREFIX}
 ifndef INSTALL_DIR
 INSTALL_DIR	= /usr/local
 endif
@@ -865,11 +862,11 @@
 
 # Directories
 
-ifdef PREFIX
-UNIX_INC_DIR	= $(PREFIX)/include/ptlib/unix
-else
+#ifdef PREFIX
+#UNIX_INC_DIR	= $(PREFIX)/include/ptlib/unix
+#else
 UNIX_INC_DIR	= $(PWLIBDIR)/include/ptlib/unix
-endif
+#endif
 
 ifndef UNIX_SRC_DIR
 UNIX_SRC_DIR	= $(PWLIBDIR)/src/ptlib/unix
@@ -878,7 +875,7 @@
 PW_LIBDIR	= $(PWLIBDIR)/lib
 
 # set name of the PT library
-PTLIB_BASE	= pt_$(PLATFORM_TYPE)_$(OBJ_SUFFIX)
+PTLIB_BASE	= pt
 PTLIB_FILE	= lib$(PTLIB_BASE)$(LIB_TYPE).$(LIB_SUFFIX)
 PT_OBJBASE	= obj_$(PLATFORM_TYPE)_$(OBJDIR_SUFFIX)
 PT_OBJDIR	= $(PW_LIBDIR)/$(PT_OBJBASE)
@@ -946,6 +943,6 @@
 # add library directory to library path and include the library
 LDFLAGS		+= -L$(PW_LIBDIR)
 
-LDLIBS		+= -l$(PTLIB_BASE)$(LIB_TYPE)
+LDLIBS		+= $(PW_LIBDIR)/$(PTLIB_FILE)
 
 # End of unix.mak
