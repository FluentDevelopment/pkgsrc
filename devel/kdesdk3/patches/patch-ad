$NetBSD: patch-ad,v 1.3 2005/01/02 21:59:23 markd Exp $

--- kbabel/kbabeldict/modules/dbsearchengine/database.cpp.orig	2005-01-03 00:39:59.000000000 +1300
+++ kbabel/kbabeldict/modules/dbsearchengine/database.cpp
@@ -728,7 +728,11 @@ int
 DataBaseManager::count ()
 {
     DB_BTREE_STAT *dstat = 0;
+#if DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 3
+    db->stat (db, NULL, &dstat, DB_FAST_STAT);
+#else
     db->stat (db, &dstat, DB_FAST_STAT);
+#endif
     int ret = dstat->bt_nkeys;
     free (dstat);
 
@@ -963,8 +967,13 @@ DataBaseManager::loadInfo ()
     int nrec;
     DB_BTREE_STAT *stat;
 // memset(&stat,0,sizeof(DB_BTREE_STAT));
+#if DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 3
+    if (infoDb->stat (infoDb, NULL, &stat, DB_FAST_STAT))
+        fprintf (stderr, "Cannot stat\n");
+#else
     if (infoDb->stat (infoDb, &stat, DB_FAST_STAT))
 	fprintf (stderr, "Cannot stat\n");
+#endif
     nrec = stat->bt_nkeys;
     free (stat);
 
