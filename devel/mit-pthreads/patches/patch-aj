$NetBSD: patch-aj,v 1.10 2002/07/18 09:08:28 agc Exp $

--- config/configure	2002/07/18 08:54:37	1.1
+++ config/configure	2002/07/18 08:54:54
@@ -1049,6 +1049,17 @@
 name=$host_cpu-$host_os
 
 case $host in
+    alpha-*-netbsd1.3[H-Z]|alpha-*-netbsd1.[456789]*) 
+	name=alpha-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="fork lseek pipe fstat"
+	available_syscalls="sigsuspend sigprocmask"
+	;;
+    alpha-*-netbsd1.3*) 
+	name=alpha-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="fork lseek pipe sigsuspend sigprocmask fstat"
+	;;
     alpha-*-netbsd1.1* | alpha-*-netbsd1.2*)
 	name=alpha-netbsd-1.1
 	sysincludes=netbsd-1.1
@@ -1062,12 +1073,29 @@
 	  CFLAGS="$CFLAGS -std"
 	fi
 	;;
+    arm32-*-netbsd1.3[H-Z]|arm32-*-netbsd1.[456789]*)
+	name=arm32-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="fork pipe lseek ftruncate fstat"
+	available_syscalls="sigsuspend sigprocmask"
+	;;
+    arm32-*-netbsd1.3*)
+	name=arm32-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="fork pipe lseek ftruncate sigsuspend sigprocmask fstat"
+	;;
     hppa1.1-*-hpux*)
 	name=hppa-hpux-9.03
 	sysincludes=hpux-9.03
 	# hpux-9.03.mk seems to be missing; what should this be?
 	except="fork"
 	;;
+    powerpc-*-netbsd1.*)
+	name=powerpc-netbsd
+ 	sysincludes=netbsd-1.1
+	except="fork lseek ftruncate pipe fstat"
+	available_syscalls="sigprocmask sigaction sigsuspend"
+	;;
     sparc-*-sunos4.1.3* | sparc-*-sunos4.1.4*)
 	name=sparc-sunos-4.1.3
 	sysincludes=sunos-4.1.3
@@ -1092,6 +1120,17 @@
 EOF
 
 	;;
+    sparc-*-netbsd1.3[H-Z]|sparc-*-netbsd1.[456789]*)
+	name=sparc-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="pipe fork lseek ftruncate fstat"
+	available_syscalls="sigprocmask sigsuspend"
+	;;
+    sparc-*-netbsd1.3*)
+	name=sparc-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="pipe fork lseek ftruncate sigprocmask sigsuspend fstat"
+	;;
 	sparc-*-netbsd1.0A | sparc-*-netbsd1.1* | sparc-*-netbsd1.2*)
     name=sparc-sunos-4.1.3
     sysincludes=netbsd-1.0
@@ -1112,6 +1151,17 @@
         syscall=i386-bsdi-2.0
         except="fork lseek sigsuspend"
 		;;
+    i386-*-netbsd1.3[H-Z]|i386-*-netbsd1.[456789]*|i386-*-netbsdelf*)
+	name=i386-netbsd-1.3
+	sysincludes=netbsd-1.1
+	except="fork lseek ftruncate pipe fstat"
+	available_syscalls="sigsuspend sigprocmask sigaction"
+		;;
+    i386-*-netbsd1.3*)
+        name=i386-netbsd-1.3
+        sysincludes=netbsd-1.1
+        except="fork lseek ftruncate pipe sigsuspend sigprocmask fstat"
+		;;
     i386-*-netbsd1.1* | i386-*-netbsd1.2*)
 	name=i386-netbsd-1.0
 	sysincludes=netbsd-1.1
@@ -1127,8 +1177,16 @@
 	name=i386-netbsd-0.9
 	sysincludes=netbsd-0.9
 	;;
-    m68*-*-netbsd*)
+    m68*-*-netbsd1.3[H-Z]|m68*-*-netbsd1.[456789]*)
 	name=m68000-netbsd
+	sysincludes=netbsd-1.1
+	except="lseek ftruncate pipe fstat"
+	available_syscalls="sigsuspend sigprocmask"
+	;;
+    m68*-*-netbsd1.3*)
+	name=m68000-netbsd
+	sysincludes=netbsd-1.1
+	except="lseek ftruncate pipe fstat sigsuspend sigprocmask"
 	;;
     i386-*-freebsd2.*)
         name=i386-freebsd-2.0
@@ -1697,6 +1755,39 @@
 if test $pthreads_cv_timespec_in_time = yes ; then
   cat >> confdefs.h <<\EOF
 #define _OS_HAS_TIMESPEC 1
+EOF
+
+fi
+
+echo $ac_n "checking for socklen_t""... $ac_c" 1>&6
+if eval "test \"`echo '$''{'pthreads_cv_socklen_t'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1678 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#include <sys/socket.h>
+int main() { return 0; }
+int t() {
+socklen_t foo;
+; return 0; }
+EOF
+if { (eval echo configure:1686: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  pthreads_cv_socklen_t=yes
+else
+  rm -rf conftest*
+  pthreads_cv_socklen_t=no
+fi
+rm -f conftest*
+
+fi
+
+echo "$ac_t""$pthreads_cv_socklen_t" 1>&6
+if test $pthreads_cv_socklen_t = yes ; then
+  cat >> confdefs.h <<\EOF
+#define _OS_HAS_SOCKLEN_T 1
 EOF
 
 fi
