$NetBSD: patch-at,v 1.5 2002/11/24 21:31:25 hubertf Exp $

--- src/logmsg.c.orig	Fri Sep 14 19:12:10 2001
+++ src/logmsg.c
@@ -298,7 +298,7 @@
     run_setup (editinfo_editor ? editinfo_editor : Editor);
     run_arg (fname);
     if ((retcode = run_exec (RUN_TTY, RUN_TTY, RUN_TTY,
-			     RUN_NORMAL | RUN_SIGIGNORE)) != 0)
+			     RUN_NORMAL | RUN_SIGIGNORE | RUN_UNSETXID)) != 0)
 	error (editinfo_editor ? 1 : 0, retcode == -1 ? errno : 0,
 	       editinfo_editor ? "Logfile verification failed" :
 	       "warning: editor session failed");
@@ -686,6 +686,15 @@
 			xrealloc (str_list,
 				  strlen (str_list) + strlen (p->key) + 5);
 		    (void) strcat (str_list, p->key);
+		    break;
+		case 't':
+		    str_list =
+			xrealloc (str_list,
+				  (strlen (str_list)
+				   + (li->tag ? strlen (li->tag) : 0)
+				   + 10)
+				  );
+		    (void) strcat (str_list, (li->tag ? li->tag : ""));
 		    break;
 		case 'V':
 		    str_list =
