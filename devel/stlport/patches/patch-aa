$NetBSD: patch-aa,v 1.3 2002/09/30 23:33:54 jlam Exp $

--- src/gcc-libtool.mak.orig	Mon Sep 30 15:55:13 2002
+++ src/gcc-libtool.mak
@@ -0,0 +1,88 @@
+#
+# Note : this makefile is for gcc-2.95 and later !
+#
+
+#
+# compiler
+#
+#LIBTOOL = libtool
+#CC = gcc
+#CXX = c++
+
+#
+# Basename for libraries
+#
+LIB_BASENAME = libstlport_gcc
+
+#
+# guts for common stuff
+#
+#
+LINK=$(LIBTOOL) $(CXX) -rpath $(PREFIX)/lib -version-info 0:0 -o
+
+OBJEXT=lo
+STEXT=la
+MV=mv -f
+RM=rm -rf
+PATH_SEP=/
+MKDIR=mkdir -p
+COMP=GCC$(ARCH)
+
+# libtool will handle also creating the shared library alongside the static one
+all: all_static
+
+include common_macros.mak
+
+SRCDIR = ../../..
+
+WARNING_FLAGS= -Wall -W -Wno-sign-compare -Wno-unused -Wno-uninitialized -ftemplate-depth-32
+
+CXXFLAGS_COMMON = ${CXXFLAGS} ${CPPFLAGS} -I${SRCDIR} -I${SRCDIR}/${STLPORT_DIR} ${WARNING_FLAGS}
+
+CXXFLAGS_RELEASE_static = $(CXXFLAGS_COMMON) -O2
+
+CXXFLAGS_DEBUG_static = $(CXXFLAGS_COMMON) -g
+
+CXXFLAGS_STLDEBUG_static = $(CXXFLAGS_DEBUG_static) -D__STL_DEBUG
+
+LDFLAGS_COMMON = ${LDFLAGS}
+
+LDFLAGS_RELEASE_static = ${LDFLAGS_COMMON}
+
+LDFLAGS_DEBUG_static = ${LDFLAGS_COMMON}
+
+LDFLAGS_STLDEBUG_static = ${LDFLAGS_COMMON}
+
+include common_rules.mak
+
+.SUFFIXES: .cpp .c .o .lo .so .a
+
+$(RELEASE_OBJDIR_static)/%.lo: %.cpp
+	cd $(RELEASE_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_RELEASE_static) -c $(SRCDIR)/$<
+$(RELEASE_OBJDIR_static)/%.lo: %.c
+	cd $(RELEASE_OBJDIR_static) && \
+		$(LIBTOOL) $(CC) $(CXXFLAGS_RELEASE_static) -c $(SRCDIR)/$<
+$(RELEASE_OBJDIR_static)/%.i : %.cpp
+	cd $(RELEASE_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_RELEASE_static) -E $(SRCDIR)/$<
+
+$(DEBUG_OBJDIR_static)/%.lo : %.cpp
+	cd $(DEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_DEBUG_static) -c $(SRCDIR)/$<
+$(DEBUG_OBJDIR_static)/%.lo : %.c
+	cd $(DEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CC) $(CXXFLAGS_DEBUG_static) -c $(SRCDIR)/$<
+$(DEBUG_OBJDIR_static)/%.i : %.cpp
+	cd $(DEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_DEBUG_static) -E $(SRCDIR)/$<
+
+$(STLDEBUG_OBJDIR_static)/%.lo : %.cpp
+	cd $(STLDEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_STLDEBUG_static) -c $(SRCDIR)/$<
+$(STLDEBUG_OBJDIR_static)/%.lo : %.c
+	cd $(STLDEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CC) $(CXXFLAGS_STLDEBUG_static) -c $(SRCDIR)/$<
+$(STLDEBUG_OBJDIR_static)/%.i : %.cpp
+	cd $(STLDEBUG_OBJDIR_static) && \
+		$(LIBTOOL) $(CXX) $(CXXFLAGS_STLDEBUG_static) -E $(SRCDIR)/$<
