$NetBSD: patch-ac,v 1.1 2005/01/26 14:11:34 wiz Exp $

--- tls.c.orig	2005-01-26 15:07:39.000000000 +0100
+++ tls.c
@@ -194,7 +194,8 @@ tls_client_start( SNET *sn, char *host, 
     char            *line;
     int             ntype;
     struct in_addr  addr;
-
+    int alt_ext;
+    
     if ( inet_aton( host, &addr )) {
 	ntype = IS_IP4;
     } else {
@@ -239,7 +240,7 @@ tls_client_start( SNET *sn, char *host, 
     /* This code gratiously borrowed from openldap-2.2.17,
      * it allows the use of aliases in the certificate.
      */
-    int alt_ext = X509_get_ext_by_NID( peer, NID_subject_alt_name, -1);
+    alt_ext = X509_get_ext_by_NID( peer, NID_subject_alt_name, -1);
 
     if ( alt_ext >= 0 ) {
 	X509_EXTENSION			*ex;
