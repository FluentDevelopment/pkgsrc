$NetBSD: patch-ae,v 1.6 2004/05/12 18:45:26 bouyer Exp $

--- changer-src/scsi-changer-driver.c.orig	2003-01-26 11:20:56.000000000 -0800
+++ changer-src/scsi-changer-driver.c	2004-02-23 08:44:56.000000000 -0800
@@ -1358,13 +1358,14 @@
 {
   int ret = 0;
   extern OpenFiles_T *pDev;
+  extern changer_t chg;         /* Needed for the infos about havebarcode */
 
   DebugPrint(DEBUG_INFO, SECTION_BARCODE,"##### START BarCode\n");
   DebugPrint(DEBUG_INFO, SECTION_BARCODE,"%-20s : fd %d\n", "BarCode", fd);
 
   DebugPrint(DEBUG_INFO, SECTION_BARCODE,"Ident = [%s], function = [%s]\n", pDev[fd].ident,
 	     pDev[fd].functions->ident);
-  ret = pDev[fd].functions->function_barcode(fd);
+  ret = (pDev[fd].functions->function_barcode(fd) | chg.havebarcode);
   DebugPrint(DEBUG_INFO, SECTION_BARCODE,"##### STOP BarCode (%d)\n",ret);
   return(ret);
 }
