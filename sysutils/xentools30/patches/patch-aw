$NetBSD: patch-aw,v 1.3 2007/04/28 17:14:52 bouyer Exp $

--- misc/Makefile.orig	2007-01-08 16:00:49.000000000 +0100
+++ misc/Makefile	2007-04-25 18:37:08.000000000 +0200
@@ -11,8 +11,10 @@
 
 TARGETS  = xenperf xc_shadow
 
-INSTALL_BIN  = $(TARGETS) xencons
-INSTALL_SBIN = netfix xm xen-bugtool xend xenperf
+INSTALL_BIN  = $(TARGETS)
+INSTALL_BIN_SCRIPT  = xencons
+INSTALL_SBIN = xenperf
+INSTALL_SBIN_SCRIPT = netfix xm xen-bugtool xend
 
 .PHONY: all
 all: build
@@ -24,11 +26,13 @@
 
 .PHONY: install
 install: build
-	[ -d $(DESTDIR)/usr/bin ] || $(INSTALL_DIR) $(DESTDIR)/usr/bin
-	[ -d $(DESTDIR)/usr/sbin ] || $(INSTALL_DIR) $(DESTDIR)/usr/sbin
-	$(INSTALL_PROG) $(INSTALL_BIN) $(DESTDIR)/usr/bin
-	$(INSTALL_PROG) $(INSTALL_SBIN) $(DESTDIR)/usr/sbin
-	$(MAKE) -C lomount install
+	$(BSD_INSTALL_PROGRAM_DIR) $(PREFIX)/bin
+	$(BSD_INSTALL_PROGRAM_DIR) $(PREFIX)/sbin
+	$(BSD_INSTALL_PROGRAM) $(INSTALL_BIN) $(PREFIX)/bin
+	$(BSD_INSTALL_SCRIPT) $(INSTALL_BIN_SCRIPT) $(PREFIX)/bin
+	$(BSD_INSTALL_PROGRAM) $(INSTALL_SBIN) $(PREFIX)/sbin
+	$(BSD_INSTALL_SCRIPT) $(INSTALL_SBIN_SCRIPT) $(PREFIX)/sbin
+#	$(MAKE) -C lomount install
 #       No sense in installing miniterm on the Xen box.
 #	$(MAKE) -C miniterm install
 
@@ -42,4 +46,4 @@
 	$(CC) -c $(CFLAGS) -o $@ $<
 
 $(TARGETS): %: %.o Makefile
-	$(CC) $(CFLAGS) -o $@ $< -L$(XEN_LIBXC) -lxenctrl
+	$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS) -L$(XEN_LIBXC) -lxenctrl
