$NetBSD: patch-ak,v 1.6 2004/09/21 16:45:47 jmmv Exp $

--- libgnomevfs/gnome-vfs-cdrom.c.orig	2004-09-02 14:34:00.000000000 +0200
+++ libgnomevfs/gnome-vfs-cdrom.c
@@ -89,8 +89,9 @@ _gnome_vfs_get_cdrom_type (const char *v
 	}
 
 	return type;
-#elif defined(HAVE_SYS_MNTCTL_H)
-	return CDS_NO_INFO;
+#elif defined(__linux__)
+	*fd = open (vol_dev_path, O_RDONLY|O_NONBLOCK);
+	return ioctl (*fd, CDROM_DISC_STATUS, CDSL_CURRENT);
 #elif defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
 	struct ioc_toc_header header;
 #if defined(__FreeBSD__) || defined(__DragonFly__)
