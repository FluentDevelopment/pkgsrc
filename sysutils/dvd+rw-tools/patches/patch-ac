$NetBSD: patch-ac,v 1.4 2006/03/22 15:26:30 joerg Exp $

--- growisofs.c.orig	2006-01-16 12:09:41.000000000 +0100
+++ growisofs.c	2006-02-01 12:34:24.000000000 +0100
@@ -358,7 +358,7 @@
 # ifndef _GNU_SOURCE
 #  define _GNU_SOURCE
 # endif
-#elif defined(__OpenBSD__) || defined(__NetBSD__) || defined(__FreeBSD__)
+#elif defined(__OpenBSD__) || defined(__NetBSD__) || defined(__FreeBSD__) || defined(__DragonFly__)
 # define off64_t	off_t
 # define stat64		stat
 # define fstat64	fstat
@@ -804,7 +804,7 @@
     goto open_rw;
 }
 
-#elif defined(__FreeBSD__)
+#elif defined(__FreeBSD__) || defined(__DragonFly__)
 
 #include <sys/cdio.h>
 #include <camlib.h>
@@ -2194,9 +2194,12 @@
     nice(-20);
     /* I'd rather do it right after I allocate ring buffer and fire off
      * threads, but I'll be running without extra privileges by then:-( */
+#if !defined(__NetBSD__) && !defined(__DragonFly__)
     mlockall(MCL_CURRENT|MCL_FUTURE);
 #endif
 
+#endif
+
     mkisofs_argv = malloc ((argc+3)*sizeof(char *));
     if (mkisofs_argv == NULL)
         fprintf (stderr,":-( unable to allocate %lu bytes: ",
