$NetBSD: patch-ag,v 1.1 2005/03/21 14:44:08 tv Exp $

--- src/shred.c.orig	Wed Jan 21 17:27:02 2004
+++ src/shred.c
@@ -1398,7 +1398,11 @@ wipename (char *oldname, char const *qol
 		{
 		  if (dir_fd < 0
 		      || (fdatasync (dir_fd) < 0 && fsync (dir_fd) < 0))
+#if HAVE_SYNC
 		    sync ();	/* Force directory out */
+#else
+		    ; /* No sync(2) call */
+#endif
 		  if (flags->verbose)
 		    {
 		      /*
@@ -1431,7 +1435,11 @@ wipename (char *oldname, char const *qol
   free (newname);
   err = unlink (oldname);
   if (dir_fd < 0 || (fdatasync (dir_fd) < 0 && fsync (dir_fd) < 0))
+#if HAVE_SYNC
     sync ();
+#else
+    ; /* No sync(2) call */
+#endif
   close (dir_fd);
   if (!err && flags->verbose)
     error (0, 0, _("%s: removed"), qoldname);
