$NetBSD: patch-ao,v 1.1 2006/02/28 23:48:12 joerg Exp $

--- sysdeps/freebsd/procuid.c.orig	2004-09-23 22:44:19.000000000 +0000
+++ sysdeps/freebsd/procuid.c
@@ -91,8 +91,17 @@ glibtop_get_proc_uid_p (glibtop *server,
 #else
 #define	PROC_PRIORITY	ki_priority
 #endif
-#else
+#elif defined(__DragonFly__)
+#define	PROC_RUID	kp_eproc.e_ucred.cr_ruid
+#define	PROC_SVUID	kp_eproc.e_ucred.cr_svuid
+#define	PROC_RGID	kp_eproc.e_ucred.cr_rgid
+#define	PROC_SVGID	kp_eproc.e_ucred.cr_svgid
+#define	PROC_PPID	kp_eproc.e_ppid
+#define	PROC_PGID	kp_eproc.e_pgid
+#define	PROC_TPGID	kp_eproc.e_tpgid
+#define	PROC_NICE	kp_proc.p_nice
 
+#else
 #define	PROC_RUID	kp_eproc.e_pcred.p_ruid
 #define	PROC_SVUID	kp_eproc.e_pcred.p_svuid
 #define	PROC_RGID	kp_eproc.e_pcred.p_rgid
@@ -115,7 +124,7 @@ glibtop_get_proc_uid_p (glibtop *server,
 	buf->tpgid = pinfo [0].PROC_TPGID;
 
 	buf->nice     = pinfo [0].PROC_NICE;
-#if defined(__NetBSD__) && defined(SACTIVE)
+#if defined(__DragonFly__) || (defined(__NetBSD__) && defined(SACTIVE))
 	buf->priority = 0;
 #else
 	buf->priority = pinfo [0].PROC_PRIORITY;
