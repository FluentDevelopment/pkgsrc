$NetBSD: patch-ak,v 1.1 2006/02/28 23:48:12 joerg Exp $

--- sysdeps/freebsd/procmap.c.orig	2005-02-23 08:20:45.000000000 +0000
+++ sysdeps/freebsd/procmap.c
@@ -40,7 +40,7 @@
 #else
 #include <vm/vm_object.h>
 #include <vm/vm_map.h>
-#if (__FreeBSD_version >= 400011)
+#if defined(__DragonFly__) || (defined(__FreeBSD__) && __FreeBSD_version >= 400011)
 #include <vm/vm.h>
 #else
 #include <vm/vm_prot.h>
@@ -108,9 +108,9 @@ glibtop_get_proc_map_p (glibtop *server,
 	struct vm_object object;
 #endif
 	glibtop_map_entry *maps;
-#if defined __FreeBSD__
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 	struct vnode vnode;
-#if __FreeBSD_version < 500039
+#if (defined(__FreeBSD__) && __FreeBSD_version < 500039) || defined(__DragonFly__)
 	struct inode inode;
 #endif
 #endif
@@ -178,8 +178,8 @@ glibtop_get_proc_map_p (glibtop *server,
 			update = 1;
 		}
 
-#ifdef __FreeBSD__
-#if __FreeBSD__ >= 4
+#if defined(__FreeBSD__) || defined(__DragonFly__)
+#if (defined(__FreeBSD__) && __FreeBSD__ >= 4) || defined(__DragonFly__)
 		if (entry.eflags & (MAP_ENTRY_IS_SUB_MAP))
 			continue;
 #else
@@ -255,7 +255,7 @@ glibtop_get_proc_map_p (glibtop *server,
 #endif
 
 
-#ifdef __FreeBSD__
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 		/* If the object is of type vnode, add its size */
 
 		if (object.type != OBJT_VNODE)
