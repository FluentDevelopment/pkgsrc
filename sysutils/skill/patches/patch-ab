$NetBSD: patch-ab,v 1.10 2002/06/28 10:45:32 abs Exp $

--- main.c.orig	Sat Apr  6 05:26:01 2002
+++ main.c
@@ -46,6 +46,12 @@ const char *CopyrightVersion = "%s %s\n\
 #include <stdio.h>
 #include <errno.h>
 #include <pwd.h>
+#ifdef __NetBSD__
+# include <sys/sysctl.h>
+# ifndef KI_MAXCOMLEN	/* Pre 1.5 */
+#  define       KI_MAXCOMLEN    24
+# endif
+#endif
 
 /*
  * Processes which could not be checked -- usually due to permission
@@ -137,7 +143,7 @@ main(argc, argv)
 			for (i = 0; i < CmdIndx; i++) {
 				cmdp = (CmdList + i);
 				if ((cmdp->flags & CMD_FLAG_EXACT) != 0 &&
-						STREQU(CMD, cmdp->cmd.cmdstr))
+						STRNEQU(CMD, cmdp->cmd.cmdstr, KI_MAXCOMLEN-8))
 					break;
 				else if ((cmdp->flags & CMD_FLAG_REGEX) != 0 &&
 						RegexMatch(CMD, cmdp) != 0)
