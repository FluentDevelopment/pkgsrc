$NetBSD: patch-aa,v 1.5 2004/01/29 17:14:16 cube Exp $

--- configure.in.orig	Wed Nov 12 02:27:29 2003
+++ configure.in
@@ -74,12 +74,15 @@ then
     AC_CHECK_LIB(bz2, bzReadOpen, AC_DEFINE(NOBZ2PREFIX),)
 fi
 
-have_milter="no"
-AC_CHECK_HEADER(libmilter/mfapi.h,have_milter="yes",)
-
 AC_ARG_ENABLE(milter,
 [  --enable-milter	  Build clamav-milter (if milter library found)],
-,have_milter="no")
+want_milter=$enableval, want_milter=no)
+
+have_milter=no
+if test "$want_milter" = "yes"
+then
+	AC_CHECK_HEADER(libmilter/mfapi.h,[have_milter=yes],)
+fi
 
 want_dsig="yes"
 AC_ARG_ENABLE(dsig,
@@ -271,8 +274,12 @@ openbsd*)
     AC_DEFINE(C_BSD)
     ;;
 netbsd*)
-    AC_MSG_RESULT(NetBSD detected. Disabling thread support.)
-    have_pthreads="no"
+    if test "$have_pthreads" = "yes"; then
+    	LIBCLAMAV_LIBS="$LIBCLAMAV_LIBS -lpthread"
+	CLAMD_LIBS="-lpthread"
+	TH_SAFE="-thread-safe"
+	AC_DEFINE(CL_THREAD_SAFE)
+    fi
     AC_DEFINE(C_BSD)
     ;;
 bsd*)
