$NetBSD: patch-aa,v 1.7 2002/01/23 02:22:21 jlam Exp $

--- Makefile.in.orig	Fri Jan 18 22:19:33 2002
+++ Makefile.in
@@ -30,3 +30,3 @@
 datadir = @datadir@
-sysconfdir = @sysconfdir@
+sysconfdir = ${prefix}/share/examples/courier
 sharedstatedir = @sharedstatedir@
@@ -93,7 +93,7 @@
 databindir = $(datadir)
-databin_SCRIPTS = mkimapdcert mkpop3dcert vchkpw2userdb makeuserdb pw2userdb
+databin_SCRIPTS = mkimapdcert mkpop3dcert
 
-bin_PROGRAMS = imapd pop3d maildirmake
-sbin_PROGRAMS = imaplogin pop3login userdbpw
-man_MANS = makeuserdb.8 userdb.8 userdbpw.8 couriertcpd.1 deliverquota.8 maildirmake.1 imapd.8 mkimapdcert.8 mkpop3dcert.8
+bin_PROGRAMS = imapd pop3d
+sbin_PROGRAMS = imaplogin pop3login
+man_MANS = couriertcpd.1 courier-imapd.8 mkimapdcert.8 mkpop3dcert.8
 
@@ -109,6 +109,6 @@
 sysconf_DATA = imapd.dist imapd-ssl.dist pop3d.dist pop3d-ssl.dist \
-	imapd.cnf pop3d.cnf quotawarnmsg.example
+	imapd.cnf pop3d.cnf
 
 libexec_SCRIPTS = imapd.rc imapd-ssl.rc pop3d.rc pop3d-ssl.rc
-libexec_PROGRAMS = makedatprog couriertcpd deliverquota logger
+libexec_PROGRAMS = couriertcpd logger
 
@@ -791,4 +791,4 @@
 
-imapd.8: imap/imapd.8
-	cp imap/imapd.8 .
+courier-imapd.8: imap/imapd.8
+	cp imap/imapd.8 $@
 
@@ -818,13 +818,2 @@
 install-exec-local:
-	$(mkinstalldirs) $(DESTDIR)$(libexecdir)/authlib
-	for f in `cat authlib/installlist` dummy ; do \
-		test "$$f" = "dummy" && continue ; \
-		$(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) authlib/$$f \
-			$(DESTDIR)$(libexecdir)/authlib/$$f ; done
-	for f in `cat authlib/installlist.sh` dummy ; do \
-		test "$$f" = "dummy" && continue ; \
-		$(INSTALL_SCRIPT) authlib/$$f \
-			$(DESTDIR)$(libexecdir)/authlib/$$f ; done
-	$(mkinstalldirs) $(DESTDIR)$(datadir)
-	$(INSTALL_SCRIPT) userdb/userdb.pl $(DESTDIR)$(datadir)/userdb
 	test ! -x tcpd/couriertls || $(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) \
@@ -832,3 +821,3 @@
 	$(mkinstalldirs) $(DESTDIR)$(sbindir)
-	for f in mkimapdcert mkpop3dcert vchkpw2userdb makeuserdb pw2userdb userdb ; \
+	for f in mkimapdcert mkpop3dcert ; \
 		do rm -f $(DESTDIR)$(sbindir)/$$f ; \
@@ -837,3 +826,2 @@
 install-exec-hook:
-	chmod 444 $(DESTDIR)$(sysconfdir)/quotawarnmsg.example
 
@@ -842,30 +830,6 @@
 install-data-local: install-man
-	for f in `cat authlib/modulelist ; . authlib/authdaemonrc ; echo $$authmodulelist ` ; do \
-		test "$$f" = "authpam" || continue ; \
-		test -d $(DESTDIR)/etc/pam.d || continue ; \
-		test -w $(DESTDIR)/etc/pam.d || continue ; \
-		$(INSTALL_DATA) $(srcdir)/imap/imapd.pam \
-			$(DESTDIR)/etc/pam.d/imap || exit 1 ;\
-		$(INSTALL_DATA) $(srcdir)/imap/pop3d.pam \
-			$(DESTDIR)/etc/pam.d/pop3 || exit 1 ;\
-	done
-	rm -f $(DESTDIR)$(man8dir)/pw2userdb.8
-	rm -f $(DESTDIR)$(man8dir)/vchkpw2userdb.8
-	$(LN_S) makeuserdb.8 $(DESTDIR)$(man8dir)/pw2userdb.8
-	$(LN_S) makeuserdb.8 $(DESTDIR)$(man8dir)/vchkpw2userdb.8
-	. authlib/authdaemonrc ; test "$$authdaemonvar" = "" && exit 0; \
-		$(mkinstalldirs) $(DESTDIR)$$authdaemonvar ; \
-		chmod 700 $(DESTDIR)$$authdaemonvar
-	for f in $(man_MANS); do chmod a+r $(DESTDIR)$(mandir)/*/$$f; done
-	@cat authlib/authdaemon.msg
-	@echo "Do not forget to run make install-configure"
 
 uninstall-local:
-	rm -f $(DESTDIR)$(man8dir)/pw2userdb.8
-	rm -f $(DESTDIR)$(man8dir)/vchkpw2userdb.8
-	rm -f $(DESTDIR)$(datadir)/userdb
-	for f in userdb mkimapdcert mkpop3dcert vchkpw2userdb makeuserdb pw2userdb ; \
+	for f in mkimapdcert mkpop3dcert ; \
 		do rm -f $(DESTDIR)$(sbindir)/$$f ; done
-	for f in `cat authlib/installlist authlib/installlist.sh` ; do \
-			rm -f $(DESTDIR)$(libexecdir)/authlib/$$f ; done
 	rm -f $(DESTDIR)$(bindir)/couriertls
