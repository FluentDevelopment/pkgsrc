$NetBSD: patch-aa,v 1.8 2004/02/22 03:13:07 jlam Exp $

--- Makefile.in.orig	Thu Nov 27 15:51:57 2003
+++ Makefile.in
@@ -137,9 +137,9 @@ SUBDIRS = numlib @DBSUBDIR@ soxwrap unic
 CLEANFILES = $(databin_SCRIPTS) $(man_MANS) $(sysconf_DATA)
 databindir = $(datadir)
-databin_SCRIPTS = mkimapdcert mkpop3dcert vchkpw2userdb makeuserdb pw2userdb
+databin_SCRIPTS = mkimapdcert mkpop3dcert
 
-binPROGRAMS = imapd pop3d maildirmake deliverquota maildirkw
-sbinPROGRAMS = imaplogin pop3login userdbpw
-libexecPROGRAMS = makedatprog couriertcpd courierlogger
+binPROGRAMS = imapd pop3d
+sbinPROGRAMS = imaplogin pop3login
+libexecPROGRAMS = couriertcpd courierlogger
 
 bin_PROGRAMS = @binPROGRAMS_exec@
@@ -149,5 +149,5 @@ libexec_PROGRAMS = @libexecPROGRAMS_exec
 EXTRA_PROGRAMS = 
 
-man_MANS = makeuserdb.8 userdb.8 userdbpw.8 couriertcpd.1 deliverquota.8 maildirmake.1 imapd.8 mkimapdcert.8 mkpop3dcert.8 maildirkw.1
+man_MANS = couriertcpd.1 courier-imapd.8 mkimapdcert.8 mkpop3dcert.8
 
 
@@ -161,5 +161,5 @@ EXTRA_DIST = 00README.NOW.OR.SUFFER READ
 
 sysconf_DATA = imapd.dist imapd-ssl.dist pop3d.dist pop3d-ssl.dist \
-	imapd.cnf pop3d.cnf quotawarnmsg.example
+	imapd.cnf pop3d.cnf
 
 libexec_SCRIPTS = imapd.rc imapd-ssl.rc pop3d.rc pop3d-ssl.rc
@@ -927,6 +927,6 @@ maildirkw.1: maildir/maildirkw.1
 	cp $(srcdir)/maildir/maildirkw.1 .
 
-imapd.8: imap/imapd.8
-	cp imap/imapd.8 .
+courier-imapd.8: imap/imapd.8
+	cp imap/imapd.8 ./$@
 
 mkimapdcert: imap/mkimapdcert
@@ -954,20 +954,9 @@ quotawarnmsg.example: maildir/quotawarnm
 
 install-exec-local:
-	$(mkinstalldirs) $(DESTDIR)$(libexecdir)/authlib
-	for f in `cat authlib/installlist` dummy ; do \
-		test "$$f" = "dummy" && continue ; \
-		$(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) authlib/$$f \
-			$(DESTDIR)$(libexecdir)/authlib/$$f ; done
-	for f in `cat authlib/installlist.sh` dummy ; do \
-		test "$$f" = "dummy" && continue ; \
-		$(INSTALL_SCRIPT) authlib/$$f \
-			$(DESTDIR)$(libexecdir)/authlib/$$f ; done
-	$(mkinstalldirs) $(DESTDIR)$(databindir)
-	$(INSTALL_SCRIPT) userdb/userdb.pl $(DESTDIR)$(databindir)/userdb
 	$(mkinstalldirs) $(DESTDIR)$(bindir)
 	test ! -x tcpd/couriertls || $(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) \
 		tcpd/couriertls $(DESTDIR)$(bindir)/couriertls
 	$(mkinstalldirs) $(DESTDIR)$(sbindir)
-	for f in mkimapdcert mkpop3dcert vchkpw2userdb makeuserdb pw2userdb userdb ; \
+	for f in mkimapdcert mkpop3dcert ; \
 		do rm -f $(DESTDIR)$(sbindir)/$$f ; \
 		$(LN_S) $(databindir)/$$f $(DESTDIR)$(sbindir)/$$f ; done
@@ -975,28 +964,8 @@ install-exec-local:
 
 install-exec-hook:
-	chmod 444 $(DESTDIR)$(sysconfdir)/quotawarnmsg.example
 
 # If authlib built authpam, install the PAM configuration file
 
 install-data-local: install-man
-	for f in `cat authlib/modulelist ; . authlib/authdaemonrc ; echo $$authmodulelist ` ; do \
-		test "$$f" = "authpam" || continue ; \
-		test -d $(DESTDIR)/etc/pam.d || continue ; \
-		test -w $(DESTDIR)/etc/pam.d || continue ; \
-		$(INSTALL_DATA) $(srcdir)/imap/imapd.pam \
-			$(DESTDIR)/etc/pam.d/imap || exit 1 ;\
-		$(INSTALL_DATA) $(srcdir)/imap/pop3d.pam \
-			$(DESTDIR)/etc/pam.d/pop3 || exit 1 ;\
-	done
-	rm -f $(DESTDIR)$(man8dir)/pw2userdb.8
-	rm -f $(DESTDIR)$(man8dir)/vchkpw2userdb.8
-	$(LN_S) makeuserdb.8 $(DESTDIR)$(man8dir)/pw2userdb.8
-	$(LN_S) makeuserdb.8 $(DESTDIR)$(man8dir)/vchkpw2userdb.8
-	. authlib/authdaemonrc ; test "$$authdaemonvar" = "" && exit 0; \
-		$(mkinstalldirs) $(DESTDIR)$$authdaemonvar ; \
-		chmod 700 $(DESTDIR)$$authdaemonvar
-	for f in $(man_MANS); do chmod a+r $(DESTDIR)$(mandir)/*/$$f; done
-	@cat authlib/authdaemon.msg
-	@echo "Do not forget to run make install-configure"
 
 uninstall-local:
