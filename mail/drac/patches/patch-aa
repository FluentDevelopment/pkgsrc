$NetBSD: patch-aa,v 1.2 2002/09/25 19:40:38 wiz Exp $

--- Makefile.orig	Mon Nov 20 16:35:16 2000
+++ Makefile
@@ -5,9 +5,11 @@
 
 # Paths
 
-INSTALL = /usr/ucb/install
-EBIN = /usr/local/sbin
-MAN = /usr/local/man/man
+MKDIR = /bin/mkdir
+INSTALL = /usr/bin/install
+EBIN = $(LOCALBASE)/libexec
+MAN = $(LOCALBASE)/man/man
+EXAMPLES = $(LOCALBASE)/share/examples/drac
 
 # OS-Dependant settings
 
@@ -33,24 +35,28 @@ MAN = /usr/local/man/man
 # -DCIDR_KEY	# keys in CIDR format
 # -DTERM_KD	# keys and data nul-terminated
 
-DEFS = -DTI_RPC -DFCNTL_LOCK -DSYSINFO
+DEFS = -DSOCK_RPC -DFCNTL_LOCK -DGETHOST -DDASH_C
 
 # Compiler flags 
 CC = cc
-RANLIB = :
-CFLAGS = $(DEFS) -g -I/usr/local/src/db/db-3.1.17/build_unix
+RANLIB = ranlib
+#CFLAGS = $(DEFS) -g -I/usr/local/src/db/db-3.1.17/build_unix
 #CFLAGS = $(DEFS) -g -I/usr/local/src/db/db-2.4.14/Unix
 #CFLAGS = $(DEFS) -g -I/usr/local/src/db/db.1.85/PORT/sunos.5.2/include
-LDLIBS = -L/usr/local/src/db/db-3.1.17/build_unix -lnsl -ldb
+CFLAGS= $(DEFS)
+#LDLIBS = -L/usr/local/src/db/db-3.1.17/build_unix -lnsl -ldb
 #LDLIBS = -L/usr/local/src/db/db-2.4.14/Unix -lnsl -ldb
 #LDLIBS = -L/usr/local/src/db/db.1.85/PORT/sunos.5.2 -lnsl -ldb
-TSTLIBS = -L. -ldrac -lnsl
-RPCGENFLAGS = 
+LDLIBS =
+#TSTLIBS = -L. -ldrac -lnsl
+TSTLIBS = -L. -ldrac
+#RPCGENFLAGS = 
 #RPCGENFLAGS = -C
+RPCGENFLAGS = -I -C
 
 # Man sections
 MANLIB = 3
-MANADM = 1m
+MANADM = 8
 
 ## Nothing to change after this point
 
@@ -119,8 +125,13 @@ tar: $(PACKAGE)
 
 install: $(SERVER)
 	$(INSTALL) -c -o bin -g bin -m 0755 $(SERVER) $(EBIN)
-
-install-man: $(SERVER).1m dracauth.3
 	$(INSTALL) -c -m 0444 $(SERVER).1m $(MAN)$(MANADM)/$(SERVER).$(MANADM)
 	$(INSTALL) -c -m 0444 dracauth.3 $(MAN)$(MANLIB)/dracauth.$(MANLIB)
-
+	$(MKDIR) -p $(EXAMPLES)
+	$(INSTALL) -c -m 0444 README $(EXAMPLES)/README
+	$(INSTALL) -c -m 0444 INSTALL $(EXAMPLES)/INSTALL
+	$(INSTALL) -c -m 0444 testing.c $(EXAMPLES)/testing.c
+	$(INSTALL) -c -m 0444 dracd-setup $(EXAMPLES)/dracd-setup
+	$(INSTALL) -c -m 0444 dracd.allow-sample $(EXAMPLES)/dracd.allow-sample
+	$(INSTALL) -c -m 0444 drac.h $(LOCALBASE)/include/drac.h
+	$(INSTALL) -c -m 0444 libdrac.a $(LOCALBASE)/lib/libdrac.a
