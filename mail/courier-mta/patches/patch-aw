$NetBSD: patch-aw,v 1.1 2007/09/23 11:42:44 jlam Exp $

--- liblock/lockdaemon.c.orig	2007-05-04 23:04:41.000000000 -0400
+++ liblock/lockdaemon.c
@@ -8,4 +8,5 @@
 #include	<stdio.h>
 #include	<signal.h>
+#include	<limits.h>
 #include	<stdlib.h>
 #include	<string.h>
@@ -31,4 +32,8 @@
 #endif
 
+#ifndef OPEN_MAX
+#define OPEN_MAX	64
+#endif
+
 #define exit(_a_) _exit(_a_)
 
@@ -146,5 +151,5 @@ int	lockfd;
 	}
 
-	if (lockfd < 0 || dup2(lockfd, 99) != 99)
+	if (lockfd < 0 || dup2(lockfd, OPEN_MAX-1) != OPEN_MAX-1)
 	{
 		perror(lockfile);
@@ -153,5 +158,5 @@ int	lockfd;
 
 	close(lockfd);
-	lockfd=99;
+	lockfd=OPEN_MAX-1;
 
 #ifdef	FD_CLOEXEC
