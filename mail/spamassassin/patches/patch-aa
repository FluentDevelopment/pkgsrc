$NetBSD: patch-aa,v 1.4 2003/01/29 17:34:29 tron Exp $

--- spamd/libspamc.c.orig	2002-10-15 17:22:49.000000000 +0200
+++ spamd/libspamc.c	2003-01-29 18:32:03.000000000 +0100
@@ -309,7 +309,7 @@
       case MESSAGE_BSMTP:
         total=full_write(fd, m->pre, m->pre_len);
         for(i=0; i<m->out_len; ){
-            for(j=0; i<m->out_len && j<sizeof(buffer)/sizeof(*buffer)-1; ){
+            for(j=0; i<m->out_len && j<sizeof(buffer)/sizeof(*buffer)-2; ){
                 if(i+1<m->out_len && m->out[i]=='\n' && m->out[i+1]=='.'){
                     buffer[j++]=m->out[i++];
                     buffer[j++]=m->out[i++];
