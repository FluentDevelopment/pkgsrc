$NetBSD: patch-ah,v 1.2 2002/11/06 21:51:27 heinz Exp $

--- lib/Mail/SpamAssassin/Reporter.pm.orig	Mon Oct 14 18:44:35 2002
+++ lib/Mail/SpamAssassin/Reporter.pm
@@ -126,6 +126,7 @@
   if ( !$@ ) {
     eval {
       local ($^W) = 0;    # argh, warnings in Razor
+      local %ENV;
 
       local $SIG{ALRM} = sub { die "alarm\n" };
       alarm $timeout;
@@ -151,6 +152,12 @@
         my $objects = $rc->prepare_objects( \@msg )
           or adie ("error in prepare_objects");
         $rc->get_server_info() or adie $rc->errprefix("reportit");
+
+	# let's reset the alarm since get_server_info() calls
+	# nextserver() which calls discover() which very likely will
+	# reset the alarm for us ... how polite.  :(  
+	alarm $timeout;
+
         my $sigs = $rc->compute_sigs($objects)
           or adie ("error in compute_sigs");
 
