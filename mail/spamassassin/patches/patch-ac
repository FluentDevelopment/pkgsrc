$NetBSD: patch-ac,v 1.4 2003/05/22 11:41:03 abs Exp $

--- configure.in.orig	2003-03-28 21:25:56.000000000 +0000
+++ configure.in
@@ -1,4 +1,9 @@
 AC_INIT
+AC_ARG_ENABLE(ssl,
+	AC_HELP_STRING([--enable-ssl],
+		[build spamc with ssl support (default is NO)]),
+	[with_ssl=${enableval:-no}],
+	[with_ssl=${enableval:-no}])
 AC_CONFIG_SRCDIR([Makefile.PL])
 AC_CONFIG_HEADER(config.h)
 
@@ -41,8 +46,12 @@ fi
 dnl ----------------------------------------------------------------------
 
 AC_CHECK_LIB(socket, socket)
-AC_CHECK_LIB(crypto, CRYPTO_lock)
-AC_CHECK_LIB(ssl, SSL_CTX_free,,,-lcrypto)
+if test $with_ssl = yes ; then
+	AC_CHECK_LIB(crypto, CRYPTO_lock,[SSLLIBS="-lcrypto $SSLLIBS"])
+	AC_CHECK_LIB(ssl, SSL_CTX_free,[SSLLIBS="-lssl $SSLLIBS"],,-lcrypto)
+else
+	SSLLIBS=""
+fi
 AC_CHECK_LIB(inet, connect)
 AC_CHECK_LIB(nsl, t_accept)
 AC_CHECK_LIB(dl, dlopen)
@@ -125,6 +134,7 @@ dnl ------------------------------------
 # we cheat, since we *know* we have Perl installed ;)
 CCDLFLAGS=`perl -e 'use Config; print $Config::Config{ccdlflags}'`
 LDDLFLAGS=`perl -e 'use Config; print $Config::Config{lddlflags}'`
+AC_SUBST(SSLLIBS)
 AC_SUBST(CCDLFLAGS)
 AC_SUBST(LDDLFLAGS)
 AC_SUBST(HAVE_SHUT_RD)
