$NetBSD: patch-ag,v 1.2 2002/11/06 21:51:27 heinz Exp $

--- lib/Mail/SpamAssassin/Dns.pm.orig	Fri Oct  4 14:54:16 2002
+++ lib/Mail/SpamAssassin/Dns.pm
@@ -365,6 +365,7 @@
 
     eval {
       local ($^W) = 0;    # argh, warnings in Razor
+      local %ENV;
 
       require Razor2::Client::Agent;
 
@@ -389,6 +390,12 @@
         my $objects = $rc->prepare_objects( \@msg )
           or die "error in prepare_objects";
         $rc->get_server_info() or die $rc->errprefix("checkit");
+
+	# let's reset the alarm since get_server_info() calls
+	# nextserver() which calls discover() which very likely will
+	# reset the alarm for us ... how polite.  :(  
+	alarm $timeout;
+
         my $sigs = $rc->compute_sigs($objects)
           or die "error in compute_sigs";
 
