$NetBSD: patch-ab,v 1.3 2002/08/01 05:48:03 jlam Exp $

--- program/cheesetracker.cpp.orig	Fri Apr 12 02:24:16 2002
+++ program/cheesetracker.cpp
@@ -186,12 +186,21 @@ void start_player() {
 
 }
 
+#ifdef _POSIX_THREAD_IS_GNU_PTH
+gint pth_nbschedule(gint no_need_this) {
+	pthread_yield_np();
+	return 1;
+}
+#endif
+
 
 int main(int argc, char *argv[]) {
 
 
 	pthread_attr_t thread_attr;
+#if !defined(_POSIX_THREAD_IS_GNU_PTH) || defined(_POSIX_THREAD_PRIORITY_SCHEDULING)
         sched_param thread_sched_param;
+#endif
 
 	int tmperror,counter=0;
 	char * filename;
@@ -238,9 +247,19 @@ int main(int argc, char *argv[]) {
 	quit_player=false;
 
 	pthread_attr_init(&thread_attr);
+#if !defined(_POSIX_THREAD_IS_GNU_PTH) || defined(_POSIX_THREAD_PRIORITY_SCHEDULING)
 	thread_sched_param.sched_priority=0;
         pthread_attr_setschedparam (&thread_attr,&thread_sched_param);
+#endif
 	pthread_create(&player_thread,&thread_attr,&player_thread_callback,NULL);
+
+#ifdef _POSIX_THREAD_IS_GNU_PTH
+	SigC::Slot0<gint> my_slot = SigC::bind(
+		SigC::slot(pth_nbschedule),
+		0);
+	Gtk::Connection conn = Gtk::Main::timeout.connect(my_slot, 150);
+#endif
+
 
 
 
