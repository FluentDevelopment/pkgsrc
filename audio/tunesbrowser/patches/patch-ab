$NetBSD: patch-ab,v 1.2 2004/08/14 11:43:53 kristerw Exp $

--- audioplayer.c.orig	Thu Apr 29 13:31:57 2004
+++ audioplayer.c	Sat Aug 14 13:30:09 2004
@@ -80,8 +80,10 @@
     gst_init(0, NULL);
 
     pipeline_thread = gst_thread_new ("pipeline");
+#if 0
     gst_bin_set_post_iterate_function(GST_BIN(pipeline_thread),
                                       cb_iterate, NULL);
+#endif
     pipesrc = gst_element_factory_make ("fdsrc", "pipe_source");
     if (!pipesrc)
     {
@@ -136,11 +138,12 @@
 
 void audioplayer_playpipe(int fd)
 {
+    GstClock *clock;
     playing = 1;
     audioplayer_loadpipe(fd);
 
     gst_element_set_state (GST_ELEMENT (pipeline_thread), GST_STATE_PLAYING);
-    GstClock *clock = gst_bin_get_clock(GST_BIN(pipeline_thread));
+    clock = gst_bin_get_clock(GST_BIN(pipeline_thread));
     songstarted = gst_clock_get_time(clock) / GST_SECOND;
 }
 
