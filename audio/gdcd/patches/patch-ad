$NetBSD: patch-ad,v 1.3 2002/07/16 08:49:31 agc Exp $

--- source/coverart.c.orig	Sun May  6 18:18:16 2001
+++ source/coverart.c
@@ -96,7 +96,7 @@
 	 return NULL;
       }
       
-      write(fd, art.art_data, art.art_length);
+      write(fd, art.art_image, art.art_length);
       close(fd);
       
       thread_invoke_operation(display_sock, "COVR", filename, strlen(filename));
@@ -167,7 +167,7 @@
 	 return NULL;
       }
       
-      write(fd, art.art_data, art.art_length);
+      write(fd, art.art_image, art.art_length);
       close(fd);
    } else
       snprintf(filename, 108, "L%s.png", cddb_genre(data.data_genre));
@@ -197,7 +197,12 @@
          return -1;
       }
 
+#ifdef HAVE_STRERROR_R
       strerror_r(rc, message, 64);
+#else
+      strncpy (message, strerror (rc), 64);
+      message[63]='\0';
+#endif
       fputs("Error invoking pthread_create: ", stderr);
       fputs(message, stderr);
       fputc('\n', stderr);
