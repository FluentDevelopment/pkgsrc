$NetBSD: patch-ac,v 1.3 2004/07/27 22:25:31 agc Exp $

--- Arch/PCux/audio.c	2004/07/27 22:20:32	1.1
+++ Arch/PCux/audio.c	2004/07/27 22:21:39
@@ -9,6 +9,9 @@
 #include <unistd.h>
 #include <fcntl.h>
 #include "extern.h"
+#include "prefs.h"
+#include "autoinit.h"
+#include "watched_var.h"
 
 struct options_set *port_options=0;
 
@@ -50,7 +53,7 @@
 	int buf_max;
 	unsigned long possible, current;
 
-   audio = open("/dev/dsp", O_WRONLY, 0);
+   audio = open(DEVOSSAUDIO, O_WRONLY, 0);
    if (audio == -1)
 		end_all("Error opening audio device");
 
@@ -116,6 +119,7 @@
 		}
 	samples_max = buf_max / dsize;
 	current_freq = f;
+	set_watched_scalar(FREQUENCY, f);
 	total = 0;
 	return f;
    }
