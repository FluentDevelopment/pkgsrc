$NetBSD: patch-ac,v 1.2 2005/12/06 21:54:25 joerg Exp $

--- src/input.c.orig	2003-09-24 18:01:50.000000000 +0000
+++ src/input.c
@@ -24,6 +24,10 @@
 #include <assert.h>
 #endif /* HAVE_ASSERT_H */
 
+#ifdef HAVE_SYS_TYPES_H
+#include <sys/types.h>
+#endif
+
 #ifdef HAVE_SYS_SOCKET_H
 #include <sys/socket.h>
 #endif /* HAVE_SYS_SOCKET_H */
@@ -447,6 +451,9 @@ input_read_tag (struct mad_info_t *info)
   if (title_input->genre)        g_free (title_input->genre);
   if (title_input->comment)      g_free (title_input->comment);
   g_free (title_input);
+
+  id3_file_close (info->id3file);
+  info->id3file = NULL;
 }
 
 /**
