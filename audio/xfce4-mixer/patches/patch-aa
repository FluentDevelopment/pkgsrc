$NetBSD: patch-aa,v 1.1 2006/11/28 18:57:25 rillig Exp $

--- panel-plugin/plugin.c.orig	2006-11-28 19:25:31.314565636 +0100
+++ panel-plugin/plugin.c	2006-11-28 19:27:08.972814548 +0100
@@ -18,6 +18,14 @@
 /* DO: timeout -> update volume */
 #define UPDATE_TIMEOUT 1000
 
+#ifdef XFCE_PANEL_THREADED
+#  define XFCE_PANEL_LOCK() gdk_threads_enter()
+#  define XFCE_PANEL_UNLOCK() gdk_threads_leave()
+#else
+#  define XFCE_PANEL_LOCK() do { } while (0)
+#  define XFCE_PANEL_UNLOCK() do { } while (0)
+#endif
+
 typedef struct
 {
 	GtkWidget *box;
