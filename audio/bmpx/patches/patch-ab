$NetBSD: patch-ab,v 1.4 2007/08/31 17:08:54 drochner Exp $

--- jnetlib/connection.cpp.orig	2007-08-11 20:41:49.000000000 +0200
+++ jnetlib/connection.cpp
@@ -215,7 +215,16 @@ void JNL_Connection::run(int max_send_by
         sigdelset (&sigs, SIGSEGV);
         sigdelset (&sigs, SIGKILL);
         sigdelset (&sigs, SIGSTOP);
+#ifdef __DragonFly__
+	sigset_t cur_set;
+	sigprocmask(SIG_SETMASK, &sigs, &cur_set);
+	int select_retval = select(m_socket+1,&f[0],&f[1],&f[2],NULL);
+	sigprocmask(SIG_SETMASK, &cur_set, NULL);
+	
+	if (select_retval == -1)
+#else
         if (pselect(m_socket+1,&f[0],&f[1],&f[2],&ts,&sigs)==-1)
+#endif
         {
           m_errorstr="connecting to host (calling select())";
           m_state=STATE_ERROR;
