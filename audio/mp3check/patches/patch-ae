$NetBSD: patch-ae,v 1.2 2005/12/11 22:03:39 joerg Exp $

--- tstring.cc.orig	2003-01-27 21:21:17.000000000 +0000
+++ tstring.cc
@@ -27,6 +27,7 @@
 #include <unistd.h>
 #endif
 #include <errno.h>
+#include "config.h"
 #include "tstring.h"
 #include "texception.h"
 
@@ -714,12 +715,12 @@ void tstring::truncate(size_t max) {
 
 void tstring::replaceUnprintable(bool only_ascii) {
    for(size_t i = 0; i < rep->len; i++) {
-      unsigned char& c = (unsigned char)(*rep)[i];
-      if(!isprint(c)) {
-	 if(c < ' ') {
-	    c = '!';
-	 } else if(only_ascii || (c < 0xa0)) {
-	    c = '?';
+      unsigned char *c = (unsigned char*)&(*rep)[i];
+      if(!isprint(*c)) {
+	 if(*c < ' ') {
+	    *c = '!';
+	 } else if(only_ascii || (*c < 0xa0)) {
+	    *c = '?';
 	 }
       }
    }
