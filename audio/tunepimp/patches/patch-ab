$NetBSD: patch-ab,v 1.3 2005/09/06 08:10:57 abs Exp $

--- lib/write.cpp.orig	2004-03-25 22:12:43.000000000 +1200
+++ lib/write.cpp
@@ -896,8 +896,17 @@ bool WriteThread::diskSpaceTest(const st
 #else
 //---------------------------------------------------------------------------
 
+#if defined(__NetBSD__) && (__NetBSD_Version__ >= 299000900) /* NetBSD 2.99.9 */
+#define HAVE_STATVFS 1
+#endif
+
 bool WriteThread::diskSpaceTest(const string &fileName, unsigned long fileSize)
 {
+#if defined(HAVE_STATVFS)
+#define statfs statvfs
+#define f_bsize f_frsize
+#endif
+
     struct statfs stat;
 
     string path = extractFilePath(fileName);
