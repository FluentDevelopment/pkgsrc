$NetBSD: patch-ab,v 1.5 2006/03/28 23:05:05 joerg Exp $

--- src/js/js.h.orig	Mon Sep 22 06:05:53 2003
+++ src/js/js.h	Mon Sep 22 06:06:47 2003
@@ -62,8 +62,12 @@
 #  include <unistd.h>
 #  include <fcntl.h>
 
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
+#  if defined(__FreeBSD__) && __FreeBSD_version >= 500000
+#    include <sys/joystick.h>
+#  else
 #    include <machine/joystick.h>
+#  endif
 #    define JS_DATA_TYPE joystick
 #    define JS_RETURN (sizeof(struct JS_DATA_TYPE))
 #  elif defined(__linux__)
@@ -111,7 +115,7 @@
 #elif defined (macintosh)
 #  define _JS_MAX_AXES 9
 #else
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
 #  define _JS_MAX_AXES 2
 #  else
 #  define _JS_MAX_AXES 9
@@ -132,9 +136,9 @@ class jsJoystick
 
 
 
-/*#if defined(__FreeBSD__) || defined(__NetBSD__)
+#if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
   int          id ;
-#endif*/
+#endif
 #ifdef WIN32
   JOYINFOEX    js       ;
   UINT         js_id    ;
@@ -312,7 +316,7 @@ class jsJoystick
     }
 
 #else
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
     FILE *joyfile;
     char joyfname[1024];
     int noargs, in_no_axes;
@@ -338,7 +342,7 @@ class jsJoystick
     if ( error )
       return ;
 
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
 
     /*
       FIXME: get joystick name for BSD
@@ -494,7 +498,7 @@ public:
 
 
 #else
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
     //id = ident;
     sprintf ( fname, "/dev/joy%d", ident ) ;
 #  elif defined(__linux__)
@@ -725,7 +729,7 @@ public:
     }
 
     if ( buttons )
-#  if defined(__FreeBSD__) || defined(__NetBSD__)
+#  if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__DragonFly__)
       *buttons = ( js.b1 ? 1 : 0 ) | ( js.b2 ? 2 : 0 ) ;
 #  else
       *buttons = js.buttons ;
