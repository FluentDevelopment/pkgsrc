$NetBSD: patch-aa,v 1.3 2003/11/18 14:34:33 xtraeme Exp $

--- Makefile.orig	Thu Mar  5 17:06:19 1998
+++ Makefile
@@ -21,30 +21,34 @@
 ### GENERAL OPTIONS ###
 
   # Compiler to use (C++ compiler _please_)
-  CC = g++
+  #CC = g++
 
   # Directory for XNibbles specific data
   # This must be set correctly at compile time
-  DATADIR = /usr/local/games/xnibbles
+  DATADIR = $(PREFIX)/share/xnibbles
 
   # Prefix to find bin and man directories for installation
-  PREFIX  = /usr/local
+#  PREFIX  = $(PREFIX)
 
   # Install program
   INSTALL = /usr/bin/install
+  INSTALL_PROGRAM = $(INSTALL) -c -g $(GROUP) -m 755 -o $(USER)
+  INSTALL_MAN = $(INSTALL) -c -g $(GROUP) -m 644 -o $(USER)
+  INSTALL_DATA = $(INSTALL) -c -g $(GROUP) -m 644 -o $(USER)
+  INSTALL_DIR = $(INSTALL) -d -g $(GROUP) -m 755 -o $(USER)
 
   # User to own the program
-  USER = 0
-  GROUP = 0
+  USER = root
+  GROUP = wheel
 
 ### LINUX ONLY OPTIONS ###
 
   # Requires kernel sound support, change from 0 to 1 if you want it
   SOUND = 1
-  SOUNDDEV = /dev/dsp
+  SOUNDDEV = /dev/audio
 
   # Requires kernel joystick support, change from 0 to 1 if you want it
-  JOYSTICK = 1
+  JOYSTICK = 0
   JOYSTICK0DEV = /dev/js0
   JOYSTICK1DEV = /dev/js1
 
@@ -66,6 +70,7 @@
 	@echo ""
 	@echo "make linux               Linux on ix86"
 	@echo "make irix                Irix 5.3 (6.x?)"
+	@echo "make netbsd              NetBSD 1.3 or higher"
 	@echo ""
 	@echo "Check the README file for help."
 	@echo ""
@@ -79,6 +84,15 @@
 	-DDATADIR=\"$(DATADIR)\"' \
 	all
 
+netbsd:
+	$(MAKE) OBJECTS='$(OBJECTS)' \
+	CC="$(CC)" LDFLAGS="$(LDFLAGS)" \
+	CFLAGS+='-Wall -O2 $(SDEV) \
+	$(CFLAGS) -fwritable-strings \
+	$(JDEV) \
+	-DDATADIR=\"$(DATADIR)\"' \
+	all
+
 irix:
 	$(MAKE) OBJECTS= \
 	CC=$(CC) LDFLAGS='-L/usr/X11/lib' \
@@ -90,7 +104,7 @@
 	$(CC) $(CFLAGS) $(LDFLAGS) \
 	bodyPart.o boni.o bonus.o levels.o people.o statusBar.o ticker.o \
 	timer.o walls.o worm.o xnibbles.o xpms.o $(OBJECTS) deadWorm.o counter.o \
-	-o xnibbles -lm -lXpm -lX11
+	-o xnibbles -lm -lXpm -lX11 ${LIBOSSAUDIO}
 
 xnleditor: xnleditor/level.o xnleditor/newWalls.o xnleditor/sideBar.o xnleditor/walls.o xnleditor/xnleditor.o xnleditor/xpms.o xnleditor/numericDisplay.o
 	$(CC) $(CFLAGS) $(LDFLAGS) \
@@ -115,19 +129,19 @@
 	(cd ..; tar -cvzf xnibbles.tgz xnibbles/ ; chmod 644 xnibbles.tgz)
 
 install:
-	$(INSTALL) -d $(DATADIR) -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(DATADIR)/levels -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(DATADIR)/sounds -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(PREFIX) -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(PREFIX)/bin -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(PREFIX)/man -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -d $(PREFIX)/man/man6 -g $(GROUP) -m 755 -o $(USER)
-	$(INSTALL) -g $(GROUP) -m 644 -o $(USER) levels/*.xnl $(DATADIR)/levels
-	$(INSTALL) -g $(GROUP) -m 644 -o $(USER) levels/README $(DATADIR)/levels
-	$(INSTALL) -g $(GROUP) -m 644 -o $(USER) sounds/*.ub $(DATADIR)/sounds
-	$(INSTALL) -g $(GROUP) -m 755 -o $(USER) xnibbles $(PREFIX)/bin
-	$(INSTALL) -g $(GROUP) -m 755 -o $(USER) xnleditor/xnleditor $(PREFIX)/bin
-	$(INSTALL) -g $(GROUP) -m 644 -o $(USER) xnibbles.6 $(PREFIX)/man/man6
+	$(INSTALL_DIR) $(DATADIR)
+	$(INSTALL_DIR) $(DATADIR)/levels
+	$(INSTALL_DIR) $(DATADIR)/sounds
+#	$(INSTALL_DIR) $(PREFIX)
+#	$(INSTALL_DIR) $(PREFIX)/bin
+#	$(INSTALL_DIR) $(PREFIX)/man
+#	$(INSTALL_DIR) $(PREFIX)/man/man6
+	$(INSTALL_DATA) levels/*.xnl $(DATADIR)/levels
+	$(INSTALL_DATA) levels/README $(DATADIR)/levels
+	$(INSTALL_DATA) sounds/*.ub $(DATADIR)/sounds
+	$(INSTALL_PROGRAM) xnibbles $(PREFIX)/bin
+	$(INSTALL_PROGRAM) xnleditor/xnleditor $(PREFIX)/bin
+	$(INSTALL_MAN) xnibbles.6 $(PREFIX)/man/man6
 	./make-LEVELS $(DATADIR) OOGA
 
 bodyPart.o:	common.h bodyPart.h
