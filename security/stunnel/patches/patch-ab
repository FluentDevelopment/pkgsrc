$NetBSD: patch-ab,v 1.7 2001/08/10 14:41:19 martin Exp $

--- configure.in.orig	Fri Aug 10 11:30:46 2001
+++ configure.in	Fri Aug 10 16:33:18 2001
@@ -125,20 +125,7 @@
 AC_CHECK_LIB(nsl, gethostbyname)
 AC_CHECK_LIB(socket, socket)
 
-# OSF hack instead of simple AC_CHECK_LIB here
-AC_MSG_CHECKING([for pthread_create in -lpthread])
-    saved_LIBS="$LIBS"
-    LIBS="-lpthread $saved_LIBS"
-    AC_TRY_LINK([#include <pthread.h>],
-      [pthread_create((void *)0, (void *)0, (void *)0, (void *)0)],
-      [AC_MSG_RESULT(yes); AC_DEFINE(HAVE_LIBPTHREAD)],
-      [AC_MSG_RESULT(no); LIBS="$saved_LIBS"])
-
-# BSD hack
-AC_CHECK_LIB(c_r, pthread_create,
-        [ LIBS="$LIBS -pthread"
-	AC_DEFINE(HAVE_LIBPTHREAD) ]
-)
+# XXX pthread does not work with stunnel on NetBSD
 
 AC_CHECK_LIB(util, openpty)
 
@@ -195,7 +182,7 @@
 # AC_HEADER_DIRENT
 # AC_HEADER_STDC
 # AC_HEADER_SYS_WAIT
-AC_CHECK_HEADERS(getopt.h unistd.h sys/select.h tcpd.h pthread.h pty.h stropts.h)
+AC_CHECK_HEADERS(getopt.h unistd.h sys/select.h tcpd.h pthread.h util.h pty.h stropts.h)
 
 # dnl Checks for typedefs, structures, and compiler characteristics.
 # AC_C_CONST
