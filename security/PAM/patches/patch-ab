$NetBSD: patch-ab,v 1.3 2002/12/23 21:23:58 jlam Exp $

--- configure.in.orig	Tue Jul  9 02:17:13 2002
+++ configure.in
@@ -199,7 +199,7 @@ AC_CHECK_LIB(crack, FascistCheck, HAVE_L
 	HAVE_LIBCRACK=no)
 AC_SUBST(HAVE_LIBCRACK)
 
-AC_CHECK_LIB(crypt, fcrypt, HAVE_LIBCRYPT=yes ; AC_DEFINE(HAVE_LIBCRYPT),
+AC_CHECK_LIB(crypt, crypt, HAVE_LIBCRYPT=yes ; AC_DEFINE(HAVE_LIBCRYPT),
 	HAVE_LIBCRYPT=no)
 AC_SUBST(HAVE_LIBCRYPT)
 AC_CHECK_LIB(util, logwtmp, HAVE_LIBUTIL=yes ; AC_DEFINE(HAVE_LIBUTIL),
@@ -240,6 +240,13 @@ AC_CHECK_HEADERS(fcntl.h limits.h malloc
 dnl Linux wants features.h in some of the source files.
 AC_CHECK_HEADERS(features.h)
 
+dnl For module/pam_filter
+AC_CHECK_HEADERS(termios.h)
+
+dnl For module/pam_unix
+AC_CHECK_HEADERS(shadow.h)
+AC_CHECK_FUNCS(getspnam)
+
 dnl For module/pam_cracklib
 AC_CHECK_HEADERS(crypt.h)
 
@@ -257,7 +264,7 @@ dnl being found.
 
 dnl Look for cracklib dictionary
 AC_MSG_CHECKING(path to cracklib dictionary)
-DICT_DIR_CANDIDATES="/usr/lib /usr/share/dict /usr/share/lib \
+DICT_DIR_CANDIDATES="${prefix}/libdata /usr/lib /usr/share/dict /usr/share/lib \
   /usr/local/lib /usr/local/share/lib"
 DICT_FILE_CANDIDATES="pw_dict cracklib_dict"
 CRACKLIB_DICTPATH=""
@@ -305,6 +312,18 @@ if test "$GCC" = yes; then
 	case $OS in
 	linux)
 		OS_CFLAGS="-ansi -D_POSIX_SOURCE -pedantic"
+		LD_D="gcc -shared -Xlinker -x"
+		WARNINGS="$GCC_WARNINGS"
+		PIC="-fPIC"
+		DYNTYPE=so
+		LD=ld				
+		LD_L="$LD -x -shared"
+		RANLIB=ranlib
+		STRIP=strip
+		CC_STATIC="-Xlinker -export-dynamic"
+		;;
+	netbsd)
+		OS_CFLAGS=""
 		LD_D="gcc -shared -Xlinker -x"
 		WARNINGS="$GCC_WARNINGS"
 		PIC="-fPIC"
