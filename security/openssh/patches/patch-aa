$NetBSD: patch-aa,v 1.21 2002/04/02 11:20:12 seb Exp $

--- configure.orig	Sun Dec  2 00:38:55 2001
+++ configure
@@ -3587,8 +3587,6 @@
 	CFLAGS="$CFLAGS"
 	;;
 *-*-solaris*)
-	CPPFLAGS="$CPPFLAGS -I/usr/local/include"
-	LDFLAGS="$LDFLAGS -L/usr/local/lib -R/usr/local/lib"
 	need_dash_r=1
 	cat >>confdefs.h <<\_ACEOF
 #define PAM_SUN_CODEBASE 1
@@ -4051,6 +4049,9 @@
 	;;
 esac
 
+# pkgsrc handles any rpath settings this package needs
+need_dash_r=
+
 # Allow user to specify flags
 
 # Check whether --with-cflags or --without-cflags was given.
@@ -6246,12 +6247,16 @@
 				fi
 			fi
 			LIBS="-lwrap $LIBS"
-			echo "$as_me:6249: checking for libwrap" >&5
+			echo "$as_me:6250: checking for libwrap" >&5
 echo $ECHO_N "checking for libwrap... $ECHO_C" >&6
 			cat >conftest.$ac_ext <<_ACEOF
-#line 6252 "configure"
+#line 6253 "configure"
 #include "confdefs.h"
 
+#ifdef HAVE_SYS_CDEFS_H
+#include <sys/cdefs.h>
+#endif
+#include <stdio.h>
 #include <tcpd.h>
 					int deny_severity = 0, allow_severity = 0;
 
@@ -6289,17 +6294,20 @@
 _ACEOF
 
 					TCPW_MSG="yes"
+					TCPW_LIB="-lwrap"
 
 else
   echo "$as_me: failed program was:" >&5
 cat conftest.$ac_ext >&5
 
-					{ { echo "$as_me:6297: error: *** libwrap missing" >&5
+					TCPW_LIB=""
+					{ { echo "$as_me:6304: error: *** libwrap missing" >&5
 echo "$as_me: error: *** libwrap missing" >&2;}
    { (exit 1); exit 1; }; }
 
 fi
 rm -f conftest.$ac_objext conftest$ac_exeext conftest.$ac_ext
+			LIBS="$saved_LIBS"
 		fi
 
 fi;
@@ -15590,6 +15598,7 @@
 s,@TEST_MINUS_S_SH@,$TEST_MINUS_S_SH,;t t
 s,@LOGIN_PROGRAM_FALLBACK@,$LOGIN_PROGRAM_FALLBACK,;t t
 s,@LD@,$LD,;t t
+s,@TCPW_LIB@,$TCPW_LIB,;t t
 s,@NO_SFTP@,$NO_SFTP,;t t
 s,@rsh_path@,$rsh_path,;t t
 s,@xauth_path@,$xauth_path,;t t
@@ -16069,7 +16078,7 @@
 echo "                 User binaries: $B"
 echo "               System binaries: $C"
 echo "           Configuration files: $D"
-echo "               Askpass program: $E"
+echo "               Askpass program: ${ASKPASS_PROGRAM}"
 echo "                  Manual pages: $F"
 echo "                      PID file: $G"
 echo "        sshd default user PATH: $H"
