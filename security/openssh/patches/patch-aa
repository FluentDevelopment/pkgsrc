$NetBSD: patch-aa,v 1.39 2005/09/23 15:45:14 taca Exp $

--- configure.orig	2005-09-01 02:15:24.000000000 -0700
+++ configure	2005-09-21 09:49:24.000000000 -0700
@@ -5706,7 +5706,7 @@
 		need_dash_r=1
 	fi
 	;;
-*-*-freebsd*)
+*-*-freebsd*|*-*-dragonfly*)
 	check_for_libcrypt_later=1
 	;;
 *-*-bsdi*)
@@ -6552,8 +6552,46 @@
 _ACEOF
 
         ;;
+ 
+*-*-interix3)
+        cat >>confdefs.h <<\_ACEOF
+#define HAVE_INTERIX 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define DISABLE_FD_PASSING 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define DISABLE_SHADOW 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define IP_TOS_IS_BROKEN 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define MISSING_HOWMANY 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define NO_IPPORT_RESERVED_CONCEPT 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define SETGROUPS_NOOP 1
+_ACEOF
+
+        cat >>confdefs.h <<\_ACEOF
+#define USE_PIPES 1
+_ACEOF
+
+       ;;
 esac
 
+# pkgsrc handles any rpath settings this package needs
+need_dash_r=
+
 # Allow user to specify flags
 
 # Check whether --with-cflags or --without-cflags was given.
@@ -25360,12 +25398,19 @@
 rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 if test -z "$conf_utmpx_location"; then
 	if test x"$system_utmpx_path" = x"no" ; then
-		cat >>confdefs.h <<\_ACEOF
+		for f in /var/run/utmpx; do
+			if test -f $f ; then
+				conf_utmpx_location=$f
+			fi
+		done
+		if test -z "$conf_utmpx_location"; then
+			cat >>confdefs.h <<\_ACEOF
 #define DISABLE_UTMPX 1
 _ACEOF
-
+		fi
 	fi
-else
+fi
+if test -n "$conf_utmpx_location"; then
 	cat >>confdefs.h <<_ACEOF
 #define CONF_UTMPX_FILE "$conf_utmpx_location"
 _ACEOF
@@ -25434,12 +25479,20 @@
 rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 if test -z "$conf_wtmpx_location"; then
 	if test x"$system_wtmpx_path" = x"no" ; then
-		cat >>confdefs.h <<\_ACEOF
+		for f in /var/log/wtmpx; do
+			if test -f $f ; then
+				conf_wtmpx_location=$f
+			fi
+		done
+		if test -z "$conf_wtmpx_location"; then
+			cat >>confdefs.h <<\_ACEOF
 #define DISABLE_WTMPX 1
 _ACEOF
+		fi
 
 	fi
-else
+fi
+if test -n "$conf_wtmpx_location"; then
 	cat >>confdefs.h <<_ACEOF
 #define CONF_WTMPX_FILE "$conf_wtmpx_location"
 _ACEOF
@@ -26665,7 +26718,7 @@
 echo "                     User binaries: $B"
 echo "                   System binaries: $C"
 echo "               Configuration files: $D"
-echo "                   Askpass program: $E"
+echo "                   Askpass program: ${ASKPASS_PROGRAM}"
 echo "                      Manual pages: $F"
 echo "                          PID file: $G"
 echo "  Privilege separation chroot path: $H"
