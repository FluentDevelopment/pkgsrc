$NetBSD: patch-af,v 1.8 2005/09/21 18:07:09 reed Exp $

--- auth-passwd.c.orig	2005-07-26 06:54:12.000000000 -0500
+++ auth-passwd.c
@@ -78,7 +78,7 @@
 #endif
 
 #ifndef HAVE_CYGWIN
-	if (pw->pw_uid == 0 && options.permit_root_login != PERMIT_YES)
+	if (pw->pw_uid == ROOTUID && options.permit_root_login != PERMIT_YES)
 		ok = 0;
 #endif
 	if (*password == '\0' && options.permit_empty_passwd == 0)
@@ -113,7 +113,12 @@
 			authctxt->force_pwchange = 1;
 	}
 #endif
+
+#ifdef HAVE_INTERIX
+        result = (!setuser(pw->pw_name, password, SU_CHECK);
+#else
 	result = sys_auth_passwd(authctxt, password);
+#endif
 	if (authctxt->force_pwchange)
 		disable_forwarding();
 	return (result && ok);
