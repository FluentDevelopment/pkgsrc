$NetBSD: patch-ac,v 1.1 2005/08/09 17:31:06 drochner Exp $

--- svr-authpam.c.orig	2005-08-09 19:13:13.000000000 +0200
+++ svr-authpam.c
@@ -78,7 +78,8 @@ pamConvFunc(int num_msg, 
 
 		case PAM_PROMPT_ECHO_OFF:
 
-			if (strcmp(message, "Password:") != 0) {
+			if ((strcmp(message, "Password:") != 0)
+				&& (strcmp(message, "Password: ") != 0)) {
 					TRACE(("PAM_PROMPT_ECHO_OFF: unrecognized prompt"))
 					rc = PAM_CONV_ERR;
 					break;
@@ -101,7 +102,9 @@ pamConvFunc(int num_msg, 
 
 			if ((strcmp(message, "login: " ) != 0) 
 					&& (strcmp(message, "login:" ) != 0)
-					&& (strcmp(message, "Please enter username: " ) != 0)) {
+					&& (strcmp(message, "Please enter username: " ) != 0)
+					&& (strcmp(message, "Login:" ) != 0)
+					&& (strcmp(message, "Username:" ) != 0)) {
 				TRACE(("PAM_PROMPT_ECHO_ON: unrecognized prompt"))
 				rc = PAM_CONV_ERR;
 				break;
@@ -184,7 +187,9 @@ void svr_auth_pam() {
 		goto cleanup;
 	}
 
+#ifndef __NetBSD__
 	(void) pam_fail_delay(pamHandlep, 0 /* musec_delay */);
+#endif
 
 	/* (void) pam_set_item(pamHandlep, PAM_FAIL_DELAY, (void*) pamDelayFunc); */
 
