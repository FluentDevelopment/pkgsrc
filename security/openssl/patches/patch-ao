$NetBSD: patch-ao,v 1.1 2006/09/30 04:20:24 taca Exp $

# http://secunia.com/advisories/22130/

--- ssl/ssl_lib.c.orig	2005-06-11 05:00:39.000000000 +0900
+++ ssl/ssl_lib.c
@@ -1187,7 +1187,7 @@ char *SSL_get_shared_ciphers(const SSL *
 		c=sk_SSL_CIPHER_value(sk,i);
 		for (cp=c->name; *cp; )
 			{
-			if (len-- == 0)
+			if (len-- <= 0)
 				{
 				*p='\0';
 				return(buf);
