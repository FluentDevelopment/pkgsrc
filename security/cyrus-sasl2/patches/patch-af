$NetBSD: patch-af,v 1.3 2003/10/06 16:31:07 christos Exp $

--- plugins/cram.c.orig	2003-02-18 13:27:37.000000000 -0500
+++ plugins/cram.c	2003-10-06 12:09:33.000000000 -0400
@@ -230,7 +230,7 @@
     HMAC_MD5_STATE md5state;
     int clear_md5state = 0;
     char *digest_str = NULL;
-    UINT4 digest[4];
+    uint32_t digest[4];
     
     /* extract userid; everything before last space */
     pos = clientinlen-1;
@@ -544,7 +544,8 @@
 	
 	if ((auth_result != SASL_OK) && (auth_result != SASL_INTERACT))
 	    return auth_result;
-    }
+    } else
+	authid = oparams->authid;
     
     /* try to get the password */
     if (password == NULL) {
