$NetBSD: patch-ad,v 1.2 2004/06/19 14:38:56 markd Exp $

diff -ur t1lib-5.0.2/lib/type1/scanfont.c t1lib-5.0.1/lib/type1/scanfont.c
--- t1lib-5.0.2/lib/type1/scanfont.c	2004-03-06 14:58:26.000000000 +1300
+++ lib/type1/scanfont.c	2002-08-18 07:32:50.000000000 +1200
@@ -248,7 +247,7 @@
   int i;
   psobj *encodingArrayP;
  
-  encodingArrayP = (psobj *)malloc(256*(sizeof(psobj)));
+  encodingArrayP = (psobj *)vm_alloc(256*(sizeof(psobj)));
   if (!encodingArrayP)
       return NULL;
 
--- lib/type1/scanfont.c.orig	2004-03-05 19:58:26.000000000 -0600
+++ lib/type1/scanfont.c
@@ -1237,7 +1237,7 @@ int scan_font(FontP)
     }
     if ( namelen >= MAXPATHLEN ) {
       /* Hopefully, this will lead to a file open error */
-      namelen = MAXPATHLEN;
+      namelen = MAXPATHLEN - 1;
     }
     strncpy(filename,nameP,namelen);
     filename[namelen] = '\0';
