$NetBSD: patch-ac,v 1.1 2005/01/01 11:43:27 kristerw Exp $

--- arcmisc.c.orig	Wed Apr 15 00:59:12 1992
+++ arcmisc.c	Sat Jan  1 12:36:08 2005
@@ -5,6 +5,7 @@
 
 #include <stdio.h>
 #include <ctype.h>
+#include <unistd.h>
 #include "arc.h"
 
 #include <string.h>
@@ -233,16 +234,16 @@
 	char           *dirname;
 
 {
-	char           *getwd();
+	size_t		buf_size = 0;
 #if	GEMDOS
 	int             drv;
 	char           *buf;
 #endif
-	if (dirname == NULL || strlen(dirname) == 0)
-		dirname = (char *) malloc(1024);
+	if (dirname == NULL || (buf_size = strlen(dirname)) == 0)
+		dirname = (char *) malloc(buf_size = 1024);
 
 #if	!GEMDOS
-	getwd(dirname);
+	getcwd(dirname, buf_size);
 #else
 	buf = dirname;
 	*buf++ = (drv = Dgetdrv()) + 'A';
