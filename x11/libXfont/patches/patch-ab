$NetBSD: patch-ab,v 1.1 2007/04/03 20:27:21 drochner Exp $

--- src/fontfile/fontdir.c.orig	2007-04-03 19:04:16.000000000 +0200
+++ src/fontfile/fontdir.c
@@ -38,9 +38,17 @@ in this Software without prior written a
 #include    <X11/fonts/fntfilst.h>
 #include    <X11/keysym.h>
 
+#if HAVE_STDINT_H
+#include <stdint.h>
+#elif !defined(INT32_MAX)
+#define INT32_MAX 0x7fffffff
+#endif
+
 Bool
 FontFileInitTable (FontTablePtr table, int size)
 {
+    if (size < 0 || (size > INT32_MAX/sizeof(FontEntryRec)))
+	return FALSE;
     if (size)
     {
 	table->entries = (FontEntryPtr) xalloc(sizeof(FontEntryRec) * size);
