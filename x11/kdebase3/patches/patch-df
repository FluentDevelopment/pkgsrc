$NetBSD: patch-df,v 1.9 2005/11/08 18:25:44 joerg Exp $

--- ksysguard/ksysguardd/FreeBSD/ProcessList.c.orig	2005-08-18 00:27:47.000000000 +0000
+++ ksysguard/ksysguardd/FreeBSD/ProcessList.c
@@ -217,23 +217,25 @@ updateProcess(int pid)
         ps->ppid      = p.kp_eproc.e_ppid;
         ps->uid       = p.kp_eproc.e_ucred.cr_uid;
         ps->gid       = p.kp_eproc.e_pgid;
+#if defined(__DragonFly__)
+        ps->priority  = p.kp_thread.td_pri;
+#else
         ps->priority  = p.kp_proc.p_priority;
+#endif
         ps->niceLevel = p.kp_proc.p_nice;
 #endif
 
         /* this isn't usertime -- it's total time (??) */
 #if __FreeBSD_version >= 500015
         ps->userTime = p.ki_runtime / 10000;
-#elif __FreeBSD_version >= 300000
-#if defined(__DragonFly__)
+#elif defined(__DragonFly__)
 	if (!getrusage(p.kp_proc.p_pid, &pru))
 	{
 		errx(1, "failed to get rusage info");
 	}
 	ps->userTime = pru.ru_utime.tv_usec / 1000; /*p_runtime / 1000*/ 
-#else
+#elif __FreeBSD_version >= 300000
         ps->userTime = p.kp_proc.p_runtime / 10000;
-#endif
 #else
 	ps->userTime = p.kp_proc.p_rtime.tv_sec*100+p.kp_proc.p_rtime.tv_usec/100;
 #endif
