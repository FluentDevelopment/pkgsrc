$NetBSD: patch-fu,v 1.2 2004/12/10 06:05:16 markd Exp $

--- konsole/konsole/konsole.cpp.orig	2004-11-29 06:27:15.000000000 +1300
+++ konsole/konsole/konsole.cpp
@@ -2381,11 +2381,11 @@ void Konsole::addSession(TESession* s)
     createSessionTab(te, SmallIconSet(s->IconName()), newTitle);
     setSchema(s->schemaNo());
     tabwidget->setCurrentPage(tabwidget->count()-1);
-      disableMasterModeConnections(); // no duplicate connections, remove old
-      enableMasterModeConnections();
-    }
-    if( tabwidget )
-    m_removeSessionButton->setEnabled(tabwidget->count()>1);
+    disableMasterModeConnections(); // no duplicate connections, remove old
+    enableMasterModeConnections();
+    if(m_removeSessionButton)
+      m_removeSessionButton->setEnabled(tabwidget->count()>1);
+  }
 }
 
 QString Konsole::currentSession()
@@ -2827,8 +2827,8 @@ void Konsole::doneSession(TESession* s)
       rootxpms.remove(s->widget());
     }
     delete s->widget();
-    if( tabwidget )
-    m_removeSessionButton->setEnabled(tabwidget->count()>1);
+    if (m_removeSessionButton)
+      m_removeSessionButton->setEnabled(tabwidget->count()>1);
   }
   session2action.remove(s);
   action2session.remove(ra);
@@ -3747,6 +3747,8 @@ void Konsole::slotFindDone()
   m_finddialog->hide();
 }
 
+#undef open
+
 void Konsole::slotSaveHistory()
 {
   KURL url = KFileDialog::getSaveURL(QString::null, QString::null, 0L, i18n("Save History"));
