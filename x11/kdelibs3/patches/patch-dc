$NetBSD: patch-dc,v 1.1 2005/04/12 11:00:03 drochner Exp $

--- kimgio/pcx.cpp.orig	2004-11-22 04:48:27.000000000 +0100
+++ kimgio/pcx.cpp
@@ -134,7 +134,8 @@ static void readImage1( QDataStream &s )
 {
   QByteArray buf( header.BytesPerLine );
 
-  img.create( w, h, 1, 2, QImage::BigEndian );
+  if( !img.create( w, h, 1, 2, QImage::BigEndian ))
+    return;
 
   for ( int y=0; y<h; ++y )
   {
@@ -160,7 +161,8 @@ static void readImage4( QDataStream &s )
   QByteArray buf( header.BytesPerLine*4 );
   QByteArray pixbuf( w );
 
-  img.create( w, h, 8, 16, QImage::IgnoreEndian );
+  if( !img.create( w, h, 8, 16, QImage::IgnoreEndian ))
+    return;
 
   for ( int y=0; y<h; ++y )
   {
@@ -196,7 +198,8 @@ static void readImage8( QDataStream &s )
 {
   QByteArray buf( header.BytesPerLine );
 
-  img.create( w, h, 8, 256, QImage::IgnoreEndian );
+  if( !img.create( w, h, 8, 256, QImage::IgnoreEndian ))
+    return;
 
   for ( int y=0; y<h; ++y )
   {
@@ -236,7 +239,8 @@ static void readImage24( QDataStream &s 
   QByteArray g_buf( header.BytesPerLine );
   QByteArray b_buf( header.BytesPerLine );
 
-  img.create( w, h, 32 );
+  if( !img.create( w, h, 32 ))
+    return;
 
   for ( int y=0; y<h; ++y )
   {
