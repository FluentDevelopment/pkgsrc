$NetBSD: patch-ce,v 1.2 2003/03/11 13:10:39 markd Exp $

--- kioslave/file/Makefile.in.orig	Thu Jan 23 12:30:39 2003
+++ kioslave/file/Makefile.in
@@ -358,7 +358,7 @@ SOURCES = $(kio_file_la_SOURCES)
 all: docs-am  all-am
 
 .SUFFIXES:
-.SUFFIXES: .cc .lo .o .obj
+.SUFFIXES: .cpp .cc .lo .o .obj
 $(srcdir)/Makefile.in:  Makefile.am  $(top_srcdir)/configure.in $(ACLOCAL_M4)
 #>- 	cd $(top_srcdir) && \
 #>- 	  $(AUTOMAKE) --foreign  kioslave/file/Makefile
@@ -698,3 +698,35 @@ kde-rpo-clean:
 #>+ 3
 file.lo: file.moc 
 file.o: file.moc 
+
+# no optimization rules
+
+CXXCOMPILE_NOOPT=${CXXCOMPILE:-O%=}
+LTCXXCOMPILE_NOOPT=${LTCXXCOMPILE:-O%=}
+
+.cpp.o:
+@AMDEP_TRUE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+	$(CXXCOMPILE_NOOPT) -c -o $@ `test -f $< || echo '$(srcdir)/'`$<
+
+.cpp.obj:
+@AMDEP_TRUE@	source='$<' object='$@' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@	depfile='$(DEPDIR)/$*.Po' tmpdepfile='$(DEPDIR)/$*.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+	$(CXXCOMPILE_NOOPT) -c -o $@ `cygpath -w $<`
+
+.cpp.lo:
+@AMDEP_TRUE@	source='$<' object='$@' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@	depfile='$(DEPDIR)/$*.Plo' tmpdepfile='$(DEPDIR)/$*.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+	$(LTCXXCOMPILE_NOOPT) -c -o $@ `test -f $< || echo '$(srcdir)/'`$<
+
+.cc.cpp:
+	cp -f $< $@
+
+# problem files when compiled with optimization
+
+file.lo: file.cpp
+file.o: file.cpp
+
