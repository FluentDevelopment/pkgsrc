$NetBSD: patch-cg,v 1.1 2004/08/26 04:04:11 markd Exp $

--- kio/kio/kurlcompletion.cpp.orig	2004-06-23 05:36:41.000000000 +1200
+++ kio/kio/kurlcompletion.cpp
@@ -54,6 +54,9 @@
 #include <sys/stat.h>
 #include <pwd.h>
 #include <time.h>
+#ifdef __NetBSD__
+#include <sys/param.h>
+#endif
 
 #include "kurlcompletion.h"
 
@@ -222,7 +225,11 @@ void DirectoryListThread::run()
 		struct dirent dirPosition;
 		struct dirent *dirEntry = 0;
 		while ( !terminationRequested() &&
+#if defined(__NetBSD__) && __NetBSD_Version__ < 106210000  /* NetBSD 1.6U */
+			(dirEntry = ::readdir( dir )))
+#else
 		        ::readdir_r( dir, &dirPosition, &dirEntry ) == 0 && dirEntry )
+#endif
 		{
 			// Skip hidden files if m_noHidden is true
 
