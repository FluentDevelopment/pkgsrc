$NetBSD: patch-cg,v 1.3 2005/03/23 21:37:48 markd Exp $

--- kio/kio/kurlcompletion.cpp.orig	2005-03-19 22:43:14.000000000 +1300
+++ kio/kio/kurlcompletion.cpp
@@ -229,7 +229,11 @@ void DirectoryListThread::run()
 		struct dirent *dirPosition = (struct dirent *) malloc( sizeof( struct dirent ) + MAXPATHLEN + 1 );
 		struct dirent *dirEntry = 0;
 		while ( !terminationRequested() &&
+#if defined(__NetBSD__) && __NetBSD_Version__ < 106210000  /* NetBSD 1.6U */
+			(dirEntry = ::readdir( dir )))
+#else
 		        ::readdir_r( dir, dirPosition, &dirEntry ) == 0 && dirEntry )
+#endif
 		{
 			// Skip hidden files if m_noHidden is true
 
