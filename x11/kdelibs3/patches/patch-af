$NetBSD: patch-af,v 1.4 2004/01/15 09:52:51 markd Exp $

--- dcop/Makefile.am.orig	2003-12-17 03:37:17.000000000 +1300
+++ dcop/Makefile.am
@@ -29,7 +29,7 @@ INCLUDES=  $(all_includes)
 bin_PROGRAMS = dcopserver dcopserver_shutdown
 check_PROGRAMS = testdcop testdcopc
 
-lib_LTLIBRARIES  = libDCOP.la dcopserver.la
+lib_LTLIBRARIES  = libDCOP.la libdcopserver_main.la dcopserver.la
 libDCOP_la_LIBADD = KDE-ICE/libkICE.la $(LIB_QT)
 libDCOP_la_LDFLAGS = $(KDE_RPATH) -version-info 5:0:1 -no-undefined $(all_libraries)
 
@@ -41,13 +41,17 @@ METASOURCES = AUTO
 # dcopstub needs to go first for --enable-final to work
 libDCOP_la_SOURCES = dcopstub.cpp dcopref.cpp dcopobject.cpp dcopclient.cpp
 
+libdcopserver_main_la_LDFLAGS = $(all_libraries)
+libdcopserver_main_la_SOURCES = dcopserver.cpp dcopsignals.cpp
+libdcopserver_main_la_LIBADD  = libDCOP.la
+
 dcopserver_la_LDFLAGS = -module -avoid-version $(all_libraries)
-dcopserver_la_SOURCES = dcopserver.cpp dcopsignals.cpp
-dcopserver_la_LIBADD   = libDCOP.la
+dcopserver_la_SOURCES = dcopserver_main.cpp
+dcopserver_la_LIBADD  = libdcopserver_main.la
 
 dcopserver_LDFLAGS = $(KDE_RPATH) $(all_libraries)
-dcopserver_SOURCES = dummy.cpp
-dcopserver_LDADD   = dcopserver.la
+dcopserver_SOURCES = dcopserver_main.cpp
+dcopserver_LDADD   = libdcopserver_main.la
 
 dcopserver_shutdown_SOURCES = dcopserver_shutdown.c
 
@@ -61,9 +65,6 @@ testdcopc_LDADD =  KDE-ICE/libkICE.la $(
 
 EXTRA_DIST = HOWTO ICE Mainpage.dox
 
-dummy.cpp:
-	echo > dummy.cpp
-
 DOXYGEN_REFERENCES = kdecore
 DOXYGEN_EXCLUDE = KDE-ICE
 
