$NetBSD: patch-ap,v 1.10 2004/12/14 11:02:18 markd Exp $

--- khtml/khtml_part.cpp.orig	2004-11-29 06:30:50.000000000 +1300
+++ khtml/khtml_part.cpp
@@ -4758,7 +4758,7 @@ KHTMLPart *
 KHTMLPart::findFrameParent( KParts::ReadOnlyPart *callingPart, const QString &f, khtml::ChildFrame **childFrame )
 {
 #ifdef DEBUG_FINDFRAME
-  kdDebug(6050) << "KHTMLPart::findFrameParent: this = " << this << " URL = " << m_url << " findFrameParent( " << f << " )" << endl;
+  kdDebug(6050) << "KHTMLPart::findFrameParent: this = " << this << " URL = " << m_url << " name = " << name() << " findFrameParent( " << f << " )" << endl;
 #endif
   // Check access
   KHTMLPart* const callingHtmlPart = dynamic_cast<KHTMLPart *>(callingPart);
@@ -4766,6 +4766,9 @@ KHTMLPart::findFrameParent( KParts::Read
   if (!checkFrameAccess(callingHtmlPart))
      return 0;
 
+  if (!childFrame && !parentPart() && (name() == f))
+     return this;
+
   FrameIt it = d->m_frames.find( f );
   const FrameIt end = d->m_frames.end();
   if ( it != end )
