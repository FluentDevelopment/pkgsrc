$NetBSD: patch-al,v 1.1 2006/03/12 06:49:21 minskim Exp $

--- qmake/generators/unix/unixmake2.cpp.orig	2005-09-02 12:43:19.000000000 +0000
+++ qmake/generators/unix/unixmake2.cpp
@@ -1206,6 +1206,9 @@ void UnixMakefileGenerator::init2()
 	project->variables()["TARGET"].first().prepend("lib");
 	project->variables()["TARGET"].first() += ".a";
 	if(project->variables()["QMAKE_AR_CMD"].isEmpty())
+	  if( project->isActiveConfig("compile_libtool") )
+	    project->variables()["QMAKE_AR_CMD"].append("$(CXX) -o $(TARGET) $(OBJECTS) $(OBJMOC)");
+	  else
 	    project->variables()["QMAKE_AR_CMD"].append("$(AR) $(TARGET) $(OBJECTS) $(OBJMOC)");
     } else {
 	project->variables()["TARGETA"].append(project->first("DESTDIR") + "lib" + project->first("TARGET") + ".a");
@@ -1489,7 +1492,7 @@ UnixMakefileGenerator::pkgConfigFileName
     QString ret = var("TARGET");
     int slsh = ret.findRev(Option::dir_sep);
     if(slsh != -1)
-	ret = ret.right(ret.length() - slsh);
+	ret = ret.right(ret.length() - slsh - 1);
     if(ret.startsWith("lib"))
 	ret = ret.mid(3);
     int dot = ret.find('.');
