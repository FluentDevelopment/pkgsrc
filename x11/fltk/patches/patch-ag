$NetBSD: patch-ag,v 1.2 2002/11/25 18:58:37 jlam Exp $

--- src/Makefile.orig	Mon Jan 22 07:13:40 2001
+++ src/Makefile
@@ -148,17 +148,18 @@ CLEAN =
 
 include ../makeinclude
 
-LIBRARY = ../lib/$(LIBNAME)
-
 OBJECTS = $(CPPFILES:.cxx=.o) $(CFILES:.c=.o)
 
 all:	$(LIBRARY) $(DSONAME)
 
-$(LIBRARY): $(OBJECTS)
+../lib/libfltk.a: $(OBJECTS)
 	echo $(LIBCOMMAND) $@ ...
 	$(LIBCOMMAND) $@ $(OBJECTS)
 	$(RANLIB) $@
 
+libfltk.la: $(OBJECTS)
+	$(CXX) -o $@ $(OBJECTS:.o=.lo) -rpath $(prefix)/lib -version-info 1:5 $(LDLIBS)
+
 libfltk.so.1 libfltk.sl.1: $(OBJECTS)
 	echo $(DSOCOMMAND) $@ ...
 	$(DSOCOMMAND) $@ $(OBJECTS)
@@ -174,11 +175,13 @@ include makedepend
 
 ################################################################
 
-install: $(LIBRARY) $(DSONAME)
+install: install-lib install-includes
+
+install-lib: $(LIBRARY) $(DSONAME)
 	echo "Installing libraries..."
 	-mkdir -p $(libdir)
 	rm -f $(libdir)/$(LIBNAME)
-	-cp $(LIBRARY) $(libdir)
+	-$(INSTALL_LIB) $(LIBRARY) $(libdir)
 	-chmod 644 $(libdir)/$(LIBNAME)
 	if test "$(DSONAME)" = libfltk.so.1; then\
 		rm -f $(libdir)/libfltk.so*;\
@@ -192,11 +195,13 @@ install: $(LIBRARY) $(DSONAME)
 		chmod 755 $(libdir)/libfltk.sl.1; \
 		ln -s libfltk.sl.1 $(libdir)/libfltk.sl;\
 	fi
+
+install-includes:
 	echo "Installing include files..."
 	-mkdir -p $(includedir)
 	rm -rf $(includedir)/FL
 	mkdir $(includedir)/FL
-	cp ../FL/*.[hH] $(includedir)/FL
+	$(INSTALL_DATA) ../FL/*.[hH] $(includedir)/FL
 	-chmod 755 $(includedir)/FL
 	-chmod 644 $(includedir)/FL/*
 	cd $(includedir)/FL;\
