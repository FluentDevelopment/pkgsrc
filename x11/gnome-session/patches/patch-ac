$NetBSD: patch-ac,v 1.4 2004/11/19 19:59:14 jmmv Exp $

--- gnome-session/logout.c.orig	2004-07-19 20:11:14.000000000 +0200
+++ gnome-session/logout.c
@@ -37,12 +37,20 @@
 
 static gchar *halt_command[] =
 {
+#if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__)
+  "/sbin/shutdown", "-p", "now", NULL
+#else
   HALT_COMMAND, NULL
+#endif
 };
 
 static gchar *reboot_command[] =
 {
+#if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__)
+  "/sbin/shutdown", "-r", "now", NULL
+#else
   REBOOT_COMMAND, NULL
+#endif
 };
 
 /* What action to take upon shutdown */
@@ -298,6 +306,7 @@ display_gui (void)
   GtkWidget *reboot = NULL;
   GtkWidget *invisible;
   gboolean   retval = FALSE;
+  gboolean can_shutdown = FALSE;
   gboolean save_active = FALSE;
   gboolean halt_active = FALSE;
   gboolean reboot_active = FALSE;
@@ -392,6 +401,7 @@ display_gui (void)
 			  FALSE, TRUE, 0);
     }
 
+#if defined(__linux__)
   /* Red Hat specific code to check if the user has a
    * good chance of being able to shutdown the system,
    * and if so, give them that option
@@ -400,6 +410,13 @@ display_gui (void)
   t = g_strconcat ("/var/run/console/", g_get_user_name (), NULL);
   if (((geteuid () == 0) || g_file_exists (t) || g_file_exists(s)) &&
       access (halt_command[0], X_OK) == 0)
+    can_shutdown = TRUE;
+#else
+  if (access (halt_command[0], X_OK) == 0)
+    can_shutdown = TRUE;
+#endif
+
+  if (can_shutdown)
     {
       GtkWidget *title, *spacer;
       GtkWidget *action_vbox, *hbox;
