$NetBSD: patch-ab,v 1.1 2005/03/16 15:30:21 rillig Exp $

gcc-2.95.3 cannot handle declarations intermixed with code.

--- src/clearlooks_draw.c.orig	Wed Mar  2 23:41:35 2005
+++ src/clearlooks_draw.c	Wed Mar 16 14:36:37 2005
@@ -67,10 +67,10 @@ static void cl_get_coords ( CLBorderType
 void cl_draw_borders (GdkWindow *window, GtkWidget *widget, GtkStyle *style,
                       int x, int y, int width, int height, CLRectangle *r)
 {
+	int x1, y1, x2, y2, i;
 	if (r->bordergc == NULL)
 		return;
 
-	int x1, y1, x2, y2, i;
 	for ( i=0; i<4; i++) // draw all four borders + corners
 	{
 		cl_get_coords (i, x, y, width, height, r, &x1, &y1, &x2, &y2);
@@ -149,9 +149,6 @@ static void cl_draw_corner (GdkWindow *w
                      int x, int y, int width, int height,
                      CLRectangle *r, CLCornerSide corner)
 {
-	if (r->corners[corner] == CL_CORNER_NONE)
-		return;
-	
 	GdkColor    *color;
 	GdkColor     aacolor; // anti-aliasing color
 	GdkGCValues  values;
@@ -160,6 +157,9 @@ static void cl_draw_corner (GdkWindow *w
 	int x1;
 	int y1;
 
+	if (r->corners[corner] == CL_CORNER_NONE)
+		return;
+	
 	color = cl_get_gradient_corner_color (r, corner);
 	gdk_gc_get_values (r->bordergc, &values);
 	
@@ -482,6 +482,8 @@ GdkPixmap* cl_progressbar_tile_new (GdkD
 	int stripe_width = height/2;
 	int topright = height + stripe_width;	
 	int topright_div_2 = topright/2;
+	double shift;
+	int trans;
 	
 	GtkProgressBarOrientation orientation = gtk_progress_bar_get_orientation (GTK_PROGRESS_BAR (widget));
 	gboolean is_horizontal = (orientation == GTK_PROGRESS_LEFT_TO_RIGHT || orientation == GTK_PROGRESS_RIGHT_TO_LEFT) ? 1 : 0;
@@ -490,6 +492,7 @@ GdkPixmap* cl_progressbar_tile_new (GdkD
 	                                 width,
 	                                 height, -1);
 
+	GdkPoint points[4];
 	GdkColor tmp_color;
 	shade (&clearlooks_style->spot2, &tmp_color, 0.90);
 	
@@ -510,7 +513,6 @@ GdkPixmap* cl_progressbar_tile_new (GdkD
 	if (get_direction (widget) == GTK_TEXT_DIR_RTL)
 		offset = -offset;
 	
-	GdkPoint points[4];
 	if (is_horizontal)
 	{
 		points[0] = (GdkPoint){xdir*(topright - stripe_width - topright_div_2), 0};  // topleft
@@ -527,10 +529,10 @@ GdkPixmap* cl_progressbar_tile_new (GdkD
 	}
 						 
 	
-	double shift = (stripe_width*2)/(double)10;
+	shift = (stripe_width*2)/(double)10;
 	cl_progressbar_points_transform (points, 4, (offset*shift), is_horizontal);
 		
-	int trans = (width/2)-1-(stripe_width*2);
+	trans = (width/2)-1-(stripe_width*2);
 	cl_progressbar_points_transform (points, 4, trans, is_horizontal);
 	gdk_draw_polygon (tmp, clearlooks_style->spot2_gc, TRUE, points, 4);
 	cl_progressbar_points_transform (points, 4, -trans, is_horizontal);
