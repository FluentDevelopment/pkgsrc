#!/bin/sh
# $NetBSD: fix-la,v 1.1 2004/10/15 21:02:30 tv Exp $

libdir=$(dirname $1)
libfile=$(basename $1)
libname=${libfile%.la}
linkedname=$(head -1 $1 | sed 's,^.* \([^ \.]*\)\.la.*$,\1,')

(sed -e '
	/^library_names=/s:'"$linkedname"'\.:'"$libname"'\.:g
	/^old_library=/s:'"$linkedname"'\.:'"$libname"'\.:g
	/^libdir=/s:=.*$:='"'$libdir'"':
' $1 >$WRKDIR/fix-la.tmp &&
rm -f $1 &&
${INSTALL_DATA} -c $WRKDIR/fix-la.tmp $1) || exit 1
