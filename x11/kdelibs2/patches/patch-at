$NetBSD: patch-at,v 1.4 2001/12/03 15:37:21 skrll Exp $

--- kio/Makefile.am.orig	Thu Jun 21 00:05:50 2001
+++ kio/Makefile.am
@@ -21,7 +21,7 @@
 SUBDIRS = . klauncher kded file http ftp pics tests ksendbugmail kpac \
 	gzip kssld $(BZIP2DIR)
 
-lib_LTLIBRARIES = libkio.la libksycoca.la kio_uiserver.la
+lib_LTLIBRARIES = libkio.la libksycoca.la libkio_uiserver_main.la kio_uiserver.la
 bin_PROGRAMS = kio_uiserver kmailservice
 
 #libkioslave_la_LDFLAGS = -version-info 3:0
@@ -82,13 +82,17 @@
 	kemailsettings.cpp authinfo.cpp \
 	kprotocolinfo.cpp kprotocolinfofactory.cpp
 
-kio_uiserver_SOURCES = dummy.cpp
-kio_uiserver_LDADD = kio_uiserver.la
+kio_uiserver_SOURCES = kio_uiserver_main.cpp
+kio_uiserver_LDADD = libkio_uiserver_main.la
 kio_uiserver_LDFLAGS = $(KDE_RPATH) $(all_libraries)
 
-kio_uiserver_la_SOURCES = uiserver.cpp uiserver.skel observer.stub \
+libkio_uiserver_main_la_SOURCES = uiserver.cpp uiserver.skel observer.stub \
 	renamedlg.cpp skipdlg.cpp
-kio_uiserver_la_LIBADD = libksycoca.la ../kssl/libkssl.la ../kdesu/libkdesu.la
+libkio_uiserver_main_la_LIBADD = libksycoca.la ../kssl/libkssl.la ../kdesu/libkdesu.la
+libkio_uiserver_main_la_LDFLAGS = $(all_libraries)
+
+kio_uiserver_la_SOURCES = kio_uiserver_main.cpp
+kio_uiserver_la_LIBADD = libkio_uiserver_main.la
 kio_uiserver_la_LDFLAGS = $(all_libraries) -module -avoid-version
 
 METASOURCES = AUTO
@@ -121,9 +125,6 @@
 parserfiles = yacc.y lex.l
 
 EXTRA_DIST = $(kde_mime_DATA) $(parserfiles)
-
-dummy.cpp: uiserver.kidl
-	echo > dummy.cpp
 
 kmailservice_SOURCES = kmailservice.cpp
 kmailservice_LDADD = $(LIB_KDECORE)
