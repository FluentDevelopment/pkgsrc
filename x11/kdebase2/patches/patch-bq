$NetBSD: patch-bq,v 1.4 2001/12/03 15:37:19 skrll Exp $

--- kicker/Makefile.in.orig	Sat Nov 10 07:58:25 2001
+++ kicker/Makefile.in
@@ -278,7 +278,7 @@
 SUBDIRS = share core ui . proxy taskmanager taskbar applets extensions data
 
 bin_PROGRAMS = kicker
-lib_LTLIBRARIES = kicker.la
+lib_LTLIBRARIES = kicker.la libkicker.la
 
 CLEANFILES = dummy.cpp
 
@@ -286,8 +286,11 @@
 kicker_la_SOURCES = dummy.cpp
 kicker_la_LDFLAGS = $(KDE_PLUGIN) -no-undefined -module
 
-kicker_LDADD = kicker.la
-kicker_SOURCES = dummy.cpp
+libkicker_la_LIBADD = share/libkicker_share.la core/libkicker_core.la  ui/libkicker_ui.la $(LIB_KSYCOCA) $(LIB_KFILE)
+libkicker_la_SOURCES = dummy.cpp
+
+kicker_LDADD = libkicker.la
+kicker_SOURCES = kicker_main.cpp
 kicker_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
 autostart_DATA = panel.desktop
@@ -309,13 +312,19 @@
 #>- kicker_la_OBJECTS =  dummy.lo
 #>+ 1
 kicker_la_OBJECTS = dummy.lo
+libkicker_la_LDFLAGS = 
+libkicker_la_DEPENDENCIES =  share/libkicker_share.la \
+	core/libkicker_core.la ui/libkicker_ui.la
+#>- libkicker_la_OBJECTS =  dummy.lo
+#>+ 1
+libkicker_la_OBJECTS = dummy.lo
 bin_PROGRAMS =  kicker$(EXEEXT)
 PROGRAMS =  $(bin_PROGRAMS)
 
-#>- kicker_OBJECTS =  dummy.$(OBJEXT)
+#>- kicker_OBJECTS =  kicker_main.$(OBJEXT)
 #>+ 1
-kicker_OBJECTS = dummy.$(OBJEXT)
-kicker_DEPENDENCIES =  kicker.la
+kicker_OBJECTS = kicker_main.$(OBJEXT)
+kicker_DEPENDENCIES =  libkicker.la
 CXXFLAGS = @CXXFLAGS@
 #>- CXXCOMPILE = $(CXX) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CXXFLAGS) $(CXXFLAGS)
 #>+ 1
@@ -341,8 +350,8 @@
 
 TAR = tar
 GZIP_ENV = --best
-SOURCES = $(kicker_la_SOURCES) $(kicker_SOURCES)
-OBJECTS = $(kicker_la_OBJECTS) $(kicker_OBJECTS)
+SOURCES = $(kicker_la_SOURCES) $(libkicker_la_SOURCES) $(kicker_SOURCES)
+OBJECTS = $(kicker_la_OBJECTS) $(libkicker_la_OBJECTS) $(kicker_OBJECTS)
 
 #>- all: all-redirect
 #>+ 1
@@ -435,6 +444,9 @@
 @KDE_USE_CLOSURE_FALSE@kicker.la: $(kicker_la_OBJECTS) $(kicker_la_DEPENDENCIES)
 	$(CXXLINK) -rpath $(libdir) $(kicker_la_LDFLAGS) $(kicker_la_OBJECTS) $(kicker_la_LIBADD) $(LIBS)
 
+libkicker.la: $(libkicker_la_OBJECTS) $(libkicker_la_DEPENDENCIES)
+	$(CXXLINK) -rpath $(libdir) $(libkicker_la_LDFLAGS) $(libkicker_la_OBJECTS) $(libkicker_la_LIBADD) $(LIBS)
+
 mostlyclean-binPROGRAMS:
 
 clean-binPROGRAMS:
@@ -731,7 +743,7 @@
 
 
 #>+ 11
-kicker_la.all_cpp.cpp: $(srcdir)/Makefile.in dummy.cpp  
+kicker_la.all_cpp.cpp: $(srcdir)/Makefile.in $(srcdir)/dummy.cpp  
 	@echo 'creating kicker_la.all_cpp.cpp ...'; \
 	rm -f kicker_la.all_cpp.files kicker_la.all_cpp.final; \
 	echo "#define KDE_USE_FINAL 1" >> kicker_la.all_cpp.final; \
@@ -743,11 +755,23 @@
 	rm -f kicker_la.all_cpp.final kicker_la.all_cpp.files
 
 #>+ 11
-kicker.all_cpp.cpp: $(srcdir)/Makefile.in dummy.cpp  
+libkicker_la.all_cpp.cpp: $(srcdir)/Makefile.in $(srcdir)/dummy.cpp  
+	@echo 'creating libkicker_la.all_cpp.cpp ...'; \
+	rm -f libkicker_la.all_cpp.files libkicker_la.all_cpp.final; \
+	echo "#define KDE_USE_FINAL 1" >> libkicker_la.all_cpp.final; \
+	for file in dummy.cpp ; do \
+	  echo "#include \"$$file\"" >> libkicker_la.all_cpp.files; \
+	  test ! -f $(srcdir)/$$file || egrep '^#pragma +implementation' $(srcdir)/$$file >> libkicker_la.all_cpp.final; \
+	done; \
+	cat libkicker_la.all_cpp.final libkicker_la.all_cpp.files  > libkicker_la.all_cpp.cpp; \
+	rm -f libkicker_la.all_cpp.final libkicker_la.all_cpp.files
+
+#>+ 11
+kicker.all_cpp.cpp: $(srcdir)/Makefile.in $(srcdir)/kicker_main.cpp  
 	@echo 'creating kicker.all_cpp.cpp ...'; \
 	rm -f kicker.all_cpp.files kicker.all_cpp.final; \
 	echo "#define KDE_USE_FINAL 1" >> kicker.all_cpp.final; \
-	for file in dummy.cpp ; do \
+	for file in kicker_main.cpp ; do \
 	  echo "#include \"$$file\"" >> kicker.all_cpp.files; \
 	  test ! -f $(srcdir)/$$file || egrep '^#pragma +implementation' $(srcdir)/$$file >> kicker.all_cpp.final; \
 	done; \
@@ -756,7 +780,7 @@
 
 #>+ 3
 clean-final:
-	-rm -f kicker_la.all_cpp.cpp kicker.all_cpp.cpp
+	-rm -f kicker_la.all_cpp.cpp libkicker_la.all_cpp.cpp kicker.all_cpp.cpp
 
 #>+ 2
 final:
