$NetBSD: patch-bh,v 1.1 2001/10/15 22:46:02 skrll Exp $

--- kdesktop/Makefile.am.orig	Sun Jul 29 05:56:25 2001
+++ kdesktop/Makefile.am
@@ -1,10 +1,12 @@
 ## Makefile.am of kdebase/kdesktop
 
 INCLUDES = -I$(top_srcdir)/kcontrol/background -I$(top_srcdir)/libkonq $(all_includes)
+libkdesktop_main_la_LDFLAGS  = $(all_libraries) -lkdesu
+libkdesktop_main_la_LIBADD   = $(top_builddir)/libkonq/libkonq.la $(top_builddir)/kcontrol/background/libbgnd.la 
 kdesktop_la_LDFLAGS  = $(all_libraries) -lkdesu -module -avoid-version
-kdesktop_la_LIBADD   = $(top_builddir)/libkonq/libkonq.la $(top_builddir)/kcontrol/background/libbgnd.la 
+kdesktop_la_LIBADD   = $(top_builddir)/libkonq/libkonq.la $(top_builddir)/kcontrol/background/libbgnd.la
 kdesktop_LDFLAGS  = $(KDE_RPATH) $(all_libraries)
-kdesktop_LDADD    = kdesktop.la
+kdesktop_LDADD    = libkdesktop_main.la
 
 SUBDIRS = . pics patterns programs init kwebdesktop
 
@@ -12,15 +14,17 @@
 
 bin_PROGRAMS = kdesktop kdmdesktop
 bin_SCRIPTS = kdeeject
-lib_LTLIBRARIES = kdesktop.la
+lib_LTLIBRARIES = libkdesktop_main.la kdesktop.la
 
-kdesktop_la_SOURCES = krootwm.cc xautolock.cc kdiconview.cc desktop.cc main.cc \
+libkdesktop_main_la_SOURCES = krootwm.cc xautolock.cc kdiconview.cc desktop.cc main.cc \
 	lockeng.cc lockdlg.cc KDesktopIface.skel \
 	bgmanager.cc init.cc KScreensaverIface.skel \
 	minicli.cpp KBackgroundIface.skel pixmapserver.cc kcustommenu.cc \
 	startupid.cpp
 
-kdesktop_SOURCES = dummy.cc
+kdesktop_la_SOURCES = kdesktop_main.cc
+
+kdesktop_SOURCES = kdesktop_main.cc
 
 include_HEADERS = KDesktopIface.h KScreensaverIface.h KBackgroundIface.h
 
@@ -38,9 +42,6 @@
 
 messages:
 	$(XGETTEXT) *.cc *.cpp *.h -o $(podir)/kdesktop.pot
-
-dummy.cc:
-	echo > dummy.cc
 
 menu_DATA = kdesktop_custom_menu1 kdesktop_custom_menu2
 menudir = $(kde_confdir)
