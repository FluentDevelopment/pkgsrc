$NetBSD: patch-ap,v 1.3 2004/09/16 19:28:56 minskim Exp $

--- extras/Xpm/lib/CrDatFrI.c.orig	2001-10-27 22:32:09.000000000 -0500
+++ extras/Xpm/lib/CrDatFrI.c
@@ -124,6 +124,8 @@ XpmCreateDataFromXpmImage(data_return, i
      */
     header_nlines = 1 + image->ncolors;
     header_size = sizeof(char *) * header_nlines;
+    if (header_size >= SIZE_MAX / sizeof(char *))
+	return (XpmNoMemory);
     header = (char **) XpmCalloc(header_size, sizeof(char *));
     if (!header)
 	return (XpmNoMemory);
