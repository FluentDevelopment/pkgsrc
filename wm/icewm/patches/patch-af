$NetBSD: patch-af,v 1.13 2005/05/31 14:05:57 rillig Exp $

--- src/ylocale.cc.orig	Sun Jan  9 22:48:23 2005
+++ src/ylocale.cc	Tue May 31 13:11:58 2005
@@ -15,6 +15,7 @@
 
 #include "intl.h"
 #include <string.h>
+#include <sys/param.h> /* __NetBSD_Version__ */
 
 #ifdef CONFIG_I18N
 #include <errno.h>
@@ -152,7 +153,11 @@ YUChar *YLocale::unicodeString(const YLC
     char * inbuf((char *) lStr), * outbuf((char *) uStr);
     size_t inlen(lLen), outlen(4 * lLen);
 
+#if (__NetBSD_Version__ >= 200000000) || defined(__sun)
+    if (0 > (int) iconv(instance->toUnicode, (const char **)&inbuf, &inlen, &outbuf, &outlen))
+#else
     if (0 > (int) iconv(instance->toUnicode, &inbuf, &inlen, &outbuf, &outlen))
+#endif
         warn(_("Invalid multibyte string \"%s\": %s"), lStr, strerror(errno));
 
     *((YUChar *) outbuf) = 0;
